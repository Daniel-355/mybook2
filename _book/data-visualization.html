<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Data visualization | Biostatistics Handbook</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Data visualization | Biostatistics Handbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Data visualization | Biostatistics Handbook" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Daniel He" />


<meta name="date" content="2026-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="deep-learning.html"/>
<link rel="next" href="basic-statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biostatistics Handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>1</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-do-data-wrangling"><i class="fa fa-check"></i><b>1.1</b> How to do data wrangling</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#load-data-and-package"><i class="fa fa-check"></i><b>1.1.1</b> Load data and package</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#select-certain-rows"><i class="fa fa-check"></i><b>1.1.2</b> Select certain rows</a></li>
<li class="chapter" data-level="1.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#select-certain-columns"><i class="fa fa-check"></i><b>1.1.3</b> Select certain columns</a></li>
<li class="chapter" data-level="1.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#rename-variables"><i class="fa fa-check"></i><b>1.1.4</b> Rename variables</a></li>
<li class="chapter" data-level="1.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-in-ascending-or-descending-order"><i class="fa fa-check"></i><b>1.1.5</b> Sorting in ascending or descending order</a></li>
<li class="chapter" data-level="1.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#transform-variables"><i class="fa fa-check"></i><b>1.1.6</b> Transform variables</a></li>
<li class="chapter" data-level="1.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#working-with-pipes"><i class="fa fa-check"></i><b>1.1.7</b> Working with pipes %&gt;%</a></li>
<li class="chapter" data-level="1.1.8" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wider-long-to-wide"><i class="fa fa-check"></i><b>1.1.8</b> Pivot wider (long to wide)</a></li>
<li class="chapter" data-level="1.1.9" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-longer-wide-to-long"><i class="fa fa-check"></i><b>1.1.9</b> Pivot longer (wide to long)</a></li>
<li class="chapter" data-level="1.1.10" data-path="data-wrangling.html"><a href="data-wrangling.html#separate-columns"><i class="fa fa-check"></i><b>1.1.10</b> Separate columns</a></li>
<li class="chapter" data-level="1.1.11" data-path="data-wrangling.html"><a href="data-wrangling.html#recoderelabel-data"><i class="fa fa-check"></i><b>1.1.11</b> Recode/relabel data</a></li>
<li class="chapter" data-level="1.1.12" data-path="data-wrangling.html"><a href="data-wrangling.html#deduplication"><i class="fa fa-check"></i><b>1.1.12</b> deduplication</a></li>
<li class="chapter" data-level="1.1.13" data-path="data-wrangling.html"><a href="data-wrangling.html#combine-data-sets"><i class="fa fa-check"></i><b>1.1.13</b> Combine data sets</a></li>
<li class="chapter" data-level="1.1.14" data-path="data-wrangling.html"><a href="data-wrangling.html#working-with-character-strings"><i class="fa fa-check"></i><b>1.1.14</b> Working with character strings</a></li>
<li class="chapter" data-level="1.1.15" data-path="data-wrangling.html"><a href="data-wrangling.html#conditional-operations"><i class="fa fa-check"></i><b>1.1.15</b> Conditional operations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-do-aggregation-summarization"><i class="fa fa-check"></i><b>1.2</b> How to do aggregation/ summarization</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#summarization-after-grouping"><i class="fa fa-check"></i><b>1.2.1</b> Summarization after grouping</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#summarization-with-upgroup"><i class="fa fa-check"></i><b>1.2.2</b> Summarization with upgroup</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate-new-variables-after-grouping"><i class="fa fa-check"></i><b>1.2.3</b> Mutate new variables after grouping</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#recode-and-generate-new-variables-then-value-label"><i class="fa fa-check"></i><b>1.2.4</b> Recode and generate new variables, then value label</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-creat-table-1-with-test"><i class="fa fa-check"></i><b>1.3</b> How to creat table 1 with test</a></li>
<li class="chapter" data-level="1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#imputing-missing-data-with-mice"><i class="fa fa-check"></i><b>1.4</b> Imputing Missing Data with MICE</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>2</b> Machine learning</a></li>
<li class="chapter" data-level="3" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>3</b> Deep learning</a></li>
<li class="chapter" data-level="4" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>4</b> Data visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization.html"><a href="data-visualization.html#data-visualization-introduction"><i class="fa fa-check"></i><b>4.1</b> Data visualization introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization.html"><a href="data-visualization.html#summarization"><i class="fa fa-check"></i><b>4.1.1</b> Summarization</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-visualization.html"><a href="data-visualization.html#explore-missing-values"><i class="fa fa-check"></i><b>4.1.2</b> Explore missing values</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-visualization.html"><a href="data-visualization.html#add-statistical-test"><i class="fa fa-check"></i><b>4.1.3</b> Add statistical test</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-visualization.html"><a href="data-visualization.html#add-texts-to-dots"><i class="fa fa-check"></i><b>4.1.4</b> Add texts to dots</a></li>
<li class="chapter" data-level="4.1.5" data-path="data-visualization.html"><a href="data-visualization.html#set-the-legend"><i class="fa fa-check"></i><b>4.1.5</b> Set the legend</a></li>
<li class="chapter" data-level="4.1.6" data-path="data-visualization.html"><a href="data-visualization.html#create-a-panel-of-plots"><i class="fa fa-check"></i><b>4.1.6</b> Create a panel of plots</a></li>
<li class="chapter" data-level="4.1.7" data-path="data-visualization.html"><a href="data-visualization.html#plots-in-regression"><i class="fa fa-check"></i><b>4.1.7</b> Plots in regression</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>4.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualization.html"><a href="data-visualization.html#create-a-empty-canvas"><i class="fa fa-check"></i><b>4.2.1</b> Create a empty canvas</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualization.html"><a href="data-visualization.html#add-a-layergeom-of-points-to-the-canvas"><i class="fa fa-check"></i><b>4.2.2</b> Add a layer/geom of <code>points</code> to the canvas</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualization.html"><a href="data-visualization.html#add-another-aesthetic"><i class="fa fa-check"></i><b>4.2.3</b> Add another aesthetic</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-visualization.html"><a href="data-visualization.html#add-other-aesthetic"><i class="fa fa-check"></i><b>4.2.4</b> Add other aesthetic</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualization.html"><a href="data-visualization.html#bar-chart"><i class="fa fa-check"></i><b>4.3</b> Bar chart</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualization.html"><a href="data-visualization.html#add-some-options-for-the-whole-ggplot-rather-than-layers"><i class="fa fa-check"></i><b>4.3.1</b> Add some options for the whole ggplot rather than layers</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-visualization.html"><a href="data-visualization.html#grouped-bar-chart"><i class="fa fa-check"></i><b>4.3.2</b> Grouped bar chart</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualization.html"><a href="data-visualization.html#line-charts"><i class="fa fa-check"></i><b>4.4</b> Line charts</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization.html"><a href="data-visualization.html#grouped-by-colour-variable"><i class="fa fa-check"></i><b>4.4.1</b> Grouped by <code>colour variable</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-visualization.html"><a href="data-visualization.html#multiple-aesthetics"><i class="fa fa-check"></i><b>4.4.2</b> Multiple aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization.html"><a href="data-visualization.html#ggplot2-parameters"><i class="fa fa-check"></i><b>4.5</b> ggplot2 parameters</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualization.html"><a href="data-visualization.html#components-of-plot"><i class="fa fa-check"></i><b>4.5.1</b> Components of plot</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualization.html"><a href="data-visualization.html#create-main-title-axis-labels-caption"><i class="fa fa-check"></i><b>4.5.2</b> Create main title, axis labels, caption</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-visualization.html"><a href="data-visualization.html#create-legend-title-position"><i class="fa fa-check"></i><b>4.5.3</b> Create legend title, position</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-visualization.html"><a href="data-visualization.html#change-plot-colors"><i class="fa fa-check"></i><b>4.5.4</b> Change plot colors</a></li>
<li class="chapter" data-level="4.5.5" data-path="data-visualization.html"><a href="data-visualization.html#change-points-shapes-transparent-and-size"><i class="fa fa-check"></i><b>4.5.5</b> Change points shapes, transparent and size</a></li>
<li class="chapter" data-level="4.5.6" data-path="data-visualization.html"><a href="data-visualization.html#change-bars-position"><i class="fa fa-check"></i><b>4.5.6</b> Change bars position</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-visualization.html"><a href="data-visualization.html#add-text-annotations"><i class="fa fa-check"></i><b>4.5.7</b> Add text annotations</a></li>
<li class="chapter" data-level="4.5.8" data-path="data-visualization.html"><a href="data-visualization.html#add-a-line-that-separates-points"><i class="fa fa-check"></i><b>4.5.8</b> Add a line that (separates points)</a></li>
<li class="chapter" data-level="4.5.9" data-path="data-visualization.html"><a href="data-visualization.html#using-scale_-function"><i class="fa fa-check"></i><b>4.5.9</b> Using scale_ function</a></li>
<li class="chapter" data-level="4.5.10" data-path="data-visualization.html"><a href="data-visualization.html#change-coordinates"><i class="fa fa-check"></i><b>4.5.10</b> Change coordinates</a></li>
<li class="chapter" data-level="4.5.11" data-path="data-visualization.html"><a href="data-visualization.html#customize-axis-ticks"><i class="fa fa-check"></i><b>4.5.11</b> Customize axis ticks</a></li>
<li class="chapter" data-level="4.5.12" data-path="data-visualization.html"><a href="data-visualization.html#flip-and-reverse-plot"><i class="fa fa-check"></i><b>4.5.12</b> Flip and reverse plot</a></li>
<li class="chapter" data-level="4.5.13" data-path="data-visualization.html"><a href="data-visualization.html#create-stats"><i class="fa fa-check"></i><b>4.5.13</b> Create stats</a></li>
<li class="chapter" data-level="4.5.14" data-path="data-visualization.html"><a href="data-visualization.html#facets"><i class="fa fa-check"></i><b>4.5.14</b> Facets</a></li>
<li class="chapter" data-level="4.5.15" data-path="data-visualization.html"><a href="data-visualization.html#theme"><i class="fa fa-check"></i><b>4.5.15</b> Theme</a></li>
<li class="chapter" data-level="4.5.16" data-path="data-visualization.html"><a href="data-visualization.html#how-to-setup-subscripts-or-superscripts"><i class="fa fa-check"></i><b>4.5.16</b> How to setup subscripts or superscripts</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualization.html"><a href="data-visualization.html#how-to-create-advanced-plots"><i class="fa fa-check"></i><b>4.6</b> How to create advanced plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>5</b> Basic statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistics.html"><a href="basic-statistics.html#the-essentials-of-r"><i class="fa fa-check"></i><b>5.1</b> The essentials of R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basic-statistics.html"><a href="basic-statistics.html#manipulation-of-vector"><i class="fa fa-check"></i><b>5.1.1</b> Manipulation of vector</a></li>
<li class="chapter" data-level="5.1.2" data-path="basic-statistics.html"><a href="basic-statistics.html#generate-sequence-or-repeted-sequece"><i class="fa fa-check"></i><b>5.1.2</b> Generate sequence or repeted sequece</a></li>
<li class="chapter" data-level="5.1.3" data-path="basic-statistics.html"><a href="basic-statistics.html#get-directory-and-write-data-out-and-in"><i class="fa fa-check"></i><b>5.1.3</b> Get directory and write data out and in</a></li>
<li class="chapter" data-level="5.1.4" data-path="basic-statistics.html"><a href="basic-statistics.html#function"><i class="fa fa-check"></i><b>5.1.4</b> Function</a></li>
<li class="chapter" data-level="5.1.5" data-path="basic-statistics.html"><a href="basic-statistics.html#plot"><i class="fa fa-check"></i><b>5.1.5</b> Plot</a></li>
<li class="chapter" data-level="5.1.6" data-path="basic-statistics.html"><a href="basic-statistics.html#build-model-and-plot"><i class="fa fa-check"></i><b>5.1.6</b> Build model and plot</a></li>
<li class="chapter" data-level="5.1.7" data-path="basic-statistics.html"><a href="basic-statistics.html#rename-names-of-columns"><i class="fa fa-check"></i><b>5.1.7</b> Rename names of columns</a></li>
<li class="chapter" data-level="5.1.8" data-path="basic-statistics.html"><a href="basic-statistics.html#class-of-dataframe"><i class="fa fa-check"></i><b>5.1.8</b> Class of dataframe</a></li>
<li class="chapter" data-level="5.1.9" data-path="basic-statistics.html"><a href="basic-statistics.html#generate-new-variable-for-dataframe-character"><i class="fa fa-check"></i><b>5.1.9</b> Generate new variable for dataframe (character)</a></li>
<li class="chapter" data-level="5.1.10" data-path="basic-statistics.html"><a href="basic-statistics.html#create-a-new-dataframe-using-rnorm---random-number-from-distribution"><i class="fa fa-check"></i><b>5.1.10</b> Create a new dataframe using ‘rnorm’ - random number from distribution</a></li>
<li class="chapter" data-level="5.1.11" data-path="basic-statistics.html"><a href="basic-statistics.html#left-join-two-dataframes"><i class="fa fa-check"></i><b>5.1.11</b> Left join two dataframes</a></li>
<li class="chapter" data-level="5.1.12" data-path="basic-statistics.html"><a href="basic-statistics.html#select-variables"><i class="fa fa-check"></i><b>5.1.12</b> Select variables</a></li>
<li class="chapter" data-level="5.1.13" data-path="basic-statistics.html"><a href="basic-statistics.html#filter-observations"><i class="fa fa-check"></i><b>5.1.13</b> Filter observations</a></li>
<li class="chapter" data-level="5.1.14" data-path="basic-statistics.html"><a href="basic-statistics.html#append-rows"><i class="fa fa-check"></i><b>5.1.14</b> Append rows</a></li>
<li class="chapter" data-level="5.1.15" data-path="basic-statistics.html"><a href="basic-statistics.html#create-new-variables-instead-of-old-variables"><i class="fa fa-check"></i><b>5.1.15</b> Create new variables instead of old variables</a></li>
<li class="chapter" data-level="5.1.16" data-path="basic-statistics.html"><a href="basic-statistics.html#summarise-statistics"><i class="fa fa-check"></i><b>5.1.16</b> summarise statistics</a></li>
<li class="chapter" data-level="5.1.17" data-path="basic-statistics.html"><a href="basic-statistics.html#group-dataframe-then-summarise-statistics"><i class="fa fa-check"></i><b>5.1.17</b> Group dataframe then summarise statistics</a></li>
<li class="chapter" data-level="5.1.18" data-path="basic-statistics.html"><a href="basic-statistics.html#ungroup-then-summarise-statistics"><i class="fa fa-check"></i><b>5.1.18</b> Ungroup then summarise statistics</a></li>
<li class="chapter" data-level="5.1.19" data-path="basic-statistics.html"><a href="basic-statistics.html#summary-linear-regression-model"><i class="fa fa-check"></i><b>5.1.19</b> Summary linear regression model</a></li>
<li class="chapter" data-level="5.1.20" data-path="basic-statistics.html"><a href="basic-statistics.html#create-frequency-table"><i class="fa fa-check"></i><b>5.1.20</b> Create frequency table</a></li>
<li class="chapter" data-level="5.1.21" data-path="basic-statistics.html"><a href="basic-statistics.html#value-and-variable-label"><i class="fa fa-check"></i><b>5.1.21</b> Value and variable label</a></li>
<li class="chapter" data-level="5.1.22" data-path="basic-statistics.html"><a href="basic-statistics.html#recode-a-variable"><i class="fa fa-check"></i><b>5.1.22</b> Recode a variable</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basic-statistics.html"><a href="basic-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>5.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.3" data-path="basic-statistics.html"><a href="basic-statistics.html#common-statistical-distribution"><i class="fa fa-check"></i><b>5.3</b> Common statistical distribution</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-models.html"><a href="statistical-models.html"><i class="fa fa-check"></i><b>6</b> Statistical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-models.html"><a href="statistical-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistical-models.html"><a href="statistical-models.html#linear-regeression-assumptions"><i class="fa fa-check"></i><b>6.1.1</b> Linear regeression assumptions</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistical-models.html"><a href="statistical-models.html#population-regression-function"><i class="fa fa-check"></i><b>6.1.2</b> Population regression function</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistical-models.html"><a href="statistical-models.html#population-regression-model"><i class="fa fa-check"></i><b>6.1.3</b> Population regression model</a></li>
<li class="chapter" data-level="6.1.4" data-path="statistical-models.html"><a href="statistical-models.html#sample-regression-model"><i class="fa fa-check"></i><b>6.1.4</b> Sample regression model</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistical-models.html"><a href="statistical-models.html#least-squares-minimize-qsum-y_i-haty_i2"><i class="fa fa-check"></i><b>6.1.5</b> Least squares: minimize <span class="math inline">\(Q=\sum (Y_i-\hat{Y}_i)^2\)</span></a></li>
<li class="chapter" data-level="6.1.6" data-path="statistical-models.html"><a href="statistical-models.html#solve-hatbeta_1hatbeta_2-and-variance"><i class="fa fa-check"></i><b>6.1.6</b> Solve <span class="math inline">\(\hat{\beta}_1,\hat{\beta}_2\)</span> and variance</a></li>
<li class="chapter" data-level="6.1.7" data-path="statistical-models.html"><a href="statistical-models.html#calculate-the-variance-hatsigma2-of-error-e_i"><i class="fa fa-check"></i><b>6.1.7</b> Calculate the variance <span class="math inline">\(\hat{\sigma}^2\)</span> of error <span class="math inline">\(e_i\)</span></a></li>
<li class="chapter" data-level="6.1.8" data-path="statistical-models.html"><a href="statistical-models.html#sum-of-squares-decomposition"><i class="fa fa-check"></i><b>6.1.8</b> Sum of squares decomposition</a></li>
<li class="chapter" data-level="6.1.9" data-path="statistical-models.html"><a href="statistical-models.html#coefficient-of-determination-r2-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.1.9</b> Coefficient of determination <span class="math inline">\(R^2\)</span> and goodness of fit</a></li>
<li class="chapter" data-level="6.1.10" data-path="statistical-models.html"><a href="statistical-models.html#test-of-regression-coefficients"><i class="fa fa-check"></i><b>6.1.10</b> Test of regression coefficients</a></li>
<li class="chapter" data-level="6.1.11" data-path="statistical-models.html"><a href="statistical-models.html#statistical-test-of-model"><i class="fa fa-check"></i><b>6.1.11</b> Statistical test of model</a></li>
<li class="chapter" data-level="6.1.12" data-path="statistical-models.html"><a href="statistical-models.html#mean-prediction"><i class="fa fa-check"></i><b>6.1.12</b> Mean prediction</a></li>
<li class="chapter" data-level="6.1.13" data-path="statistical-models.html"><a href="statistical-models.html#individual-prediction"><i class="fa fa-check"></i><b>6.1.13</b> Individual prediction</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistical-models.html"><a href="statistical-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.2</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="statistical-models.html"><a href="statistical-models.html#matrix-format"><i class="fa fa-check"></i><b>6.2.1</b> Matrix format</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistical-models.html"><a href="statistical-models.html#variance-covariance-matrix-of-random-errors"><i class="fa fa-check"></i><b>6.2.2</b> Variance covariance matrix of random errors</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistical-models.html"><a href="statistical-models.html#minimize-qsum-y-haty2"><i class="fa fa-check"></i><b>6.2.3</b> Minimize <span class="math inline">\(Q=\sum (y-\hat{y})^2\)</span></a></li>
<li class="chapter" data-level="6.2.4" data-path="statistical-models.html"><a href="statistical-models.html#solve-hatbeta-by-derivation"><i class="fa fa-check"></i><b>6.2.4</b> Solve <span class="math inline">\(\hat{\beta}\)</span> by derivation</a></li>
<li class="chapter" data-level="6.2.5" data-path="statistical-models.html"><a href="statistical-models.html#solve-vartext-covmathbfhatbeta"><i class="fa fa-check"></i><b>6.2.5</b> Solve <span class="math inline">\(var\text{-}cov(\mathbf{\hat{\beta}})\)</span></a></li>
<li class="chapter" data-level="6.2.6" data-path="statistical-models.html"><a href="statistical-models.html#solve-s2mathbfhatbeta-sample"><i class="fa fa-check"></i><b>6.2.6</b> Solve <span class="math inline">\(S^2(\mathbf{\hat{\beta}})\)</span> (sample)</a></li>
<li class="chapter" data-level="6.2.7" data-path="statistical-models.html"><a href="statistical-models.html#sum-of-squares-decomposition-matrix-format"><i class="fa fa-check"></i><b>6.2.7</b> Sum of squares decomposition (matrix format)</a></li>
<li class="chapter" data-level="6.2.8" data-path="statistical-models.html"><a href="statistical-models.html#determination-coefficient-r2-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.2.8</b> Determination coefficient <span class="math inline">\(R^2\)</span> and goodness of fit</a></li>
<li class="chapter" data-level="6.2.9" data-path="statistical-models.html"><a href="statistical-models.html#test-of-regression-coefficients-1"><i class="fa fa-check"></i><b>6.2.9</b> Test of regression coefficients</a></li>
<li class="chapter" data-level="6.2.10" data-path="statistical-models.html"><a href="statistical-models.html#test-of-model"><i class="fa fa-check"></i><b>6.2.10</b> Test of model</a></li>
<li class="chapter" data-level="6.2.11" data-path="statistical-models.html"><a href="statistical-models.html#mean-prediction-multiple-regression"><i class="fa fa-check"></i><b>6.2.11</b> Mean prediction (multiple regression)</a></li>
<li class="chapter" data-level="6.2.12" data-path="statistical-models.html"><a href="statistical-models.html#individual-prediction-multiple-regression"><i class="fa fa-check"></i><b>6.2.12</b> Individual prediction (multiple regression)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="statistical-models.html"><a href="statistical-models.html#multiple-linear-regression-practice"><i class="fa fa-check"></i><b>6.3</b> Multiple linear regression practice</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="statistical-models.html"><a href="statistical-models.html#load-required-packages"><i class="fa fa-check"></i><b>6.3.1</b> Load required packages</a></li>
<li class="chapter" data-level="6.3.2" data-path="statistical-models.html"><a href="statistical-models.html#loading-and-describing-data"><i class="fa fa-check"></i><b>6.3.2</b> Loading and describing data</a></li>
<li class="chapter" data-level="6.3.3" data-path="statistical-models.html"><a href="statistical-models.html#create-table-1"><i class="fa fa-check"></i><b>6.3.3</b> Create table 1</a></li>
<li class="chapter" data-level="6.3.4" data-path="statistical-models.html"><a href="statistical-models.html#missingness-checking"><i class="fa fa-check"></i><b>6.3.4</b> Missingness checking</a></li>
<li class="chapter" data-level="6.3.5" data-path="statistical-models.html"><a href="statistical-models.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.3.5</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.3.6" data-path="statistical-models.html"><a href="statistical-models.html#transformations"><i class="fa fa-check"></i><b>6.3.6</b> Transformations</a></li>
<li class="chapter" data-level="6.3.7" data-path="statistical-models.html"><a href="statistical-models.html#check-linearity-between-y-and-x"><i class="fa fa-check"></i><b>6.3.7</b> Check linearity between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span></a></li>
<li class="chapter" data-level="6.3.8" data-path="statistical-models.html"><a href="statistical-models.html#data-imputation-and-normalization"><i class="fa fa-check"></i><b>6.3.8</b> Data imputation and normalization</a></li>
<li class="chapter" data-level="6.3.9" data-path="statistical-models.html"><a href="statistical-models.html#generate-dummy-variables"><i class="fa fa-check"></i><b>6.3.9</b> Generate dummy variables</a></li>
<li class="chapter" data-level="6.3.10" data-path="statistical-models.html"><a href="statistical-models.html#splitting-data-into-training-and-test-data"><i class="fa fa-check"></i><b>6.3.10</b> Splitting data into training and test data</a></li>
<li class="chapter" data-level="6.3.11" data-path="statistical-models.html"><a href="statistical-models.html#step-regression"><i class="fa fa-check"></i><b>6.3.11</b> Step regression</a></li>
<li class="chapter" data-level="6.3.12" data-path="statistical-models.html"><a href="statistical-models.html#create-a-model-after-selecting-variables"><i class="fa fa-check"></i><b>6.3.12</b> Create a model after selecting variables</a></li>
<li class="chapter" data-level="6.3.13" data-path="statistical-models.html"><a href="statistical-models.html#multicollinearity-checking"><i class="fa fa-check"></i><b>6.3.13</b> Multicollinearity checking</a></li>
<li class="chapter" data-level="6.3.14" data-path="statistical-models.html"><a href="statistical-models.html#plot-model-to-check-assumptions"><i class="fa fa-check"></i><b>6.3.14</b> Plot model to check assumptions</a></li>
<li class="chapter" data-level="6.3.15" data-path="statistical-models.html"><a href="statistical-models.html#add-polynomial-quadratic-terms"><i class="fa fa-check"></i><b>6.3.15</b> Add polynomial (quadratic) terms</a></li>
<li class="chapter" data-level="6.3.16" data-path="statistical-models.html"><a href="statistical-models.html#add-interaction-terms"><i class="fa fa-check"></i><b>6.3.16</b> Add interaction terms</a></li>
<li class="chapter" data-level="6.3.17" data-path="statistical-models.html"><a href="statistical-models.html#robust-regression"><i class="fa fa-check"></i><b>6.3.17</b> Robust regression</a></li>
<li class="chapter" data-level="6.3.18" data-path="statistical-models.html"><a href="statistical-models.html#create-a-model-before-transforming-data"><i class="fa fa-check"></i><b>6.3.18</b> Create a model before transforming data</a></li>
<li class="chapter" data-level="6.3.19" data-path="statistical-models.html"><a href="statistical-models.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>6.3.19</b> K-fold cross validation</a></li>
<li class="chapter" data-level="6.3.20" data-path="statistical-models.html"><a href="statistical-models.html#nonnest-models-comparisons"><i class="fa fa-check"></i><b>6.3.20</b> Nonnest models comparisons</a></li>
<li class="chapter" data-level="6.3.21" data-path="statistical-models.html"><a href="statistical-models.html#posterior-predictive-diagnostic-checks"><i class="fa fa-check"></i><b>6.3.21</b> Posterior predictive / diagnostic checks</a></li>
<li class="chapter" data-level="6.3.22" data-path="statistical-models.html"><a href="statistical-models.html#forest-plot-for-coefficients"><i class="fa fa-check"></i><b>6.3.22</b> Forest plot for coefficients</a></li>
<li class="chapter" data-level="6.3.23" data-path="statistical-models.html"><a href="statistical-models.html#relative-importance"><i class="fa fa-check"></i><b>6.3.23</b> Relative Importance</a></li>
<li class="chapter" data-level="6.3.24" data-path="statistical-models.html"><a href="statistical-models.html#model-prediction"><i class="fa fa-check"></i><b>6.3.24</b> Model prediction</a></li>
<li class="chapter" data-level="6.3.25" data-path="statistical-models.html"><a href="statistical-models.html#compare-predictions-vs-actual-values"><i class="fa fa-check"></i><b>6.3.25</b> Compare predictions vs actual values</a></li>
<li class="chapter" data-level="6.3.26" data-path="statistical-models.html"><a href="statistical-models.html#manual-computation-haty-and-confidence-interval"><i class="fa fa-check"></i><b>6.3.26</b> Manual computation: <span class="math inline">\(\hat{y}\)</span> and confidence interval</a></li>
<li class="chapter" data-level="6.3.27" data-path="statistical-models.html"><a href="statistical-models.html#external-data-validation"><i class="fa fa-check"></i><b>6.3.27</b> External data validation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="statistical-models.html"><a href="statistical-models.html#variable-selection"><i class="fa fa-check"></i><b>6.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="statistical-models.html"><a href="statistical-models.html#chapter-takeaways"><i class="fa fa-check"></i><b>6.4.1</b> Chapter takeaways</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-theory"><i class="fa fa-check"></i><b>6.5</b> Linear mixed model theory</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="statistical-models.html"><a href="statistical-models.html#matrix-format-1"><i class="fa fa-check"></i><b>6.5.1</b> Matrix format</a></li>
<li class="chapter" data-level="6.5.2" data-path="statistical-models.html"><a href="statistical-models.html#why-random-effects-create-correlation"><i class="fa fa-check"></i><b>6.5.2</b> Why random effects create correlation</a></li>
<li class="chapter" data-level="6.5.3" data-path="statistical-models.html"><a href="statistical-models.html#example-reducing-the-work-stress-of-nurses"><i class="fa fa-check"></i><b>6.5.3</b> Example: reducing the work stress of nurses</a></li>
<li class="chapter" data-level="6.5.4" data-path="statistical-models.html"><a href="statistical-models.html#the-dependent-variable-mathbfy"><i class="fa fa-check"></i><b>6.5.4</b> The dependent variable <span class="math inline">\(\mathbf{y}\)</span></a></li>
<li class="chapter" data-level="6.5.5" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effects-design-matrix-mathbfx"><i class="fa fa-check"></i><b>6.5.5</b> Fixed effects design matrix <span class="math inline">\(\mathbf{X}\)</span></a></li>
<li class="chapter" data-level="6.5.6" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficients-boldsymbolhatbeta"><i class="fa fa-check"></i><b>6.5.6</b> Fixed effect coefficients <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></a></li>
<li class="chapter" data-level="6.5.7" data-path="statistical-models.html"><a href="statistical-models.html#variancecovariance-matrix-of-hatbeta"><i class="fa fa-check"></i><b>6.5.7</b> Variance–covariance matrix of <span class="math inline">\(\hat{\beta}\)</span></a></li>
<li class="chapter" data-level="6.5.8" data-path="statistical-models.html"><a href="statistical-models.html#random-effects-design-matrix-mathbfz"><i class="fa fa-check"></i><b>6.5.8</b> Random effects design matrix <span class="math inline">\(\mathbf{Z}\)</span></a></li>
<li class="chapter" data-level="6.5.9" data-path="statistical-models.html"><a href="statistical-models.html#random-effects-boldsymbolu-and-blup-intuition"><i class="fa fa-check"></i><b>6.5.9</b> Random effects <span class="math inline">\(\boldsymbol{u}\)</span> and BLUP intuition</a></li>
<li class="chapter" data-level="6.5.10" data-path="statistical-models.html"><a href="statistical-models.html#covariance-structures-mathbfg-mathbfr-and-mathbfv"><i class="fa fa-check"></i><b>6.5.10</b> Covariance structures: <span class="math inline">\(\mathbf{G}\)</span>, <span class="math inline">\(\mathbf{R}\)</span>, and <span class="math inline">\(\mathbf{V}\)</span></a></li>
<li class="chapter" data-level="6.5.11" data-path="statistical-models.html"><a href="statistical-models.html#estimating-variance-parameters"><i class="fa fa-check"></i><b>6.5.11</b> Estimating variance parameters</a></li>
<li class="chapter" data-level="6.5.12" data-path="statistical-models.html"><a href="statistical-models.html#model-statement-and-interpretation"><i class="fa fa-check"></i><b>6.5.12</b> Model statement and interpretation</a></li>
<li class="chapter" data-level="6.5.13" data-path="statistical-models.html"><a href="statistical-models.html#testing-and-model-comparison"><i class="fa fa-check"></i><b>6.5.13</b> Testing and model comparison</a></li>
<li class="chapter" data-level="6.5.14" data-path="statistical-models.html"><a href="statistical-models.html#diagnostics-what-to-actually-check"><i class="fa fa-check"></i><b>6.5.14</b> Diagnostics (what to actually check)</a></li>
<li class="chapter" data-level="6.5.15" data-path="statistical-models.html"><a href="statistical-models.html#practical-takeaway-for-readers"><i class="fa fa-check"></i><b>6.5.15</b> Practical takeaway for readers</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-practice"><i class="fa fa-check"></i><b>6.6</b> Linear mixed model practice</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="statistical-models.html"><a href="statistical-models.html#loading-data-and-library"><i class="fa fa-check"></i><b>6.6.1</b> Loading data and library</a></li>
<li class="chapter" data-level="6.6.2" data-path="statistical-models.html"><a href="statistical-models.html#general-linear-regression-ols"><i class="fa fa-check"></i><b>6.6.2</b> General linear regression (OLS)</a></li>
<li class="chapter" data-level="6.6.3" data-path="statistical-models.html"><a href="statistical-models.html#generalized-linear-regression-glm"><i class="fa fa-check"></i><b>6.6.3</b> Generalized linear regression (GLM)</a></li>
<li class="chapter" data-level="6.6.4" data-path="statistical-models.html"><a href="statistical-models.html#varying-intercept-by-adding-a-stratum-variable-as-fixed-effect-glm"><i class="fa fa-check"></i><b>6.6.4</b> Varying intercept by adding a stratum variable as fixed effect (GLM)</a></li>
<li class="chapter" data-level="6.6.5" data-path="statistical-models.html"><a href="statistical-models.html#comparisons-of-models-fixed-effect-approach"><i class="fa fa-check"></i><b>6.6.5</b> Comparisons of models (fixed effect approach)</a></li>
<li class="chapter" data-level="6.6.6" data-path="statistical-models.html"><a href="statistical-models.html#adding-class-and-school-as-fixed-effects-glm"><i class="fa fa-check"></i><b>6.6.6</b> Adding class and school as fixed effects (GLM)</a></li>
<li class="chapter" data-level="6.6.7" data-path="statistical-models.html"><a href="statistical-models.html#considering-different-slopes-by-stratum-glm"><i class="fa fa-check"></i><b>6.6.7</b> Considering different slopes by stratum (GLM)</a></li>
<li class="chapter" data-level="6.6.8" data-path="statistical-models.html"><a href="statistical-models.html#varying-intercept-with-lmm"><i class="fa fa-check"></i><b>6.6.8</b> Varying intercept with LMM</a></li>
<li class="chapter" data-level="6.6.9" data-path="statistical-models.html"><a href="statistical-models.html#add-class-and-school-as-random-effects"><i class="fa fa-check"></i><b>6.6.9</b> Add class and school as random effects</a></li>
<li class="chapter" data-level="6.6.10" data-path="statistical-models.html"><a href="statistical-models.html#nested-terms-schoolclass"><i class="fa fa-check"></i><b>6.6.10</b> Nested terms: <code>school/class</code></a></li>
<li class="chapter" data-level="6.6.11" data-path="statistical-models.html"><a href="statistical-models.html#varying-slope-with-lmm"><i class="fa fa-check"></i><b>6.6.11</b> Varying slope with LMM</a></li>
<li class="chapter" data-level="6.6.12" data-path="statistical-models.html"><a href="statistical-models.html#summarize-model-8"><i class="fa fa-check"></i><b>6.6.12</b> Summarize model 8</a></li>
<li class="chapter" data-level="6.6.13" data-path="statistical-models.html"><a href="statistical-models.html#testing-random-effects-lrt-logic"><i class="fa fa-check"></i><b>6.6.13</b> Testing random effects (LRT logic)</a></li>
<li class="chapter" data-level="6.6.14" data-path="statistical-models.html"><a href="statistical-models.html#visualizing-grouping-structure"><i class="fa fa-check"></i><b>6.6.14</b> Visualizing grouping structure</a></li>
<li class="chapter" data-level="6.6.15" data-path="statistical-models.html"><a href="statistical-models.html#residual-checks-by-grouping-variables"><i class="fa fa-check"></i><b>6.6.15</b> Residual checks by grouping variables</a></li>
<li class="chapter" data-level="6.6.16" data-path="statistical-models.html"><a href="statistical-models.html#residuals-vs-explanatory-variables"><i class="fa fa-check"></i><b>6.6.16</b> Residuals vs explanatory variables</a></li>
<li class="chapter" data-level="6.6.17" data-path="statistical-models.html"><a href="statistical-models.html#normality-checks"><i class="fa fa-check"></i><b>6.6.17</b> Normality checks</a></li>
<li class="chapter" data-level="6.6.18" data-path="statistical-models.html"><a href="statistical-models.html#extracting-elements-parameters"><i class="fa fa-check"></i><b>6.6.18</b> Extracting elements (parameters)</a></li>
<li class="chapter" data-level="6.6.19" data-path="statistical-models.html"><a href="statistical-models.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>6.6.19</b> Fitted values and residuals</a></li>
<li class="chapter" data-level="6.6.20" data-path="statistical-models.html"><a href="statistical-models.html#fitted-lines-by-group"><i class="fa fa-check"></i><b>6.6.20</b> Fitted lines by group</a></li>
<li class="chapter" data-level="6.6.21" data-path="statistical-models.html"><a href="statistical-models.html#model-diagnostics-second-dataset-nurses"><i class="fa fa-check"></i><b>6.6.21</b> Model diagnostics (second dataset: Nurses)</a></li>
<li class="chapter" data-level="6.6.22" data-path="statistical-models.html"><a href="statistical-models.html#intra-class-correlation-icc"><i class="fa fa-check"></i><b>6.6.22</b> Intra class correlation (ICC)</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-intercept-lme4"><i class="fa fa-check"></i><b>6.7</b> Linear mixed model covariance decomposition with random intercept — lme4</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data"><i class="fa fa-check"></i><b>6.7.1</b> Load data</a></li>
<li class="chapter" data-level="6.7.2" data-path="statistical-models.html"><a href="statistical-models.html#plot-means-and-variances-by-higher-level-variable-grouping"><i class="fa fa-check"></i><b>6.7.2</b> Plot means and variances by higher level variable (grouping)</a></li>
<li class="chapter" data-level="6.7.3" data-path="statistical-models.html"><a href="statistical-models.html#using-glm-style-fixed-effects-baseline-reference"><i class="fa fa-check"></i><b>6.7.3</b> Using glm-style fixed effects (baseline reference)</a></li>
<li class="chapter" data-level="6.7.4" data-path="statistical-models.html"><a href="statistical-models.html#using-lmm-random-intercept-in-lme4"><i class="fa fa-check"></i><b>6.7.4</b> Using LMM (random intercept) in lme4</a></li>
<li class="chapter" data-level="6.7.5" data-path="statistical-models.html"><a href="statistical-models.html#get-mathbfx-mathbfy-mathbfz"><i class="fa fa-check"></i><b>6.7.5</b> Get <span class="math inline">\(\mathbf{X}\)</span>, <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\mathbf{Z}\)</span></a></li>
<li class="chapter" data-level="6.7.6" data-path="statistical-models.html"><a href="statistical-models.html#get-fixed-and-random-effect-coefficients"><i class="fa fa-check"></i><b>6.7.6</b> Get fixed and random effect coefficients</a></li>
<li class="chapter" data-level="6.7.7" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-structure-and-the-role-of-theta"><i class="fa fa-check"></i><b>6.7.7</b> Random effect covariance structure and the role of <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="6.7.8" data-path="statistical-models.html"><a href="statistical-models.html#residual-variance-and-mathbfrsigma2mathbfi"><i class="fa fa-check"></i><b>6.7.8</b> Residual variance and <span class="math inline">\(\mathbf{R}=\sigma^2\mathbf{I}\)</span></a></li>
<li class="chapter" data-level="6.7.9" data-path="statistical-models.html"><a href="statistical-models.html#marginal-covariance-matrix-mathbfv-of-mathbfy"><i class="fa fa-check"></i><b>6.7.9</b> Marginal covariance matrix <span class="math inline">\(\mathbf{V}\)</span> of <span class="math inline">\(\mathbf{y}\)</span></a></li>
<li class="chapter" data-level="6.7.10" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficient-covariance-matrix"><i class="fa fa-check"></i><b>6.7.10</b> Fixed effect coefficient covariance matrix</a></li>
<li class="chapter" data-level="6.7.11" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-matrix-standard-deviation-scale"><i class="fa fa-check"></i><b>6.7.11</b> Random effect covariance matrix (standard deviation scale)</a></li>
<li class="chapter" data-level="6.7.12" data-path="statistical-models.html"><a href="statistical-models.html#compute-fixed-effect-coefficients-manually-gls"><i class="fa fa-check"></i><b>6.7.12</b> Compute fixed effect coefficients manually (GLS)</a></li>
<li class="chapter" data-level="6.7.13" data-path="statistical-models.html"><a href="statistical-models.html#compute-covariance-of-fixed-effect-coefficients-manually"><i class="fa fa-check"></i><b>6.7.13</b> Compute covariance of fixed effect coefficients manually</a></li>
<li class="chapter" data-level="6.7.14" data-path="statistical-models.html"><a href="statistical-models.html#compute-random-effect-coefficients-manually-blups"><i class="fa fa-check"></i><b>6.7.14</b> Compute random effect coefficients manually (BLUPs)</a></li>
<li class="chapter" data-level="6.7.15" data-path="statistical-models.html"><a href="statistical-models.html#compute-predicted-values"><i class="fa fa-check"></i><b>6.7.15</b> Compute predicted values</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-slopes-lme4"><i class="fa fa-check"></i><b>6.8</b> Linear Mixed Model Covariance Decomposition with Random Slopes (lme4)</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data-1"><i class="fa fa-check"></i><b>6.8.1</b> Load data</a></li>
<li class="chapter" data-level="6.8.2" data-path="statistical-models.html"><a href="statistical-models.html#using-a-linear-mixed-model-with-random-slopes"><i class="fa fa-check"></i><b>6.8.2</b> Using a linear mixed model with random slopes</a></li>
<li class="chapter" data-level="6.8.3" data-path="statistical-models.html"><a href="statistical-models.html#extracting-the-design-matrices-x-y-and-z"><i class="fa fa-check"></i><b>6.8.3</b> Extracting the design matrices X, y, and Z</a></li>
<li class="chapter" data-level="6.8.4" data-path="statistical-models.html"><a href="statistical-models.html#fixed-and-random-effect-coefficients"><i class="fa fa-check"></i><b>6.8.4</b> Fixed and random effect coefficients</a></li>
<li class="chapter" data-level="6.8.5" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-structure-matrix-expansion"><i class="fa fa-check"></i><b>6.8.5</b> Random-effect covariance structure (matrix expansion)</a></li>
<li class="chapter" data-level="6.8.6" data-path="statistical-models.html"><a href="statistical-models.html#residual-variance-and-identity-matrix"><i class="fa fa-check"></i><b>6.8.6</b> Residual variance and identity matrix</a></li>
<li class="chapter" data-level="6.8.7" data-path="statistical-models.html"><a href="statistical-models.html#covariance-matrix-of-the-response-vector-y"><i class="fa fa-check"></i><b>6.8.7</b> Covariance matrix of the response vector y</a></li>
<li class="chapter" data-level="6.8.8" data-path="statistical-models.html"><a href="statistical-models.html#covariance-matrix-of-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.8.8</b> Covariance matrix of fixed-effect coefficients</a></li>
<li class="chapter" data-level="6.8.9" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-matrix"><i class="fa fa-check"></i><b>6.8.9</b> Random-effect covariance matrix</a></li>
<li class="chapter" data-level="6.8.10" data-path="statistical-models.html"><a href="statistical-models.html#computing-fixed-effect-coefficients-manually"><i class="fa fa-check"></i><b>6.8.10</b> Computing fixed-effect coefficients manually</a></li>
<li class="chapter" data-level="6.8.11" data-path="statistical-models.html"><a href="statistical-models.html#covariance-of-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.8.11</b> Covariance of fixed-effect coefficients</a></li>
<li class="chapter" data-level="6.8.12" data-path="statistical-models.html"><a href="statistical-models.html#computing-random-effect-coefficients"><i class="fa fa-check"></i><b>6.8.12</b> Computing random-effect coefficients</a></li>
<li class="chapter" data-level="6.8.13" data-path="statistical-models.html"><a href="statistical-models.html#predicted-values"><i class="fa fa-check"></i><b>6.8.13</b> Predicted values</a></li>
<li class="chapter" data-level="6.8.14" data-path="statistical-models.html"><a href="statistical-models.html#model-with-two-grouping-factors"><i class="fa fa-check"></i><b>6.8.14</b> Model with two grouping factors</a></li>
<li class="chapter" data-level="6.8.15" data-path="statistical-models.html"><a href="statistical-models.html#extracting-z-for-the-two-factor-model"><i class="fa fa-check"></i><b>6.8.15</b> Extracting Z for the two-factor model</a></li>
<li class="chapter" data-level="6.8.16" data-path="statistical-models.html"><a href="statistical-models.html#nested-versus-crossed-random-effects"><i class="fa fa-check"></i><b>6.8.16</b> Nested versus crossed random effects</a></li>
<li class="chapter" data-level="6.8.17" data-path="statistical-models.html"><a href="statistical-models.html#remark-nested-vs.-crossed-random-effects"><i class="fa fa-check"></i><b>6.8.17</b> Remark: Nested vs. crossed random effects</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-nlme"><i class="fa fa-check"></i><b>6.9</b> Linear Mixed Model Covariance Decomposition (nlme)</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data-2"><i class="fa fa-check"></i><b>6.9.1</b> Load data</a></li>
<li class="chapter" data-level="6.9.2" data-path="statistical-models.html"><a href="statistical-models.html#exploratory-visualization"><i class="fa fa-check"></i><b>6.9.2</b> Exploratory visualization</a></li>
<li class="chapter" data-level="6.9.3" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-nlme"><i class="fa fa-check"></i><b>6.9.3</b> Using lme (nlme)</a></li>
<li class="chapter" data-level="6.9.4" data-path="statistical-models.html"><a href="statistical-models.html#inference-for-fixed-effects"><i class="fa fa-check"></i><b>6.9.4</b> Inference for fixed effects</a></li>
<li class="chapter" data-level="6.9.5" data-path="statistical-models.html"><a href="statistical-models.html#model-diagnosing"><i class="fa fa-check"></i><b>6.9.5</b> Model diagnosing</a></li>
<li class="chapter" data-level="6.9.6" data-path="statistical-models.html"><a href="statistical-models.html#get-x-y-z-matrices-using-lme4"><i class="fa fa-check"></i><b>6.9.6</b> Get X, y, Z matrices (using lme4)</a></li>
<li class="chapter" data-level="6.9.7" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficient"><i class="fa fa-check"></i><b>6.9.7</b> Fixed effect coefficient</a></li>
<li class="chapter" data-level="6.9.8" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-coefficient"><i class="fa fa-check"></i><b>6.9.8</b> Random effect coefficient</a></li>
<li class="chapter" data-level="6.9.9" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficients-covariance"><i class="fa fa-check"></i><b>6.9.9</b> Fixed effect coefficients covariance</a></li>
<li class="chapter" data-level="6.9.10" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-and-correlation"><i class="fa fa-check"></i><b>6.9.10</b> Random effect covariance and correlation</a></li>
<li class="chapter" data-level="6.9.11" data-path="statistical-models.html"><a href="statistical-models.html#get-y-covariance-directly"><i class="fa fa-check"></i><b>6.9.11</b> Get y covariance directly</a></li>
<li class="chapter" data-level="6.9.12" data-path="statistical-models.html"><a href="statistical-models.html#residual-variance"><i class="fa fa-check"></i><b>6.9.12</b> Residual variance</a></li>
<li class="chapter" data-level="6.9.13" data-path="statistical-models.html"><a href="statistical-models.html#compute-fixed-effect-coefficients-by-gls"><i class="fa fa-check"></i><b>6.9.13</b> Compute fixed effect coefficients (by GLS)</a></li>
<li class="chapter" data-level="6.9.14" data-path="statistical-models.html"><a href="statistical-models.html#compute-covariance-of-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.9.14</b> Compute covariance of fixed effect coefficients</a></li>
<li class="chapter" data-level="6.9.15" data-path="statistical-models.html"><a href="statistical-models.html#compute-random-effect-coefficients-blup"><i class="fa fa-check"></i><b>6.9.15</b> Compute random effect coefficients (BLUP)</a></li>
<li class="chapter" data-level="6.9.16" data-path="statistical-models.html"><a href="statistical-models.html#compute-predicted-values-1"><i class="fa fa-check"></i><b>6.9.16</b> Compute predicted values</a></li>
<li class="chapter" data-level="6.9.17" data-path="statistical-models.html"><a href="statistical-models.html#the-marginal-distribution"><i class="fa fa-check"></i><b>6.9.17</b> The marginal distribution</a></li>
<li class="chapter" data-level="6.9.18" data-path="statistical-models.html"><a href="statistical-models.html#extending-the-covariance-structure-correlated-residual-errors"><i class="fa fa-check"></i><b>6.9.18</b> Extending the covariance structure: correlated residual errors</a></li>
<li class="chapter" data-level="6.9.19" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-gaussian-correlation"><i class="fa fa-check"></i><b>6.9.19</b> Using lme with Gaussian correlation</a></li>
<li class="chapter" data-level="6.9.20" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-autoregressive-ar1"><i class="fa fa-check"></i><b>6.9.20</b> Using lme with autoregressive (AR1)</a></li>
<li class="chapter" data-level="6.9.21" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-exponential-correlation"><i class="fa fa-check"></i><b>6.9.21</b> Using lme with exponential correlation</a></li>
<li class="chapter" data-level="6.9.22" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-unstructured-residual-correlation-corsymm"><i class="fa fa-check"></i><b>6.9.22</b> Using lme with unstructured residual correlation (corSymm)</a></li>
<li class="chapter" data-level="6.9.23" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-compound-symmetry-residual-correlation-corcompsymm"><i class="fa fa-check"></i><b>6.9.23</b> Using lme with compound symmetry residual correlation (corCompSymm)</a></li>
<li class="chapter" data-level="6.9.24" data-path="statistical-models.html"><a href="statistical-models.html#gls-models-correlation-in-residuals-without-random-effects"><i class="fa fa-check"></i><b>6.9.24</b> GLS models: correlation in residuals without random effects</a></li>
<li class="chapter" data-level="6.9.25" data-path="statistical-models.html"><a href="statistical-models.html#gls-with-unstructured-correlation"><i class="fa fa-check"></i><b>6.9.25</b> GLS with unstructured correlation</a></li>
<li class="chapter" data-level="6.9.26" data-path="statistical-models.html"><a href="statistical-models.html#gls-with-compound-symmetry"><i class="fa fa-check"></i><b>6.9.26</b> GLS with compound symmetry</a></li>
<li class="chapter" data-level="6.9.27" data-path="statistical-models.html"><a href="statistical-models.html#practical-limitation-of-lme4"><i class="fa fa-check"></i><b>6.9.27</b> Practical limitation of lme4</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="statistical-models.html"><a href="statistical-models.html#manual-simulating-data-for-linear-mix-model"><i class="fa fa-check"></i><b>6.10</b> Manual simulating data for linear mix model</a></li>
<li class="chapter" data-level="6.11" data-path="statistical-models.html"><a href="statistical-models.html#how-to-calculate-the-prediction-interval-for-lmm"><i class="fa fa-check"></i><b>6.11</b> How to calculate the prediction interval for LMM</a></li>
<li class="chapter" data-level="6.12" data-path="statistical-models.html"><a href="statistical-models.html#least-squares-means-with-interaction-effect"><i class="fa fa-check"></i><b>6.12</b> Least-squares means with interaction effect</a></li>
<li class="chapter" data-level="6.13" data-path="statistical-models.html"><a href="statistical-models.html#spline-regression"><i class="fa fa-check"></i><b>6.13</b> Spline regression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>7</b> Probability</a>
<ul>
<li class="chapter" data-level="7.1" data-path="probability.html"><a href="probability.html#probability-basics"><i class="fa fa-check"></i><b>7.1</b> Probability basics</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="probability.html"><a href="probability.html#events"><i class="fa fa-check"></i><b>7.1.1</b> Events</a></li>
<li class="chapter" data-level="7.1.2" data-path="probability.html"><a href="probability.html#probability-formulas"><i class="fa fa-check"></i><b>7.1.2</b> Probability formulas</a></li>
<li class="chapter" data-level="7.1.3" data-path="probability.html"><a href="probability.html#calculation-of-probability-operations"><i class="fa fa-check"></i><b>7.1.3</b> Calculation of probability (operations)</a></li>
<li class="chapter" data-level="7.1.4" data-path="probability.html"><a href="probability.html#bayess-theorem"><i class="fa fa-check"></i><b>7.1.4</b> Bayes’s theorem</a></li>
<li class="chapter" data-level="7.1.5" data-path="probability.html"><a href="probability.html#random-variables-and-distribution-functions"><i class="fa fa-check"></i><b>7.1.5</b> Random variables and distribution functions</a></li>
<li class="chapter" data-level="7.1.6" data-path="probability.html"><a href="probability.html#probability-distributions-joint-marginal-conditional"><i class="fa fa-check"></i><b>7.1.6</b> Probability distributions (joint, marginal, conditional)</a></li>
<li class="chapter" data-level="7.1.7" data-path="probability.html"><a href="probability.html#conditional-expectation"><i class="fa fa-check"></i><b>7.1.7</b> Conditional expectation</a></li>
<li class="chapter" data-level="7.1.8" data-path="probability.html"><a href="probability.html#conditional-variance"><i class="fa fa-check"></i><b>7.1.8</b> Conditional variance</a></li>
<li class="chapter" data-level="7.1.9" data-path="probability.html"><a href="probability.html#sampling"><i class="fa fa-check"></i><b>7.1.9</b> Sampling</a></li>
<li class="chapter" data-level="7.1.10" data-path="probability.html"><a href="probability.html#central-limit-theorem-and-law-of-large-numbers"><i class="fa fa-check"></i><b>7.1.10</b> Central limit theorem and law of large numbers</a></li>
<li class="chapter" data-level="7.1.11" data-path="probability.html"><a href="probability.html#confidence-interval"><i class="fa fa-check"></i><b>7.1.11</b> Confidence interval</a></li>
<li class="chapter" data-level="7.1.12" data-path="probability.html"><a href="probability.html#introduction-to-hypothesis-testing"><i class="fa fa-check"></i><b>7.1.12</b> Introduction to hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="probability.html"><a href="probability.html#probability-r-practice"><i class="fa fa-check"></i><b>7.2</b> Probability R practice</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="probability.html"><a href="probability.html#integrate"><i class="fa fa-check"></i><b>7.2.1</b> Integrate</a></li>
<li class="chapter" data-level="7.2.2" data-path="probability.html"><a href="probability.html#derivation-symbolic-differentiation"><i class="fa fa-check"></i><b>7.2.2</b> Derivation (symbolic differentiation)</a></li>
<li class="chapter" data-level="7.2.3" data-path="probability.html"><a href="probability.html#create-random-variables-with-specific-distributions"><i class="fa fa-check"></i><b>7.2.3</b> Create random variables with specific distributions</a></li>
<li class="chapter" data-level="7.2.4" data-path="probability.html"><a href="probability.html#probability-function-examples"><i class="fa fa-check"></i><b>7.2.4</b> Probability function examples</a></li>
<li class="chapter" data-level="7.2.5" data-path="probability.html"><a href="probability.html#vector-and-operations"><i class="fa fa-check"></i><b>7.2.5</b> Vector and operations</a></li>
<li class="chapter" data-level="7.2.6" data-path="probability.html"><a href="probability.html#select-and-substitute-elements-of-vector"><i class="fa fa-check"></i><b>7.2.6</b> Select and substitute elements of vector</a></li>
<li class="chapter" data-level="7.2.7" data-path="probability.html"><a href="probability.html#matrix-and-operations"><i class="fa fa-check"></i><b>7.2.7</b> Matrix and operations</a></li>
<li class="chapter" data-level="7.2.8" data-path="probability.html"><a href="probability.html#compute-inverse-determinant-and-eigenvalues"><i class="fa fa-check"></i><b>7.2.8</b> Compute inverse, determinant and eigenvalues</a></li>
<li class="chapter" data-level="7.2.9" data-path="probability.html"><a href="probability.html#dataframe"><i class="fa fa-check"></i><b>7.2.9</b> Dataframe</a></li>
<li class="chapter" data-level="7.2.10" data-path="probability.html"><a href="probability.html#solve-problems-using-simulation"><i class="fa fa-check"></i><b>7.2.10</b> Solve problems using simulation</a></li>
<li class="chapter" data-level="7.2.11" data-path="probability.html"><a href="probability.html#permutations-and-combinations"><i class="fa fa-check"></i><b>7.2.11</b> Permutations and combinations</a></li>
<li class="chapter" data-level="7.2.12" data-path="probability.html"><a href="probability.html#search-value-position-in-vector"><i class="fa fa-check"></i><b>7.2.12</b> Search value position in vector</a></li>
<li class="chapter" data-level="7.2.13" data-path="probability.html"><a href="probability.html#solve-directly-and-optimize"><i class="fa fa-check"></i><b>7.2.13</b> Solve directly and optimize</a></li>
<li class="chapter" data-level="7.2.14" data-path="probability.html"><a href="probability.html#calculate-probability-using-simulation-method"><i class="fa fa-check"></i><b>7.2.14</b> Calculate probability using simulation method</a></li>
<li class="chapter" data-level="7.2.15" data-path="probability.html"><a href="probability.html#discrete-random-variable"><i class="fa fa-check"></i><b>7.2.15</b> Discrete random variable</a></li>
<li class="chapter" data-level="7.2.16" data-path="probability.html"><a href="probability.html#exponent-distribution"><i class="fa fa-check"></i><b>7.2.16</b> Exponent distribution</a></li>
<li class="chapter" data-level="7.2.17" data-path="probability.html"><a href="probability.html#normal-distribution-plot"><i class="fa fa-check"></i><b>7.2.17</b> Normal distribution plot</a></li>
<li class="chapter" data-level="7.2.18" data-path="probability.html"><a href="probability.html#distribution-of-random-variable-function"><i class="fa fa-check"></i><b>7.2.18</b> Distribution of random variable function</a></li>
<li class="chapter" data-level="7.2.19" data-path="probability.html"><a href="probability.html#joint-and-marginal-probability-simulation-approach"><i class="fa fa-check"></i><b>7.2.19</b> Joint and marginal probability (simulation approach)</a></li>
<li class="chapter" data-level="7.2.20" data-path="probability.html"><a href="probability.html#multiple-random-variables-derived-distributions"><i class="fa fa-check"></i><b>7.2.20</b> Multiple random variables: derived distributions</a></li>
<li class="chapter" data-level="7.2.21" data-path="probability.html"><a href="probability.html#sum-of-two-independent-normal-variables"><i class="fa fa-check"></i><b>7.2.21</b> Sum of two independent normal variables</a></li>
<li class="chapter" data-level="7.2.22" data-path="probability.html"><a href="probability.html#generate-a-circle-using-simulated-random-dots"><i class="fa fa-check"></i><b>7.2.22</b> Generate a circle using simulated random dots</a></li>
<li class="chapter" data-level="7.2.23" data-path="probability.html"><a href="probability.html#expectation-simulation"><i class="fa fa-check"></i><b>7.2.23</b> Expectation (simulation)</a></li>
<li class="chapter" data-level="7.2.24" data-path="probability.html"><a href="probability.html#central-limit-theorem-simulation"><i class="fa fa-check"></i><b>7.2.24</b> Central Limit Theorem (simulation)</a></li>
<li class="chapter" data-level="7.2.25" data-path="probability.html"><a href="probability.html#law-of-large-numbers"><i class="fa fa-check"></i><b>7.2.25</b> Law of large numbers</a></li>
<li class="chapter" data-level="7.2.26" data-path="probability.html"><a href="probability.html#empirical-distribution-function-ecdf"><i class="fa fa-check"></i><b>7.2.26</b> Empirical distribution function (ECDF)</a></li>
<li class="chapter" data-level="7.2.27" data-path="probability.html"><a href="probability.html#probability-of-mean-3-simulation"><i class="fa fa-check"></i><b>7.2.27</b> Probability of mean &gt; 3 (simulation)</a></li>
<li class="chapter" data-level="7.2.28" data-path="probability.html"><a href="probability.html#maximum-likelihood-estimate-mle"><i class="fa fa-check"></i><b>7.2.28</b> Maximum likelihood estimate (MLE)</a></li>
<li class="chapter" data-level="7.2.29" data-path="probability.html"><a href="probability.html#t-distribution-f-distribution-plots-and-common-distributions"><i class="fa fa-check"></i><b>7.2.29</b> t distribution, F distribution plots, and common distributions</a></li>
<li class="chapter" data-level="" data-path="probability.html"><a href="probability.html#closing-perspective"><i class="fa fa-check"></i>Closing perspective</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>8</b> Algorithms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>8.1</b> Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="algorithms.html"><a href="algorithms.html#likelihood-estimation"><i class="fa fa-check"></i><b>8.1.1</b> Likelihood estimation</a></li>
<li class="chapter" data-level="8.1.2" data-path="algorithms.html"><a href="algorithms.html#negative-log-likelihood-scalar-form"><i class="fa fa-check"></i><b>8.1.2</b> Negative log-likelihood (scalar form)</a></li>
<li class="chapter" data-level="8.1.3" data-path="algorithms.html"><a href="algorithms.html#matrix-formulation"><i class="fa fa-check"></i><b>8.1.3</b> Matrix formulation</a></li>
<li class="chapter" data-level="8.1.4" data-path="algorithms.html"><a href="algorithms.html#minimizing-the-negative-log-likelihood"><i class="fa fa-check"></i><b>8.1.4</b> Minimizing the negative log-likelihood</a></li>
<li class="chapter" data-level="8.1.5" data-path="algorithms.html"><a href="algorithms.html#taking-derivatives"><i class="fa fa-check"></i><b>8.1.5</b> Taking derivatives</a></li>
<li class="chapter" data-level="8.1.6" data-path="algorithms.html"><a href="algorithms.html#reml-versus-ml"><i class="fa fa-check"></i><b>8.1.6</b> REML versus ML</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="algorithms.html"><a href="algorithms.html#r-demonstration"><i class="fa fa-check"></i><b>8.2</b> R demonstration</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="algorithms.html"><a href="algorithms.html#toy-data"><i class="fa fa-check"></i><b>8.2.1</b> Toy data</a></li>
<li class="chapter" data-level="8.2.2" data-path="algorithms.html"><a href="algorithms.html#linear-regression-closed-form-mle"><i class="fa fa-check"></i><b>8.2.2</b> Linear regression (closed-form MLE)</a></li>
<li class="chapter" data-level="8.2.3" data-path="algorithms.html"><a href="algorithms.html#mle-via-explicit-negative-log-likelihood"><i class="fa fa-check"></i><b>8.2.3</b> MLE via explicit negative log-likelihood</a></li>
<li class="chapter" data-level="8.2.4" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-via-maxlik"><i class="fa fa-check"></i><b>8.2.4</b> Maximum likelihood via <code>maxLik</code></a></li>
<li class="chapter" data-level="8.2.5" data-path="algorithms.html"><a href="algorithms.html#another-example-real-data"><i class="fa fa-check"></i><b>8.2.5</b> Another example (real data)</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="algorithms.html"><a href="algorithms.html#confidence-intervals-from-likelihood"><i class="fa fa-check"></i><b>8.3</b> Confidence intervals from likelihood</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="algorithms.html"><a href="algorithms.html#fisher-information-and-hessian"><i class="fa fa-check"></i><b>8.3.1</b> Fisher information and Hessian</a></li>
<li class="chapter" data-level="8.3.2" data-path="algorithms.html"><a href="algorithms.html#likelihood-ratio-confidence-intervals"><i class="fa fa-check"></i><b>8.3.2</b> Likelihood ratio confidence intervals</a></li>
<li class="chapter" data-level="8.3.3" data-path="algorithms.html"><a href="algorithms.html#profile-likelihood"><i class="fa fa-check"></i><b>8.3.3</b> Profile likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimate-practice"><i class="fa fa-check"></i><b>8.4</b> Maximum likelihood estimate practice</a></li>
<li class="chapter" data-level="8.5" data-path="algorithms.html"><a href="algorithms.html#gradient-descent"><i class="fa fa-check"></i><b>8.5</b> Gradient descent</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="algorithms.html"><a href="algorithms.html#linear-regression-example"><i class="fa fa-check"></i><b>8.5.1</b> Linear regression example</a></li>
<li class="chapter" data-level="8.5.2" data-path="algorithms.html"><a href="algorithms.html#cost-function-and-gradient-descent"><i class="fa fa-check"></i><b>8.5.2</b> Cost function and gradient descent</a></li>
<li class="chapter" data-level="8.5.3" data-path="algorithms.html"><a href="algorithms.html#cost-function-convergence"><i class="fa fa-check"></i><b>8.5.3</b> Cost function convergence</a></li>
<li class="chapter" data-level="8.5.4" data-path="algorithms.html"><a href="algorithms.html#comparing-gradient-descent-and-linear-regression"><i class="fa fa-check"></i><b>8.5.4</b> Comparing gradient descent and linear regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sasmarkdown.html"><a href="sasmarkdown.html"><i class="fa fa-check"></i><b>9</b> SASmarkdown</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#how-to-install-sasmarkdown"><i class="fa fa-check"></i><b>9.1</b> How to install SASmarkdown</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-an-engine"><i class="fa fa-check"></i><b>9.1.1</b> Use an engine</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#common-statements"><i class="fa fa-check"></i><b>9.2</b> Common statements</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#read-in-data-using-informats-date-data"><i class="fa fa-check"></i><b>9.2.1</b> Read in data using informats (date data)</a></li>
<li class="chapter" data-level="9.2.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#compute-mean-and-frequency"><i class="fa fa-check"></i><b>9.2.2</b> Compute mean and frequency</a></li>
<li class="chapter" data-level="9.2.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#sort-a-dataset"><i class="fa fa-check"></i><b>9.2.3</b> Sort a dataset</a></li>
<li class="chapter" data-level="9.2.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#transpose-or-reshape"><i class="fa fa-check"></i><b>9.2.4</b> Transpose or reshape</a></li>
<li class="chapter" data-level="9.2.5" data-path="sasmarkdown.html"><a href="sasmarkdown.html#conditional-statements"><i class="fa fa-check"></i><b>9.2.5</b> Conditional statements</a></li>
<li class="chapter" data-level="9.2.6" data-path="sasmarkdown.html"><a href="sasmarkdown.html#like-operation-to-select-rows-containing-a-pattern"><i class="fa fa-check"></i><b>9.2.6</b> LIKE operation to select rows containing a pattern</a></li>
<li class="chapter" data-level="9.2.7" data-path="sasmarkdown.html"><a href="sasmarkdown.html#change-format-of-a-variable"><i class="fa fa-check"></i><b>9.2.7</b> Change format of a variable</a></li>
<li class="chapter" data-level="9.2.8" data-path="sasmarkdown.html"><a href="sasmarkdown.html#basic-operations"><i class="fa fa-check"></i><b>9.2.8</b> Basic operations</a></li>
<li class="chapter" data-level="9.2.9" data-path="sasmarkdown.html"><a href="sasmarkdown.html#rename-variables-1"><i class="fa fa-check"></i><b>9.2.9</b> Rename variables</a></li>
<li class="chapter" data-level="9.2.10" data-path="sasmarkdown.html"><a href="sasmarkdown.html#text-manipulation"><i class="fa fa-check"></i><b>9.2.10</b> Text manipulation</a></li>
<li class="chapter" data-level="9.2.11" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-a-report"><i class="fa fa-check"></i><b>9.2.11</b> Create a report</a></li>
<li class="chapter" data-level="9.2.12" data-path="sasmarkdown.html"><a href="sasmarkdown.html#random-variables"><i class="fa fa-check"></i><b>9.2.12</b> Random variables</a></li>
<li class="chapter" data-level="9.2.13" data-path="sasmarkdown.html"><a href="sasmarkdown.html#combine-two-texts-compress-spaces-locate-a-substring-change-case"><i class="fa fa-check"></i><b>9.2.13</b> Combine two texts, compress spaces, locate a substring, change case</a></li>
<li class="chapter" data-level="9.2.14" data-path="sasmarkdown.html"><a href="sasmarkdown.html#deduplication-1"><i class="fa fa-check"></i><b>9.2.14</b> Deduplication</a></li>
<li class="chapter" data-level="9.2.15" data-path="sasmarkdown.html"><a href="sasmarkdown.html#select-a-subset-of-rows"><i class="fa fa-check"></i><b>9.2.15</b> Select a subset of rows</a></li>
<li class="chapter" data-level="9.2.16" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-macros-with-do-loops"><i class="fa fa-check"></i><b>9.2.16</b> Create macros with DO loops</a></li>
<li class="chapter" data-level="9.2.17" data-path="sasmarkdown.html"><a href="sasmarkdown.html#output-intermediate-tables-with-ods"><i class="fa fa-check"></i><b>9.2.17</b> Output intermediate tables with ODS</a></li>
<li class="chapter" data-level="9.2.18" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-sequence-numbers"><i class="fa fa-check"></i><b>9.2.18</b> Create sequence numbers</a></li>
<li class="chapter" data-level="9.2.19" data-path="sasmarkdown.html"><a href="sasmarkdown.html#merge-datasets"><i class="fa fa-check"></i><b>9.2.19</b> Merge datasets</a></li>
<li class="chapter" data-level="9.2.20" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-table-1-1"><i class="fa fa-check"></i><b>9.2.20</b> Create Table 1</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#using-macros"><i class="fa fa-check"></i><b>9.3</b> Using macros</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#proc-report-for-flexible-summaries"><i class="fa fa-check"></i><b>9.3.1</b> PROC REPORT for flexible summaries</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-sas-formats"><i class="fa fa-check"></i><b>9.4</b> Use SAS formats</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#storing-formats-to-a-library"><i class="fa fa-check"></i><b>9.4.1</b> Storing formats to a library</a></li>
<li class="chapter" data-level="9.4.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#modify-formats"><i class="fa fa-check"></i><b>9.4.2</b> Modify formats</a></li>
<li class="chapter" data-level="9.4.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#transform-missing-to-character-then-to-numeric-again"><i class="fa fa-check"></i><b>9.4.3</b> Transform missing to character then to numeric again</a></li>
<li class="chapter" data-level="9.4.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#output-format-definition-details"><i class="fa fa-check"></i><b>9.4.4</b> Output format definition details</a></li>
<li class="chapter" data-level="9.4.5" data-path="sasmarkdown.html"><a href="sasmarkdown.html#a-macro-to-copy-an-existing-proc-format"><i class="fa fa-check"></i><b>9.4.5</b> A macro to copy an existing PROC FORMAT</a></li>
<li class="chapter" data-level="9.4.6" data-path="sasmarkdown.html"><a href="sasmarkdown.html#a-macro-to-view-the-list-of-variables"><i class="fa fa-check"></i><b>9.4.6</b> A macro to view the list of variables</a></li>
<li class="chapter" data-level="9.4.7" data-path="sasmarkdown.html"><a href="sasmarkdown.html#practical-workflow-recommendations-for-sasmarkdown"><i class="fa fa-check"></i><b>9.4.7</b> Practical workflow recommendations for SASmarkdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>10</b> Causal inference</a>
<ul>
<li class="chapter" data-level="10.1" data-path="causal-inference.html"><a href="causal-inference.html#causal-inference-introduction"><i class="fa fa-check"></i><b>10.1</b> Causal inference introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="causal-inference.html"><a href="causal-inference.html#definitions-and-directed-acyclic-graph-dag"><i class="fa fa-check"></i><b>10.1.1</b> Definitions and directed acyclic graph (DAG)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="causal-inference.html"><a href="causal-inference.html#inverse-probability-weighting"><i class="fa fa-check"></i><b>10.2</b> Inverse probability weighting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="causal-inference.html"><a href="causal-inference.html#matching-and-weighting-wo-imputation"><i class="fa fa-check"></i><b>10.2.1</b> Matching and weighting w/o imputation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="causal-inference.html"><a href="causal-inference.html#g-formula"><i class="fa fa-check"></i><b>10.3</b> G formula</a></li>
<li class="chapter" data-level="10.4" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators"><i class="fa fa-check"></i><b>10.4</b> Double Robust Estimators</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="causal-inference.html"><a href="causal-inference.html#superlearner"><i class="fa fa-check"></i><b>10.4.1</b> SuperLearner</a></li>
<li class="chapter" data-level="10.4.2" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators-using-superlearner_sl3"><i class="fa fa-check"></i><b>10.4.2</b> Double robust estimators using SuperLearner_sl3</a></li>
<li class="chapter" data-level="10.4.3" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators-using-tmle"><i class="fa fa-check"></i><b>10.4.3</b> Double robust estimators using TMLE</a></li>
<li class="chapter" data-level="10.4.4" data-path="causal-inference.html"><a href="causal-inference.html#longitudinal-targeted-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>10.4.4</b> Longitudinal targeted maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variable-regression"><i class="fa fa-check"></i><b>10.5</b> Instrumental variable regression</a></li>
<li class="chapter" data-level="10.6" data-path="causal-inference.html"><a href="causal-inference.html#mediation-analysis"><i class="fa fa-check"></i><b>10.6</b> Mediation analysis</a></li>
<li class="chapter" data-level="10.7" data-path="causal-inference.html"><a href="causal-inference.html#confounding-and-effect-measure-modification"><i class="fa fa-check"></i><b>10.7</b> Confounding and effect measure modification</a></li>
<li class="chapter" data-level="10.8" data-path="causal-inference.html"><a href="causal-inference.html#causal-inference-and-associated-regression"><i class="fa fa-check"></i><b>10.8</b> Causal inference and associated regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="clinical-trial.html"><a href="clinical-trial.html"><i class="fa fa-check"></i><b>11</b> Clinical Trial</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clinical-trial.html"><a href="clinical-trial.html#statistics-in-clinical-trial"><i class="fa fa-check"></i><b>11.1</b> Statistics in clinical trial</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="clinical-trial.html"><a href="clinical-trial.html#sample-size-interim-data-reports-and-randomization-of-assignment"><i class="fa fa-check"></i><b>11.1.1</b> Sample size, interim data reports and randomization of assignment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="common-statistical-models.html"><a href="common-statistical-models.html"><i class="fa fa-check"></i><b>12</b> Common statistical models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="common-statistical-models.html"><a href="common-statistical-models.html#survival-analysis"><i class="fa fa-check"></i><b>12.1</b> Survival analysis</a></li>
<li class="chapter" data-level="12.2" data-path="common-statistical-models.html"><a href="common-statistical-models.html#logistical-regression"><i class="fa fa-check"></i><b>12.2</b> Logistical regression</a></li>
<li class="chapter" data-level="12.3" data-path="common-statistical-models.html"><a href="common-statistical-models.html#poisson-regression"><i class="fa fa-check"></i><b>12.3</b> Poisson regression</a></li>
<li class="chapter" data-level="12.4" data-path="common-statistical-models.html"><a href="common-statistical-models.html#quantile-regression"><i class="fa fa-check"></i><b>12.4</b> Quantile regression</a></li>
<li class="chapter" data-level="12.5" data-path="common-statistical-models.html"><a href="common-statistical-models.html#principle-components-analysis"><i class="fa fa-check"></i><b>12.5</b> Principle components analysis</a></li>
<li class="chapter" data-level="12.6" data-path="common-statistical-models.html"><a href="common-statistical-models.html#which-covariates-should-be-adjusted"><i class="fa fa-check"></i><b>12.6</b> Which covariates should be adjusted</a></li>
<li class="chapter" data-level="12.7" data-path="common-statistical-models.html"><a href="common-statistical-models.html#variable-selection-1"><i class="fa fa-check"></i><b>12.7</b> Variable selection</a></li>
<li class="chapter" data-level="12.8" data-path="common-statistical-models.html"><a href="common-statistical-models.html#fit-regression-model-with-a-fan-shaped-relation"><i class="fa fa-check"></i><b>12.8</b> Fit regression model with a fan-shaped relation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>13</b> Bayesian statistics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html#bayesian-inference-in-r"><i class="fa fa-check"></i><b>13.1</b> Bayesian Inference in R</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="epidemiolgy.html"><a href="epidemiolgy.html"><i class="fa fa-check"></i><b>14</b> Epidemiolgy</a>
<ul>
<li class="chapter" data-level="14.1" data-path="epidemiolgy.html"><a href="epidemiolgy.html#introduction"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="epidemiolgy.html"><a href="epidemiolgy.html#bias-analysis-and-control-in-r"><i class="fa fa-check"></i><b>14.2</b> Bias analysis and control IN R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bioinformation.html"><a href="bioinformation.html"><i class="fa fa-check"></i><b>15</b> Bioinformation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="bioinformation.html"><a href="bioinformation.html#sequence-analysis"><i class="fa fa-check"></i><b>15.1</b> Sequence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="common-issues-in-statistics.html"><a href="common-issues-in-statistics.html"><i class="fa fa-check"></i><b>16</b> Common issues in Statistics</a></li>
<li class="chapter" data-level="17" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>17</b> Miscellaneous</a>
<ul>
<li class="chapter" data-level="17.1" data-path="miscellaneous.html"><a href="miscellaneous.html#linear-algebra"><i class="fa fa-check"></i><b>17.1</b> Linear algebra</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="miscellaneous.html"><a href="miscellaneous.html#matrix-basics"><i class="fa fa-check"></i><b>17.1.1</b> Matrix basics</a></li>
<li class="chapter" data-level="17.1.2" data-path="miscellaneous.html"><a href="miscellaneous.html#operations"><i class="fa fa-check"></i><b>17.1.2</b> Operations</a></li>
<li class="chapter" data-level="17.1.3" data-path="miscellaneous.html"><a href="miscellaneous.html#eigen-decomposition"><i class="fa fa-check"></i><b>17.1.3</b> Eigen decomposition</a></li>
<li class="chapter" data-level="17.1.4" data-path="miscellaneous.html"><a href="miscellaneous.html#advanced-operations"><i class="fa fa-check"></i><b>17.1.4</b> Advanced operations</a></li>
<li class="chapter" data-level="17.1.5" data-path="miscellaneous.html"><a href="miscellaneous.html#solve-linear-equations"><i class="fa fa-check"></i><b>17.1.5</b> Solve linear equations</a></li>
<li class="chapter" data-level="17.1.6" data-path="miscellaneous.html"><a href="miscellaneous.html#summary"><i class="fa fa-check"></i><b>17.1.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="miscellaneous.html"><a href="miscellaneous.html#calculus"><i class="fa fa-check"></i><b>17.2</b> Calculus</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="miscellaneous.html"><a href="miscellaneous.html#derivation"><i class="fa fa-check"></i><b>17.2.1</b> Derivation</a></li>
<li class="chapter" data-level="17.2.2" data-path="miscellaneous.html"><a href="miscellaneous.html#integration"><i class="fa fa-check"></i><b>17.2.2</b> Integration</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="miscellaneous.html"><a href="miscellaneous.html#sample-size-calculation-simulation-based-power"><i class="fa fa-check"></i><b>17.3</b> Sample size calculation (simulation-based power)</a></li>
<li class="chapter" data-level="17.4" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-evaluate-a-z-score"><i class="fa fa-check"></i><b>17.4</b> How to evaluate a z score</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="miscellaneous.html"><a href="miscellaneous.html#call-the-parameter-estimates-file"><i class="fa fa-check"></i><b>17.4.1</b> Call the parameter estimates file</a></li>
<li class="chapter" data-level="17.4.2" data-path="miscellaneous.html"><a href="miscellaneous.html#calculate-mean-and-standard-deviation-at-a-specific-value"><i class="fa fa-check"></i><b>17.4.2</b> Calculate mean and standard deviation at a specific value</a></li>
<li class="chapter" data-level="17.4.3" data-path="miscellaneous.html"><a href="miscellaneous.html#output-the-calculated-mean-on-exp-scale"><i class="fa fa-check"></i><b>17.4.3</b> Output the calculated mean (on exp scale)</a></li>
<li class="chapter" data-level="17.4.4" data-path="miscellaneous.html"><a href="miscellaneous.html#calculate-z-score"><i class="fa fa-check"></i><b>17.4.4</b> Calculate z score</a></li>
<li class="chapter" data-level="17.4.5" data-path="miscellaneous.html"><a href="miscellaneous.html#result-checking"><i class="fa fa-check"></i><b>17.4.5</b> Result checking</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="miscellaneous.html"><a href="miscellaneous.html#mathematical-coupling"><i class="fa fa-check"></i><b>17.5</b> Mathematical coupling</a></li>
<li class="chapter" data-level="17.6" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-create-a-bookdown"><i class="fa fa-check"></i><b>17.6</b> How to create a bookdown</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-git-up-a-project-into-github"><i class="fa fa-check"></i><b>17.6.1</b> How to git up a project into GitHub</a></li>
<li class="chapter" data-level="17.6.2" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-git-down-a-project-into-your-pc"><i class="fa fa-check"></i><b>17.6.2</b> How to git down a project into your PC</a></li>
<li class="chapter" data-level="17.6.3" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-return-to-a-previous-version"><i class="fa fa-check"></i><b>17.6.3</b> How to return to a previous version</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-create-a-blogdown"><i class="fa fa-check"></i><b>17.7</b> How to create a blogdown</a></li>
<li class="chapter" data-level="17.8" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-install-tensorflow-and-keras"><i class="fa fa-check"></i><b>17.8</b> How to install tensorflow and keras</a></li>
<li class="chapter" data-level="17.9" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-use-github-in-a-team"><i class="fa fa-check"></i><b>17.9</b> How to use GitHub in a team</a></li>
<li class="chapter" data-level="17.10" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-insert-a-picture-indirectly-in-markdown"><i class="fa fa-check"></i><b>17.10</b> How to insert a picture indirectly in markdown</a></li>
<li class="chapter" data-level="17.11" data-path="miscellaneous.html"><a href="miscellaneous.html#r-cheatsheets"><i class="fa fa-check"></i><b>17.11</b> R cheatsheets</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biostatistics Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Data visualization<a href="data-visualization.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Data visualization is not only about making plots look “pretty.” In real projects, visualization has three practical jobs:</p>
<ol style="list-style-type: decimal">
<li><strong>Understand the data</strong>: distributions, outliers, missingness, and relationships.<br />
</li>
<li><strong>Communicate findings</strong>: help others quickly grasp patterns and results.<br />
</li>
<li><strong>Validate assumptions</strong>: especially before modeling (linearity, normality, separation, influential points, etc.).</li>
</ol>
<p>This chapter focuses on <strong>ggplot2</strong> (in the tidyverse ecosystem) and a few practical companion tools. The goal is to build a workflow that is repeatable: summarize → reshape → visualize → refine → annotate → communicate.</p>
<!-- ================ -->
<div id="data-visualization-introduction" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Data visualization introduction<a href="data-visualization.html#data-visualization-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before plotting, it is often useful to <strong>summarize</strong>, <strong>reshape</strong>, and <strong>clean</strong> your data. Many plotting tasks become straightforward once the dataset is in a tidy (“long”) format. The section below shows common operations that prepare your data for visualization.</p>
<div id="summarization" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Summarization<a href="data-visualization.html#summarization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A typical first step is to compute group-level summaries. In practice, these summaries help you:
- sanity-check units and ranges,
- compare groups quickly,
- decide which plots are appropriate (boxplots, line charts, etc.).</p>
<p>The following example converts miles-per-gallon (mpg) into a rough metric unit and summarizes by cylinder group.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="data-visualization.html#cb191-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb191-2"><a href="data-visualization.html#cb191-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb191-3"><a href="data-visualization.html#cb191-3" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="data-visualization.html#cb191-4" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">kml =</span> mpg <span class="sc">*</span> <span class="fl">0.42</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-5"><a href="data-visualization.html#cb191-5" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="data-visualization.html#cb191-6" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">avg_US =</span> <span class="fu">mean</span>(mpg), <span class="at">avg_metric =</span> <span class="fu">mean</span>(kml))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##     cyl avg_US avg_metric
##   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1     4   26.7      11.2 
## 2     6   19.7       8.29
## 3     8   15.1       6.34</code></pre>
<p>The next summary computes average city and highway mileage by manufacturer and year.<br />
In reporting, this kind of grouped summary often becomes the basis for trend plots and comparisons.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="data-visualization.html#cb193-1" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> </span>
<span id="cb193-2"><a href="data-visualization.html#cb193-2" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer, year) <span class="sc">%&gt;%</span> </span>
<span id="cb193-3"><a href="data-visualization.html#cb193-3" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(cty, hwy), mean)</span></code></pre></div>
<pre><code>## # A tibble: 30 × 4
## # Groups:   manufacturer [15]
##    manufacturer  year   cty   hwy
##    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 audi          1999  17.1  26.1
##  2 audi          2008  18.1  26.8
##  3 chevrolet     1999  15.1  21.6
##  4 chevrolet     2008  14.9  22.1
##  5 dodge         1999  13.4  18.4
##  6 dodge         2008  13.0  17.6
##  7 ford          1999  13.9  18.6
##  8 ford          2008  14.1  20.5
##  9 honda         1999  24.8  31.6
## 10 honda         2008  24    33.8
## # ℹ 20 more rows</code></pre>
<ul>
<li>change layout<br />
Sometimes you want a table for quick comparison rather than a plot.<br />
Here we count cars by class and year, then spread into a wide layout (years as rows, classes as columns).<br />
This is helpful for producing “Table 1 style” counts or for feeding into heatmaps.</li>
</ul>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="data-visualization.html#cb195-1" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> <span class="fu">count</span>(class, year)<span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="data-visualization.html#cb195-2" tabindex="-1"></a>  <span class="fu">spread</span>(class, n) </span></code></pre></div>
<pre><code>## # A tibble: 2 × 8
##    year `2seater` compact midsize minivan pickup subcompact   suv
##   &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;int&gt;
## 1  1999         2      25      20       6     16         19    29
## 2  2008         3      22      21       5     17         16    33</code></pre>
<ul>
<li>change all characters into factors<br />
Many plotting functions treat characters as discrete categories anyway, but converting to <code>factor</code> can make your intent explicit and allows you to control ordering and labeling more deliberately.<br />
This is especially useful for facets and legends.</li>
</ul>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="data-visualization.html#cb197-1" tabindex="-1"></a>mpg <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb197-2"><a href="data-visualization.html#cb197-2" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor) <span class="co">#if a column is a character, change to a factor</span></span></code></pre></div>
<ul>
<li>wide to long data<br />
A common visualization trick is to stack multiple measurement columns into a long format.<br />
Here we convert <code>cty</code> and <code>hwy</code> into a single numeric column with a key indicating which metric it came from.<br />
Long format is the natural input format for ggplot because it plays well with color, linetype, and facets.</li>
</ul>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="data-visualization.html#cb198-1" tabindex="-1"></a>mpg1 <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb198-2"><a href="data-visualization.html#cb198-2" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="st">&quot;key&quot;</span>, <span class="st">&quot;value&quot;</span>, cty, hwy)</span></code></pre></div>
<ul>
<li>convert wide data to long data using <code>pivot_longer</code>
<code>pivot_longer()</code> is the modern tidyverse replacement for <code>gather()</code>.<br />
This example:</li>
</ul>
<ol style="list-style-type: decimal">
<li>pivots <code>cty</code> and <code>hwy</code> into long form,<br />
</li>
<li>recodes the indicator variable into friendly labels,<br />
</li>
<li>overlays points and smooth curves for each measurement type.</li>
</ol>
<p>This is a classic real-world pattern: put the data in long format, then map the “type” to color.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="data-visualization.html#cb199-1" tabindex="-1"></a><span class="do">## Your code here. Naming choices for 1 and 2 are yours</span></span>
<span id="cb199-2"><a href="data-visualization.html#cb199-2" tabindex="-1"></a>dta <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb199-3"><a href="data-visualization.html#cb199-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(cty<span class="sc">:</span>hwy, <span class="at">names_to =</span> <span class="st">&quot;var&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co"># Both of those are </span></span>
<span id="cb199-4"><a href="data-visualization.html#cb199-4" tabindex="-1"></a>  <span class="co"># value label</span></span>
<span id="cb199-5"><a href="data-visualization.html#cb199-5" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">var =</span> <span class="fu">ifelse</span>( var <span class="sc">==</span> <span class="st">&#39;cty&#39;</span>, <span class="st">&#39;city&#39;</span>,<span class="st">&#39;highway&#39;</span>))</span>
<span id="cb199-6"><a href="data-visualization.html#cb199-6" tabindex="-1"></a></span>
<span id="cb199-7"><a href="data-visualization.html#cb199-7" tabindex="-1"></a><span class="fu">ggplot</span>(dta, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb199-8"><a href="data-visualization.html#cb199-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> var))  <span class="sc">+</span></span>
<span id="cb199-9"><a href="data-visualization.html#cb199-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> var), <span class="at">se =</span> F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" alt="" width="672" /></p>
<ul>
<li>explore distribution<br />
Exploratory distribution plots help you quickly identify:</li>
<li>skewed variables,</li>
<li>implausible values,</li>
<li>heavy tails,</li>
<li>and whether transformations (log, sqrt) might be helpful.</li>
</ul>
<p>Packages like <code>DataExplorer</code> and <code>psych</code> provide rapid EDA utilities.<br />
(Here, <code>riskfactors</code> is assumed to exist in your environment.)</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="data-visualization.html#cb201-1" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb201-2"><a href="data-visualization.html#cb201-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="data-visualization.html#cb204-1" tabindex="-1"></a><span class="fu">library</span>(naniar)</span></code></pre></div>
<pre><code>## Warning: package &#39;naniar&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="data-visualization.html#cb206-1" tabindex="-1"></a><span class="fu">plot_histogram</span>(riskfactors)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-100-1.png" alt="" width="672" /></p>
<ul>
<li>explore relationship/correlation<br />
Pairwise plots are very useful early in analysis because they reveal:</li>
<li>correlations,</li>
<li>nonlinear patterns,</li>
<li>clustering,</li>
<li>and outliers that may dominate a model.</li>
</ul>
<p>These are especially valuable before regression or machine learning.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="data-visualization.html#cb207-1" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb207-2"><a href="data-visualization.html#cb207-2" tabindex="-1"></a><span class="fu">pairs.panels</span>(riskfactors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code></pre></div>
<pre><code>## Warning in cor(x, y, use = &quot;pairwise&quot;, method = method): the standard deviation
## is zero
## Warning in cor(x, y, use = &quot;pairwise&quot;, method = method): the standard deviation
## is zero</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.png" alt="" width="672" /></p>
<ul>
<li>create a individual theme<br />
In a book or internal training material, consistent formatting matters.<br />
Creating your own theme function lets you apply the same style across all figures:</li>
<li>consistent font sizes,</li>
<li>consistent background,</li>
<li>consistent axis formatting.</li>
</ul>
<p>This is a practical “quality of life” improvement when you generate many plots.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="data-visualization.html#cb209-1" tabindex="-1"></a>my_theme <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb209-2"><a href="data-visualization.html#cb209-2" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb209-3"><a href="data-visualization.html#cb209-3" tabindex="-1"></a> </span>
<span id="cb209-4"><a href="data-visualization.html#cb209-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb209-5"><a href="data-visualization.html#cb209-5" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb209-6"><a href="data-visualization.html#cb209-6" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb209-7"><a href="data-visualization.html#cb209-7" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="explore-missing-values" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Explore missing values<a href="data-visualization.html#explore-missing-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Missingness is not just a data cleaning issue—it can be informative.<br />
Before you impute or drop data, you should understand:
- which variables have missingness,
- whether missingness co-occurs across variables,
- and whether missingness is related to groups (e.g., sites, time periods).</p>
<p>The following blocks use <code>naniar</code> and related tools to visualize missing patterns.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="data-visualization.html#cb210-1" tabindex="-1"></a><span class="co"># install.packages(&quot;naniar&quot;)</span></span>
<span id="cb210-2"><a href="data-visualization.html#cb210-2" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb210-3"><a href="data-visualization.html#cb210-3" tabindex="-1"></a><span class="co"># head(riskfactors)</span></span>
<span id="cb210-4"><a href="data-visualization.html#cb210-4" tabindex="-1"></a>riskfactors <span class="ot">&lt;-</span> riskfactors</span></code></pre></div>
<p><code>gg_miss_upset()</code> is useful for seeing combinations of missing variables (like an Upset plot). This helps identify patterns such as “these three labs are often missing together.”</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="data-visualization.html#cb211-1" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(riskfactors,<span class="at">nsets=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
## ℹ Please use tidy evaluation idioms with `aes()`.
## ℹ See also `vignette(&quot;ggplot2-in-packages&quot;)` for more information.
## ℹ The deprecated feature was likely used in the UpSetR package.
##   Please report the issue to the authors.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## ℹ The deprecated feature was likely used in the UpSetR package.
##   Please report the issue to the authors.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<pre><code>## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2
## 3.4.0.
## ℹ Please use the `linewidth` argument instead.
## ℹ The deprecated feature was likely used in the UpSetR package.
##   Please report the issue to the authors.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" alt="" width="672" /></p>
<p><code>plot_missing()</code> gives a quick overall missingness view, often used at the start of EDA.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="data-visualization.html#cb215-1" tabindex="-1"></a><span class="co"># install.packages(&quot;DataExplorer&quot;)</span></span>
<span id="cb215-2"><a href="data-visualization.html#cb215-2" tabindex="-1"></a></span>
<span id="cb215-3"><a href="data-visualization.html#cb215-3" tabindex="-1"></a><span class="fu">plot_missing</span>(riskfactors)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" alt="" width="672" /></p>
<p><code>visdat::vis_dat()</code> is a fast way to inspect column types and missingness at once.<br />
It’s particularly helpful to detect:
- columns accidentally read as character,
- columns with mixed types,
- or unexpected missing patterns.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="data-visualization.html#cb216-1" tabindex="-1"></a><span class="co"># take a quick look at the data types of each column</span></span>
<span id="cb216-2"><a href="data-visualization.html#cb216-2" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(riskfactors)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" alt="" width="672" /></p>
</div>
<div id="add-statistical-test" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Add statistical test<a href="data-visualization.html#add-statistical-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plots often become more persuasive when paired with a simple statistical comparison—<strong>but</strong> you should add tests carefully:
- avoid fishing/over-testing,
- ensure assumptions are reasonable,
- and interpret p-values in context.</p>
<p>Here we build a faceted boxplot and add a comparison between years (1999 vs 2008) for each manufacturer.<br />
This is a practical template for “small multiple” visual comparisons with annotated tests.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="data-visualization.html#cb217-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb217-2"><a href="data-visualization.html#cb217-2" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(  <span class="at">data=</span>mpg,</span>
<span id="cb217-3"><a href="data-visualization.html#cb217-3" tabindex="-1"></a>  <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x =</span>  <span class="fu">as.factor</span>(year),</span>
<span id="cb217-4"><a href="data-visualization.html#cb217-4" tabindex="-1"></a>               <span class="at">y =</span> cty,</span>
<span id="cb217-5"><a href="data-visualization.html#cb217-5" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">as.factor</span>(year) ) )<span class="sc">+</span></span>
<span id="cb217-6"><a href="data-visualization.html#cb217-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb217-7"><a href="data-visualization.html#cb217-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb217-8"><a href="data-visualization.html#cb217-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Year&#39;</span>,</span>
<span id="cb217-9"><a href="data-visualization.html#cb217-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;City mpg&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-10"><a href="data-visualization.html#cb217-10" tabindex="-1"></a>  <span class="fu">my_theme</span>()<span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> manufacturer,<span class="at">nrow =</span> <span class="dv">2</span>)  </span>
<span id="cb217-11"><a href="data-visualization.html#cb217-11" tabindex="-1"></a>  </span>
<span id="cb217-12"><a href="data-visualization.html#cb217-12" tabindex="-1"></a><span class="co"># add statistical test</span></span>
<span id="cb217-13"><a href="data-visualization.html#cb217-13" tabindex="-1"></a>  my_comparisons <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&#39;1999&#39;</span>,<span class="st">&#39;2008&#39;</span>))</span>
<span id="cb217-14"><a href="data-visualization.html#cb217-14" tabindex="-1"></a>plt <span class="sc">+</span> <span class="fu">stat_compare_means</span>() <span class="sc">+</span></span>
<span id="cb217-15"><a href="data-visualization.html#cb217-15" tabindex="-1"></a><span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> my_comparisons)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" alt="" width="672" /></p>
</div>
<div id="add-texts-to-dots" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Add texts to dots<a href="data-visualization.html#add-texts-to-dots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When plotting many points, labels can clutter quickly.<br />
But for small datasets (or when identifying key outliers), labels add interpretability.<br />
This example labels each state for a scatter plot of urban population vs murder arrests.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="data-visualization.html#cb218-1" tabindex="-1"></a>USArrests <span class="ot">&lt;-</span> USArrests <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&#39;State&#39;</span>)</span>
<span id="cb218-2"><a href="data-visualization.html#cb218-2" tabindex="-1"></a></span>
<span id="cb218-3"><a href="data-visualization.html#cb218-3" tabindex="-1"></a><span class="fu">ggplot</span>(USArrests, <span class="fu">aes</span>(</span>
<span id="cb218-4"><a href="data-visualization.html#cb218-4" tabindex="-1"></a><span class="at">x=</span>UrbanPop,<span class="at">y=</span>Murder))<span class="sc">+</span></span>
<span id="cb218-5"><a href="data-visualization.html#cb218-5" tabindex="-1"></a><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-6"><a href="data-visualization.html#cb218-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Percent of population that is urban&quot;</span>, </span>
<span id="cb218-7"><a href="data-visualization.html#cb218-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Murder arrests (per 100,000)&quot;</span>,</span>
<span id="cb218-8"><a href="data-visualization.html#cb218-8" tabindex="-1"></a>       <span class="at">caption =</span>  <span class="st">&quot;McNeil (1997). Interactive Data Analysis&quot;</span>)<span class="sc">+</span></span>
<span id="cb218-9"><a href="data-visualization.html#cb218-9" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>State),<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" alt="" width="672" /></p>
</div>
<div id="set-the-legend" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Set the legend<a href="data-visualization.html#set-the-legend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Legends are often the difference between a confusing figure and a publishable one.<br />
Here we demonstrate manual control of:
- fill colors,
- linetypes,
- legend title and labels.</p>
<p>In practice, manual scales are useful when you want consistent colors across plots in a report or book.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="data-visualization.html#cb219-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>  Sepal.Length , <span class="at">fill=</span> <span class="fu">as.factor</span>( Species)) ) <span class="sc">+</span>  <span class="co">#whole plot&#39;s option</span></span>
<span id="cb219-2"><a href="data-visualization.html#cb219-2" tabindex="-1"></a>  </span>
<span id="cb219-3"><a href="data-visualization.html#cb219-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">position=</span><span class="st">&quot;identity&quot;</span> , <span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb219-4"><a href="data-visualization.html#cb219-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">linetype=</span><span class="fu">as.factor</span>(Species)),<span class="at">alpha=</span>.<span class="dv">1</span> )<span class="sc">+</span>    <span class="co">#aesthetic&#39;s option</span></span>
<span id="cb219-5"><a href="data-visualization.html#cb219-5" tabindex="-1"></a>  </span>
<span id="cb219-6"><a href="data-visualization.html#cb219-6" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>( <span class="at">name =</span> <span class="st">&quot;Groups&quot;</span>,<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;skyblue&quot;</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span> , <span class="st">&quot;virginica&quot;</span> ))<span class="sc">+</span>  </span>
<span id="cb219-7"><a href="data-visualization.html#cb219-7" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>( <span class="at">name =</span> <span class="st">&quot;Groups&quot;</span> ,<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;versicolor&quot;</span> , <span class="st">&quot;virginica&quot;</span>) )<span class="sc">+</span>       <span class="co"># common legend </span></span>
<span id="cb219-8"><a href="data-visualization.html#cb219-8" tabindex="-1"></a>  </span>
<span id="cb219-9"><a href="data-visualization.html#cb219-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Sepal.Length&quot;</span>, </span>
<span id="cb219-10"><a href="data-visualization.html#cb219-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>, </span>
<span id="cb219-11"><a href="data-visualization.html#cb219-11" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2
## 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" alt="" width="672" /></p>
</div>
<div id="create-a-panel-of-plots" class="section level3 hasAnchor" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Create a panel of plots<a href="data-visualization.html#create-a-panel-of-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A panel (multi-plot layout) is a very effective way to summarize multiple variables at once.<br />
In exploratory analysis, it helps you quickly see:
- distributions (histogram, bar),
- group differences (boxplot),
- and composition (stacked percent bars).</p>
<p>Here we build four plots and arrange them into a 2×2 panel.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="data-visualization.html#cb221-1" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">ggplot</span>(<span class="at">data=</span>riskfactors,<span class="fu">aes</span>(<span class="at">x=</span>age))<span class="sc">+</span></span>
<span id="cb221-2"><a href="data-visualization.html#cb221-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span> )</span>
<span id="cb221-3"><a href="data-visualization.html#cb221-3" tabindex="-1"></a></span>
<span id="cb221-4"><a href="data-visualization.html#cb221-4" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(<span class="at">data=</span>riskfactors,<span class="fu">aes</span>(<span class="at">x=</span>sex))<span class="sc">+</span></span>
<span id="cb221-5"><a href="data-visualization.html#cb221-5" tabindex="-1"></a>  <span class="fu">geom_bar</span> (<span class="fu">aes</span>(<span class="at">x=</span>sex) )</span>
<span id="cb221-6"><a href="data-visualization.html#cb221-6" tabindex="-1"></a></span>
<span id="cb221-7"><a href="data-visualization.html#cb221-7" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(riskfactors,<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> bmi))<span class="sc">+</span></span>
<span id="cb221-8"><a href="data-visualization.html#cb221-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span> (  )</span>
<span id="cb221-9"><a href="data-visualization.html#cb221-9" tabindex="-1"></a></span>
<span id="cb221-10"><a href="data-visualization.html#cb221-10" tabindex="-1"></a>p4<span class="ot">=</span><span class="fu">ggplot</span>(riskfactors, <span class="fu">aes</span>(<span class="at">x =</span> marital )) <span class="sc">+</span> </span>
<span id="cb221-11"><a href="data-visualization.html#cb221-11" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">group =</span> education, <span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..),<span class="at">fill =</span> education)) <span class="sc">+</span> </span>
<span id="cb221-12"><a href="data-visualization.html#cb221-12" tabindex="-1"></a>          <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>percent) </span>
<span id="cb221-13"><a href="data-visualization.html#cb221-13" tabindex="-1"></a></span>
<span id="cb221-14"><a href="data-visualization.html#cb221-14" tabindex="-1"></a><span class="co"># install.packages(&quot;ggpubr&quot;)</span></span>
<span id="cb221-15"><a href="data-visualization.html#cb221-15" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb221-16"><a href="data-visualization.html#cb221-16" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 11 rows containing non-finite outside the scale range
## (`stat_boxplot()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" alt="" width="672" /></p>
</div>
<div id="plots-in-regression" class="section level3 hasAnchor" number="4.1.7">
<h3><span class="header-section-number">4.1.7</span> Plots in regression<a href="data-visualization.html#plots-in-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Visualization is a powerful companion to regression:
- diagnostic plots check assumptions,
- coefficient/OR plots communicate model results,
- and fitted relationships can be compared across groups.</p>
<ul>
<li>create linear regression model<br />
We fit a linear regression on Boston housing as a demonstration.<br />
In practice, you would check residuals, leverage, and outliers; this section mainly sets up the model for coefficient visualization.</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="data-visualization.html#cb223-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Boston&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb223-2"><a href="data-visualization.html#cb223-2" tabindex="-1"></a>linear_reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(medv <span class="sc">~</span> ., <span class="at">data=</span>Boston , <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb223-3"><a href="data-visualization.html#cb223-3" tabindex="-1"></a><span class="fu">summary</span>(linear_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = medv ~ ., family = gaussian(), data = Boston)
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***
## crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** 
## zn           4.642e-02  1.373e-02   3.382 0.000778 ***
## indus        2.056e-02  6.150e-02   0.334 0.738288    
## chas         2.687e+00  8.616e-01   3.118 0.001925 ** 
## nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***
## rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***
## age          6.922e-04  1.321e-02   0.052 0.958229    
## dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***
## rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***
## tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** 
## ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***
## black        9.312e-03  2.686e-03   3.467 0.000573 ***
## lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 22.51785)
## 
##     Null deviance: 42716  on 505  degrees of freedom
## Residual deviance: 11079  on 492  degrees of freedom
## AIC: 3027.6
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<ul>
<li>summary<br />
<code>broom::tidy()</code> produces a clean summary table that is easy to include in reports.<br />
Using <code>knitr::kable()</code> formats it neatly in HTML/PDF output.</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="data-visualization.html#cb225-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(broom<span class="sc">::</span><span class="fu">tidy</span>(linear_reg))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">36.4594884</td>
<td align="right">5.1034588</td>
<td align="right">7.1440742</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">crim</td>
<td align="right">-0.1080114</td>
<td align="right">0.0328650</td>
<td align="right">-3.2865169</td>
<td align="right">0.0010868</td>
</tr>
<tr class="odd">
<td align="left">zn</td>
<td align="right">0.0464205</td>
<td align="right">0.0137275</td>
<td align="right">3.3815763</td>
<td align="right">0.0007781</td>
</tr>
<tr class="even">
<td align="left">indus</td>
<td align="right">0.0205586</td>
<td align="right">0.0614957</td>
<td align="right">0.3343100</td>
<td align="right">0.7382881</td>
</tr>
<tr class="odd">
<td align="left">chas</td>
<td align="right">2.6867338</td>
<td align="right">0.8615798</td>
<td align="right">3.1183809</td>
<td align="right">0.0019250</td>
</tr>
<tr class="even">
<td align="left">nox</td>
<td align="right">-17.7666112</td>
<td align="right">3.8197437</td>
<td align="right">-4.6512574</td>
<td align="right">0.0000042</td>
</tr>
<tr class="odd">
<td align="left">rm</td>
<td align="right">3.8098652</td>
<td align="right">0.4179253</td>
<td align="right">9.1161402</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.0006922</td>
<td align="right">0.0132098</td>
<td align="right">0.0524024</td>
<td align="right">0.9582293</td>
</tr>
<tr class="odd">
<td align="left">dis</td>
<td align="right">-1.4755668</td>
<td align="right">0.1994547</td>
<td align="right">-7.3980036</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">rad</td>
<td align="right">0.3060495</td>
<td align="right">0.0663464</td>
<td align="right">4.6128998</td>
<td align="right">0.0000051</td>
</tr>
<tr class="odd">
<td align="left">tax</td>
<td align="right">-0.0123346</td>
<td align="right">0.0037605</td>
<td align="right">-3.2800091</td>
<td align="right">0.0011116</td>
</tr>
<tr class="even">
<td align="left">ptratio</td>
<td align="right">-0.9527472</td>
<td align="right">0.1308268</td>
<td align="right">-7.2825106</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">black</td>
<td align="right">0.0093117</td>
<td align="right">0.0026860</td>
<td align="right">3.4667926</td>
<td align="right">0.0005729</td>
</tr>
<tr class="even">
<td align="left">lstat</td>
<td align="right">-0.5247584</td>
<td align="right">0.0507153</td>
<td align="right">-10.3471458</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>create logistical regression<br />
We fit logistic regression on the diabetes dataset. This is a classic example where coefficient plots and OR plots become very helpful for communication.</li>
</ul>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="data-visualization.html#cb226-1" tabindex="-1"></a><span class="co"># load the Pima Indians dataset from the mlbench dataset</span></span>
<span id="cb226-2"><a href="data-visualization.html#cb226-2" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlbench&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="data-visualization.html#cb228-1" tabindex="-1"></a><span class="fu">data</span>(PimaIndiansDiabetes) </span>
<span id="cb228-2"><a href="data-visualization.html#cb228-2" tabindex="-1"></a><span class="co"># rename dataset to have shorter name because lazy</span></span>
<span id="cb228-3"><a href="data-visualization.html#cb228-3" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> PimaIndiansDiabetes</span>
<span id="cb228-4"><a href="data-visualization.html#cb228-4" tabindex="-1"></a></span>
<span id="cb228-5"><a href="data-visualization.html#cb228-5" tabindex="-1"></a>logistic_reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> ., <span class="at">data=</span>diabetes, <span class="at">family =</span> binomial)</span>
<span id="cb228-6"><a href="data-visualization.html#cb228-6" tabindex="-1"></a></span>
<span id="cb228-7"><a href="data-visualization.html#cb228-7" tabindex="-1"></a><span class="fu">summary</span>(logistic_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = diabetes ~ ., family = binomial, data = diabetes)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -8.4046964  0.7166359 -11.728  &lt; 2e-16 ***
## pregnant     0.1231823  0.0320776   3.840 0.000123 ***
## glucose      0.0351637  0.0037087   9.481  &lt; 2e-16 ***
## pressure    -0.0132955  0.0052336  -2.540 0.011072 *  
## triceps      0.0006190  0.0068994   0.090 0.928515    
## insulin     -0.0011917  0.0009012  -1.322 0.186065    
## mass         0.0897010  0.0150876   5.945 2.76e-09 ***
## pedigree     0.9451797  0.2991475   3.160 0.001580 ** 
## age          0.0148690  0.0093348   1.593 0.111192    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 993.48  on 767  degrees of freedom
## Residual deviance: 723.45  on 759  degrees of freedom
## AIC: 741.45
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<ul>
<li>summary<br />
Again, <code>broom::tidy()</code> provides a clear coefficient table.</li>
</ul>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="data-visualization.html#cb230-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(broom<span class="sc">::</span><span class="fu">tidy</span>(logistic_reg))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-8.4046964</td>
<td align="right">0.7166359</td>
<td align="right">-11.7279870</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">pregnant</td>
<td align="right">0.1231823</td>
<td align="right">0.0320776</td>
<td align="right">3.8401403</td>
<td align="right">0.0001230</td>
</tr>
<tr class="odd">
<td align="left">glucose</td>
<td align="right">0.0351637</td>
<td align="right">0.0037087</td>
<td align="right">9.4813935</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">pressure</td>
<td align="right">-0.0132955</td>
<td align="right">0.0052336</td>
<td align="right">-2.5404160</td>
<td align="right">0.0110721</td>
</tr>
<tr class="odd">
<td align="left">triceps</td>
<td align="right">0.0006190</td>
<td align="right">0.0068994</td>
<td align="right">0.0897131</td>
<td align="right">0.9285152</td>
</tr>
<tr class="even">
<td align="left">insulin</td>
<td align="right">-0.0011917</td>
<td align="right">0.0009012</td>
<td align="right">-1.3223094</td>
<td align="right">0.1860652</td>
</tr>
<tr class="odd">
<td align="left">mass</td>
<td align="right">0.0897010</td>
<td align="right">0.0150876</td>
<td align="right">5.9453340</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">pedigree</td>
<td align="right">0.9451797</td>
<td align="right">0.2991475</td>
<td align="right">3.1595780</td>
<td align="right">0.0015800</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.0148690</td>
<td align="right">0.0093348</td>
<td align="right">1.5928584</td>
<td align="right">0.1111920</td>
</tr>
</tbody>
</table>
<div id="create-forest-plots-for-coefficients-or-or" class="section level4 hasAnchor" number="4.1.7.1">
<h4><span class="header-section-number">4.1.7.1</span> Create forest plots for <code>coefficients</code> or <code>OR</code><a href="data-visualization.html#create-forest-plots-for-coefficients-or-or" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Forest plots are one of the most practical ways to present regression results:
- For linear regression, coefficients are on the original outcome scale.
- For logistic regression, coefficients are usually transformed to odds ratios (OR).</p>
<p><code>sjPlot::plot_model()</code> offers fast, clean coefficient plots.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="data-visualization.html#cb231-1" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code></pre></div>
<pre><code>## Warning: package &#39;sjPlot&#39; was built under R version 4.4.3</code></pre>
<pre><code>## 
## Attaching package: &#39;sjPlot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     set_theme</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="data-visualization.html#cb235-1" tabindex="-1"></a><span class="fu">plot_model</span>(linear_reg, <span class="at">show.values =</span> <span class="cn">TRUE</span>, <span class="at">value.offset =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-115-1.png" alt="" width="672" /></p>
<p>Here we plot logistic regression results similarly.<br />
In practice, you may want to ensure the plot displays OR (exp(beta)) depending on the function defaults and your audience.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="data-visualization.html#cb236-1" tabindex="-1"></a><span class="fu">plot_model</span>(logistic_reg, <span class="at">show.values =</span> <span class="cn">TRUE</span>, <span class="at">value.offset =</span> .<span class="dv">5</span>, <span class="at">vline.color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-116-1.png" alt="" width="672" /></p>
<p><strong>another way</strong><br />
<code>finalfit</code> provides publication-friendly coefficient/OR plots with tables.<br />
This is especially useful for clinical or epidemiology style reporting.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="data-visualization.html#cb237-1" tabindex="-1"></a><span class="fu">library</span>(finalfit) </span></code></pre></div>
<pre><code>## Warning: package &#39;finalfit&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="data-visualization.html#cb239-1" tabindex="-1"></a>explanatory <span class="ot">=</span> <span class="fu">c</span>(  <span class="st">&quot;crim&quot;</span>  ,  <span class="st">&quot;zn&quot;</span>   ,   <span class="st">&quot;indus&quot;</span>  ,   <span class="st">&quot;nox&quot;</span>   ,  <span class="st">&quot;rm&quot;</span>   ,   <span class="st">&quot;age&quot;</span> ,    <span class="st">&quot;dis&quot;</span>  ,   <span class="st">&quot;rad&quot;</span>   ,  <span class="st">&quot;tax&quot;</span>   ,<span class="st">&quot;ptratio&quot;</span> ,<span class="st">&quot;black&quot;</span>  , <span class="st">&quot;lstat&quot;</span> )</span>
<span id="cb239-2"><a href="data-visualization.html#cb239-2" tabindex="-1"></a></span>
<span id="cb239-3"><a href="data-visualization.html#cb239-3" tabindex="-1"></a>dependent <span class="ot">=</span> <span class="st">&quot;medv&quot;</span></span>
<span id="cb239-4"><a href="data-visualization.html#cb239-4" tabindex="-1"></a></span>
<span id="cb239-5"><a href="data-visualization.html#cb239-5" tabindex="-1"></a></span>
<span id="cb239-6"><a href="data-visualization.html#cb239-6" tabindex="-1"></a>Boston <span class="sc">%&gt;%</span></span>
<span id="cb239-7"><a href="data-visualization.html#cb239-7" tabindex="-1"></a> <span class="fu">coefficient_plot</span>(dependent, explanatory, <span class="at">table_text_size=</span><span class="dv">3</span>, </span>
<span id="cb239-8"><a href="data-visualization.html#cb239-8" tabindex="-1"></a>                  <span class="at">title_text_size=</span><span class="dv">12</span>,</span>
<span id="cb239-9"><a href="data-visualization.html#cb239-9" tabindex="-1"></a>                   <span class="at">plot_opts=</span><span class="fu">list</span>(<span class="fu">xlab</span>(<span class="st">&quot;Beta, 95% CI&quot;</span>), </span>
<span id="cb239-10"><a href="data-visualization.html#cb239-10" tabindex="-1"></a>                                  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))))</span></code></pre></div>
<pre><code>## `height` was translated to `width`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-117-1.png" alt="" width="672" /></p>
<p>And the OR plot for logistic regression.<br />
This is a practical template to create a clean “OR (95% CI)” figure plus table in one call.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="data-visualization.html#cb241-1" tabindex="-1"></a><span class="fu">library</span>(finalfit) </span>
<span id="cb241-2"><a href="data-visualization.html#cb241-2" tabindex="-1"></a></span>
<span id="cb241-3"><a href="data-visualization.html#cb241-3" tabindex="-1"></a>explanatory <span class="ot">=</span> <span class="fu">c</span>(  <span class="st">&quot;pregnant&quot;</span>, <span class="st">&quot;glucose&quot;</span> , <span class="st">&quot;pressure&quot;</span>, <span class="st">&quot;triceps&quot;</span>  ,<span class="st">&quot;insulin&quot;</span> , <span class="st">&quot;mass&quot;</span>   ,  <span class="st">&quot;pedigree&quot;</span>, <span class="st">&quot;age&quot;</span>  )</span>
<span id="cb241-4"><a href="data-visualization.html#cb241-4" tabindex="-1"></a></span>
<span id="cb241-5"><a href="data-visualization.html#cb241-5" tabindex="-1"></a>dependent <span class="ot">=</span> <span class="st">&quot;diabetes&quot;</span></span>
<span id="cb241-6"><a href="data-visualization.html#cb241-6" tabindex="-1"></a></span>
<span id="cb241-7"><a href="data-visualization.html#cb241-7" tabindex="-1"></a>diabetes <span class="sc">%&gt;%</span></span>
<span id="cb241-8"><a href="data-visualization.html#cb241-8" tabindex="-1"></a> <span class="fu">or_plot</span>(dependent, explanatory, <span class="at">table_text_size=</span><span class="dv">3</span>, </span>
<span id="cb241-9"><a href="data-visualization.html#cb241-9" tabindex="-1"></a>                  <span class="at">title_text_size=</span><span class="dv">12</span>,</span>
<span id="cb241-10"><a href="data-visualization.html#cb241-10" tabindex="-1"></a>                   <span class="at">plot_opts=</span><span class="fu">list</span>(<span class="fu">xlab</span>(<span class="st">&quot;OR, 95% CI&quot;</span>), </span>
<span id="cb241-11"><a href="data-visualization.html#cb241-11" tabindex="-1"></a>                                  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...
## Waiting for profiling to be done...
## Waiting for profiling to be done...</code></pre>
<pre><code>## `height` was translated to `width`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-118-1.png" alt="" width="672" /></p>
<ul>
<li>qq plot<br />
A QQ plot is a quick check of distributional assumptions.<br />
Here we show a QQ plot for the Boston target variable.<br />
In practice, you might also check residuals from the fitted model, not only the raw outcome.</li>
</ul>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="data-visualization.html#cb244-1" tabindex="-1"></a><span class="fu">ggqqplot</span>( (Boston<span class="sc">$</span>medv))</span></code></pre></div>
<pre><code>## Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2
## 3.4.0.
## ℹ Please use the `linewidth` argument instead.
## ℹ The deprecated feature was likely used in the ggpubr package.
##   Please report the issue at
##   &lt;https://github.com/kassambara/ggpubr/issues&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-119-1.png" alt="" width="672" /></p>
<!-- ======================== -->
<ul>
<li>Loading data set<br />
We now shift into ggplot2 fundamentals using the classic <code>iris</code> dataset.<br />
This section builds intuition: start from an empty canvas, add layers, add mappings, then customize.</li>
</ul>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="data-visualization.html#cb246-1" tabindex="-1"></a><span class="fu">library</span>(printr)</span></code></pre></div>
<pre><code>## Warning: package &#39;printr&#39; was built under R version 4.4.3</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;printr&#39;:
##   method                from     
##   knit_print.data.frame rmarkdown</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-visualization.html#cb249-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb249-2"><a href="data-visualization.html#cb249-2" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="scatter-plot" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Scatter plot<a href="data-visualization.html#scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Scatter plots are ideal for exploring relationships between two continuous variables.<br />
In practice, they are often your first step before fitting correlation/regression models.</p>
<div id="create-a-empty-canvas" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Create a empty canvas<a href="data-visualization.html#create-a-empty-canvas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>then create <code>aesthetic mapping</code><br />
</li>
<li>tell the function which dataset and variables to use<br />
This creates a ggplot “object” (canvas) but does not draw anything until a geom layer is added.</li>
</ul>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-visualization.html#cb250-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris,        <span class="co"># which data set? canvas? </span></span>
<span id="cb250-2"><a href="data-visualization.html#cb250-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length   ))  <span class="co"># which variables as aesthetics? x and y are mapped to columns of the data; different geoms can have different aesthetics (different variables). </span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-121-1.png" alt="" width="672" /></p>
</div>
<div id="add-a-layergeom-of-points-to-the-canvas" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Add a layer/geom of <code>points</code> to the canvas<a href="data-visualization.html#add-a-layergeom-of-points-to-the-canvas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A plot becomes visible once we add <code>geom_point()</code>.<br />
This is the standard pattern in ggplot: define the canvas + add one or more layers.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-visualization.html#cb251-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb251-2"><a href="data-visualization.html#cb251-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length  )) <span class="sc">+</span> </span>
<span id="cb251-3"><a href="data-visualization.html#cb251-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()   <span class="co"># adding the geometrical representation </span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" alt="" width="672" /></p>
<p>This alternative style places the mapping in the geom.<br />
It is useful when different layers use different mappings.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-visualization.html#cb252-1" tabindex="-1"></a><span class="co"># same plot as above</span></span>
<span id="cb252-2"><a href="data-visualization.html#cb252-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb252-3"><a href="data-visualization.html#cb252-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(  <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length  )) </span></code></pre></div>
</div>
<div id="add-another-aesthetic" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Add another aesthetic<a href="data-visualization.html#add-another-aesthetic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>add a curve/straight line to fit these points<br />
</li>
<li>geom provides the aesthetic to ggplot</li>
</ul>
<p>A smooth curve helps reveal the trend.<br />
By default, <code>geom_smooth()</code> uses a loess smoother for small/medium datasets.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="data-visualization.html#cb253-1" tabindex="-1"></a><span class="co"># Loess curve</span></span>
<span id="cb253-2"><a href="data-visualization.html#cb253-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, </span>
<span id="cb253-3"><a href="data-visualization.html#cb253-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length  )) <span class="sc">+</span> </span>
<span id="cb253-4"><a href="data-visualization.html#cb253-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb253-5"><a href="data-visualization.html#cb253-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() </span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-124-1.png" alt="" width="672" /></p>
<p>If you want an interpretable linear trend line, specify <code>method = "lm"</code>.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-visualization.html#cb255-1" tabindex="-1"></a><span class="co"># Linear regression line</span></span>
<span id="cb255-2"><a href="data-visualization.html#cb255-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, </span>
<span id="cb255-3"><a href="data-visualization.html#cb255-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length)) <span class="sc">+</span> </span>
<span id="cb255-4"><a href="data-visualization.html#cb255-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb255-5"><a href="data-visualization.html#cb255-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" alt="" width="672" /></p>
</div>
<div id="add-other-aesthetic" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Add other aesthetic<a href="data-visualization.html#add-other-aesthetic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>set other aesthetics <code>colour, alpha (transparency), and size of points</code></li>
</ul>
<p>Aesthetic mapping is powerful:
- mapping inside <code>aes()</code> means “vary by data,”
- setting outside <code>aes()</code> means “fixed constant.”</p>
<p>Here we map point size to Sepal.Width and set a fixed color + alpha.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-visualization.html#cb257-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb257-2"><a href="data-visualization.html#cb257-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length, <span class="at">size =</span> Sepal.Width     ), </span>
<span id="cb257-3"><a href="data-visualization.html#cb257-3" tabindex="-1"></a>             <span class="at">alpha =</span> .<span class="dv">5</span>, </span>
<span id="cb257-4"><a href="data-visualization.html#cb257-4" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-126-1.png" alt="" width="672" /></p>
<p>Here we map color to Species, producing a grouped scatter plot.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-visualization.html#cb258-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb258-2"><a href="data-visualization.html#cb258-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length, <span class="at">size =</span> Sepal.Width , <span class="at">colour=</span>Species), <span class="co">#white is a variable here </span></span>
<span id="cb258-3"><a href="data-visualization.html#cb258-3" tabindex="-1"></a>             <span class="at">alpha=</span>.<span class="dv">9</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" alt="" width="672" /></p>
<ul>
<li>categorize <code>Petal.Width</code> then map colour to this new variable<br />
Creating derived categorical variables is common in applied analysis (e.g., risk categories).<br />
Then you can visualize patterns by category.</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-visualization.html#cb259-1" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="data-visualization.html#cb259-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">growth =</span> <span class="fu">ifelse</span>(Petal.Width   <span class="sc">&gt;</span> <span class="fl">1.5</span>, <span class="st">&quot;Wide&quot;</span>, <span class="st">&quot;Normal&quot;</span>))</span>
<span id="cb259-3"><a href="data-visualization.html#cb259-3" tabindex="-1"></a></span>
<span id="cb259-4"><a href="data-visualization.html#cb259-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris) <span class="sc">+</span> </span>
<span id="cb259-5"><a href="data-visualization.html#cb259-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length, <span class="at">size =</span> Sepal.Width , <span class="at">colour=</span>growth), </span>
<span id="cb259-6"><a href="data-visualization.html#cb259-6" tabindex="-1"></a>             <span class="at">alpha=</span>.<span class="dv">9</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" alt="" width="672" /></p>
</div>
</div>
<div id="bar-chart" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Bar chart<a href="data-visualization.html#bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bar charts summarize counts for categorical variables.<br />
Here we count the number of observations in each growth category.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-visualization.html#cb260-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb260-2"><a href="data-visualization.html#cb260-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> growth))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-129-1.png" alt="" width="672" /></p>
<ul>
<li>bar chart after <code>group_by</code><br />
</li>
<li>then use <code>stat='identity'</code></li>
</ul>
<p>If you want bars to represent <strong>pre-computed values</strong> (means, totals, proportions), you must provide y explicitly and set <code>stat = "identity"</code>.<br />
Here we summarize mean Sepal.Length by Species and growth category.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-visualization.html#cb261-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb261-2"><a href="data-visualization.html#cb261-2" tabindex="-1"></a>results  <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> </span>
<span id="cb261-3"><a href="data-visualization.html#cb261-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Species, growth) <span class="sc">%&gt;%</span> </span>
<span id="cb261-4"><a href="data-visualization.html#cb261-4" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">Sepal.Length.mean=</span><span class="fu">mean</span> (Sepal.Length ))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Species&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-visualization.html#cb263-1" tabindex="-1"></a> gop <span class="ot">&lt;-</span> results  <span class="sc">%&gt;%</span> </span>
<span id="cb263-2"><a href="data-visualization.html#cb263-2" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">&quot;setosa_null&quot;</span>  )</span>
<span id="cb263-3"><a href="data-visualization.html#cb263-3" tabindex="-1"></a> gop</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
## # Groups:   Species [3]
##   Species    growth Sepal.Length.mean
##   &lt;fct&gt;      &lt;chr&gt;              &lt;dbl&gt;
## 1 setosa     Normal              5.01
## 2 versicolor Normal              5.91
## 3 versicolor Wide                6.18
## 4 virginica  Normal              6.13
## 5 virginica  Wide                6.62</code></pre>
<ul>
<li>though meaningless below until line chart (just use the mean as the sum for demonstration)<br />
This shows the mechanics of an identity bar chart.</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-visualization.html#cb265-1" tabindex="-1"></a><span class="co"># We can also store parts of a plot in an object</span></span>
<span id="cb265-2"><a href="data-visualization.html#cb265-2" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gop) <span class="sc">+</span> </span>
<span id="cb265-3"><a href="data-visualization.html#cb265-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>growth , <span class="at">y=</span>Sepal.Length.mean), </span>
<span id="cb265-4"><a href="data-visualization.html#cb265-4" tabindex="-1"></a>           </span>
<span id="cb265-5"><a href="data-visualization.html#cb265-5" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb265-6"><a href="data-visualization.html#cb265-6" tabindex="-1"></a>plot1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-131-1.png" alt="" width="672" /></p>
<div id="add-some-options-for-the-whole-ggplot-rather-than-layers" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Add some options for the whole ggplot rather than layers<a href="data-visualization.html#add-some-options-for-the-whole-ggplot-rather-than-layers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>switch</code> the x and y axes<br />
<code>coord_flip()</code> is frequently used when category labels are long.</li>
</ul>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-visualization.html#cb266-1" tabindex="-1"></a>plot1 <span class="sc">+</span> </span>
<span id="cb266-2"><a href="data-visualization.html#cb266-2" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-132-1.png" alt="" width="672" /></p>
<ul>
<li><code>reorder</code> x categories (<code>-</code>means descending)<br />
Ordering categories by a statistic is one of the easiest ways to improve readability.</li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-visualization.html#cb267-1" tabindex="-1"></a><span class="fu">ggplot</span>( gop) <span class="sc">+</span> </span>
<span id="cb267-2"><a href="data-visualization.html#cb267-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(growth, <span class="sc">-</span>Sepal.Length.mean), <span class="at">y=</span>Sepal.Length.mean, <span class="at">fill=</span>growth), </span>
<span id="cb267-3"><a href="data-visualization.html#cb267-3" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="sc">+</span> </span>
<span id="cb267-4"><a href="data-visualization.html#cb267-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" alt="" width="672" /></p>
<ul>
<li>add x axis <code>label</code> and a <code>theme</code><br />
This is a typical “publication polish” pattern: label axes, remove redundant legends, apply a clean theme.</li>
</ul>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-visualization.html#cb268-1" tabindex="-1"></a><span class="fu">ggplot</span>(gop) <span class="sc">+</span> </span>
<span id="cb268-2"><a href="data-visualization.html#cb268-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(growth, <span class="sc">-</span>Sepal.Length.mean), <span class="at">y=</span>Sepal.Length.mean, <span class="at">fill=</span>growth), </span>
<span id="cb268-3"><a href="data-visualization.html#cb268-3" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-4"><a href="data-visualization.html#cb268-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb268-5"><a href="data-visualization.html#cb268-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Growth categories&quot;</span>) <span class="sc">+</span> </span>
<span id="cb268-6"><a href="data-visualization.html#cb268-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span>F) <span class="sc">+</span></span>
<span id="cb268-7"><a href="data-visualization.html#cb268-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use &quot;none&quot;
## instead as of ggplot2 3.3.4.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" alt="" width="672" /></p>
<ul>
<li>set theme<br />
Themes can be standardized across reports. <code>ggthemes</code> offers a set of recognizable styles.</li>
</ul>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-visualization.html#cb270-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggthemes&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-visualization.html#cb272-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span> </span>
<span id="cb272-2"><a href="data-visualization.html#cb272-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> growth)) <span class="sc">+</span> </span>
<span id="cb272-3"><a href="data-visualization.html#cb272-3" tabindex="-1"></a>  <span class="fu">theme_economist</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-135-1.png" alt="" width="672" /></p>
</div>
<div id="grouped-bar-chart" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Grouped bar chart<a href="data-visualization.html#grouped-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>-bar chart with different panels<br />
Faceting is a quick way to compare the same plot structure across groups.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="data-visualization.html#cb273-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb273-2"><a href="data-visualization.html#cb273-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb273-3"><a href="data-visualization.html#cb273-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> year)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" alt="" width="672" /></p>
<ul>
<li>actual number (groups are stacked by default)<br />
Stacked bars are useful for composition, but can be harder to compare across groups.</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-visualization.html#cb274-1" tabindex="-1"></a><span class="fu">ggplot</span>(gop) <span class="sc">+</span> </span>
<span id="cb274-2"><a href="data-visualization.html#cb274-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>growth, <span class="at">y=</span>Sepal.Length.mean, <span class="at">fill=</span>Species)</span>
<span id="cb274-3"><a href="data-visualization.html#cb274-3" tabindex="-1"></a>           , <span class="at">stat=</span><span class="st">&#39;identity&#39;</span></span>
<span id="cb274-4"><a href="data-visualization.html#cb274-4" tabindex="-1"></a>           )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-137-1.png" alt="" width="672" /></p>
<p>This shows a stacked count plot by default.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="data-visualization.html#cb275-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class )) <span class="sc">+</span> </span>
<span id="cb275-2"><a href="data-visualization.html#cb275-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">group =</span> year, <span class="at">fill =</span> year), <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-138-1.png" alt="" width="672" /></p>
<ul>
<li>percentage<br />
Position “fill” converts to proportions (each bar sums to 1).<br />
This is ideal for comparing composition across categories.</li>
</ul>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="data-visualization.html#cb276-1" tabindex="-1"></a><span class="fu">ggplot</span>(gop) <span class="sc">+</span> </span>
<span id="cb276-2"><a href="data-visualization.html#cb276-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>growth, <span class="at">y=</span>Sepal.Length.mean, <span class="at">fill=</span>Species), </span>
<span id="cb276-3"><a href="data-visualization.html#cb276-3" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, </span>
<span id="cb276-4"><a href="data-visualization.html#cb276-4" tabindex="-1"></a>           <span class="at">position=</span><span class="st">&#39;fill&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-139-1.png" alt="" width="672" /></p>
<ul>
<li>groups are dodge with <code>actual number</code><br />
Dodged bars are easier for comparing group values directly.</li>
</ul>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="data-visualization.html#cb277-1" tabindex="-1"></a><span class="fu">ggplot</span>(gop) <span class="sc">+</span> </span>
<span id="cb277-2"><a href="data-visualization.html#cb277-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>growth, <span class="at">y=</span>Sepal.Length.mean, <span class="at">fill=</span>Species), </span>
<span id="cb277-3"><a href="data-visualization.html#cb277-3" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, </span>
<span id="cb277-4"><a href="data-visualization.html#cb277-4" tabindex="-1"></a>           <span class="at">position=</span><span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-140-1.png" alt="" width="672" /></p>
<ul>
<li>groups are dodge with <code>percentage</code><br />
Here we compute within-growth proportions manually, then plot as dodged bars.<br />
This is a useful pattern when you want side-by-side proportions rather than stacked proportions.</li>
</ul>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="data-visualization.html#cb278-1" tabindex="-1"></a>gop2 <span class="ot">&lt;-</span> gop <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="data-visualization.html#cb278-2" tabindex="-1"></a>  <span class="fu">group_by</span>(growth ) <span class="sc">%&gt;%</span> </span>
<span id="cb278-3"><a href="data-visualization.html#cb278-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sepal.Length.prop=</span>Sepal.Length.mean<span class="sc">/</span><span class="fu">sum</span>(Sepal.Length.mean))</span>
<span id="cb278-4"><a href="data-visualization.html#cb278-4" tabindex="-1"></a></span>
<span id="cb278-5"><a href="data-visualization.html#cb278-5" tabindex="-1"></a><span class="fu">ggplot</span>(gop2) <span class="sc">+</span> </span>
<span id="cb278-6"><a href="data-visualization.html#cb278-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>growth, <span class="at">y=</span>Sepal.Length.prop, <span class="at">fill=</span>Species), </span>
<span id="cb278-7"><a href="data-visualization.html#cb278-7" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>, </span>
<span id="cb278-8"><a href="data-visualization.html#cb278-8" tabindex="-1"></a>           <span class="at">position=</span><span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span> </span>
<span id="cb278-9"><a href="data-visualization.html#cb278-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Votes (%)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-141-1.png" alt="" width="672" /></p>
</div>
</div>
<div id="line-charts" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Line charts<a href="data-visualization.html#line-charts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Line charts are best when x represents an ordered scale (time, dose, sequence).<br />
If x is not truly ordered, lines can mislead, so use carefully.</p>
<p>This simple line plot demonstrates the syntax, though in real applications you usually group lines by an ID or category.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="data-visualization.html#cb279-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span> </span>
<span id="cb279-2"><a href="data-visualization.html#cb279-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-1.png" alt="" width="672" /></p>
<div id="grouped-by-colour-variable" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Grouped by <code>colour variable</code><a href="data-visualization.html#grouped-by-colour-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mapping color to Species creates separate lines for each group.<br />
This is a common pattern for showing group trends.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="data-visualization.html#cb280-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span> </span>
<span id="cb280-2"><a href="data-visualization.html#cb280-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length, <span class="at">colour =</span> Species))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-143-1.png" alt="" width="672" /></p>
<ul>
<li>grouped by state then set how many rows or columns<br />
Faceting creates separate small panels for each group.<br />
This can improve readability when multiple lines overlap in one plot.</li>
</ul>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="data-visualization.html#cb281-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span> </span>
<span id="cb281-2"><a href="data-visualization.html#cb281-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length , <span class="at">y=</span>Petal.Length) ) <span class="sc">+</span> </span>
<span id="cb281-3"><a href="data-visualization.html#cb281-3" tabindex="-1"></a>  </span>
<span id="cb281-4"><a href="data-visualization.html#cb281-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span>      <span class="co">#set how many rows</span></span>
<span id="cb281-5"><a href="data-visualization.html#cb281-5" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-144-1.png" alt="" width="672" /></p>
</div>
<div id="multiple-aesthetics" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Multiple aesthetics<a href="data-visualization.html#multiple-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we show multiple mappings and transformations:
- a thicker line,
- log scaling on x,
- point size and color mapped to variables,
- and faceting by Species.</p>
<p>This is a realistic “final figure” style example—dense but informative.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="data-visualization.html#cb282-1" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="data-visualization.html#cb282-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">growth =</span> <span class="fu">ifelse</span>(Petal.Width   <span class="sc">&gt;</span> <span class="fl">1.5</span>, <span class="st">&quot;Wide&quot;</span>, <span class="st">&quot;Normal&quot;</span>))</span>
<span id="cb282-3"><a href="data-visualization.html#cb282-3" tabindex="-1"></a></span>
<span id="cb282-4"><a href="data-visualization.html#cb282-4" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> </span>
<span id="cb282-5"><a href="data-visualization.html#cb282-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>,<span class="at">color=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb282-6"><a href="data-visualization.html#cb282-6" tabindex="-1"></a>  <span class="co"># number format</span></span>
<span id="cb282-7"><a href="data-visualization.html#cb282-7" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>())<span class="sc">+</span></span>
<span id="cb282-8"><a href="data-visualization.html#cb282-8" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(<span class="at">size =</span>  Sepal.Length,<span class="at">colour =</span> <span class="fu">as.factor</span>(growth)),<span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb282-9"><a href="data-visualization.html#cb282-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Species) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-145-1.png" alt="" width="672" /></p>
</div>
</div>
<div id="ggplot2-parameters" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> ggplot2 parameters<a href="data-visualization.html#ggplot2-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To go further, it helps to understand the “grammar of graphics” idea behind ggplot2:<br />
- <strong>data</strong> provides the rows,<br />
- <strong>aes</strong> maps variables to visual properties,<br />
- <strong>geoms</strong> draw shapes,<br />
- <strong>scales</strong> control transformations and legends,<br />
- <strong>guides</strong> refine legends,<br />
- <strong>themes</strong> control appearance.</p>
<p>For detail, please read this <a href="http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization#change-colors-automatically-and-manually">article</a> and this <a href="https://ggplot2-book.org/">one</a>.</p>
<!-- https://bookdown.org/wangminjie/R4DS/tidyverse-ggplot2-scales.html -->
<p>The following chunk lists a large set of packages used for advanced visualization workflows.<br />
In practice, you do not need all of them for basic plots, but it is useful to know what exists:
- <code>ggrepel</code> for non-overlapping labels,
- <code>patchwork</code> for combining plots,
- <code>gganimate</code> for animation,
- <code>sf</code> for spatial data,
- <code>ggthemes</code> for themes, etc.</p>
<p>This example is a classic demonstration that <strong>summary statistics can be misleading</strong>.<br />
Different datasets can share the same mean, variance, and correlation—but look completely different when plotted.<br />
Always plot your data.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="data-visualization.html#cb283-1" tabindex="-1"></a><span class="fu">library</span>(datasauRus)</span></code></pre></div>
<pre><code>## Warning: package &#39;datasauRus&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="data-visualization.html#cb285-1" tabindex="-1"></a>  <span class="fu">ggplot</span>( )<span class="sc">+</span></span>
<span id="cb285-2"><a href="data-visualization.html#cb285-2" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>datasaurus_dozen[datasaurus_dozen<span class="sc">$</span>dataset<span class="sc">==</span><span class="st">&quot;dino&quot;</span>,], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),<span class="at">color=</span> <span class="st">&quot;#7CAE00&quot;</span> ) <span class="sc">+</span></span>
<span id="cb285-3"><a href="data-visualization.html#cb285-3" tabindex="-1"></a>    <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb285-4"><a href="data-visualization.html#cb285-4" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-1.png" alt="" width="672" /></p>
<div id="components-of-plot" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Components of plot<a href="data-visualization.html#components-of-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A practical way to think about building plots:</p>
<ul>
<li>Components of plot
<ul>
<li>Data: is a data frame</li>
<li>Aesthetics: is used to indicate x and y variables and to control the color, the size or the shape …</li>
<li>Geometry: the type of graphics (bar plot, line plot, scatter plot…)</li>
</ul></li>
<li>adjust parameters
<ul>
<li>adjust legend using <code>guide_</code><br />
</li>
<li>adjust color, size, and shape using <code>scale_</code>, <code>guide_</code> can further adjust <code>scale_</code></li>
<li>adjust panel, background, axis (font, color, size, angle), title, legend (position), caption using theme</li>
</ul></li>
<li>types of plots
<ul>
<li>geom_boxplot(): Box plot</li>
<li>geom_violin(): Violin plot</li>
<li>geom_dotplot(): Dot plot</li>
<li>geom_jitter(): Jitter charts</li>
<li>geom_line(): Line plot</li>
<li>geom_bar(): Bar plot</li>
<li>geom_errorbar(): Error bars</li>
<li>geom_point(): Scatter plot</li>
<li>geom_smooth(): Add smoothed curve</li>
<li>geom_quantile(): Add quantile lines<br />
</li>
<li>geom_text(): Textual annotations</li>
<li>geom_density(): Create a smooth density curve</li>
<li>geom_histogram(): Histogram</li>
</ul></li>
</ul>
<p><code>example</code><br />
This example uses the Old Faithful geyser dataset and overlays a 2D density estimate.<br />
This is a useful technique when points overlap heavily and you want to show concentration.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="data-visualization.html#cb286-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;faithful&quot;</span>)</span>
<span id="cb286-2"><a href="data-visualization.html#cb286-2" tabindex="-1"></a><span class="co"># Basic scatterplot</span></span>
<span id="cb286-3"><a href="data-visualization.html#cb286-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> faithful, </span>
<span id="cb286-4"><a href="data-visualization.html#cb286-4" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting)) <span class="sc">+</span> </span>
<span id="cb286-5"><a href="data-visualization.html#cb286-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb286-6"><a href="data-visualization.html#cb286-6" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ..level..), <span class="at">geom=</span><span class="st">&quot;polygon&quot;</span>)   </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-148-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="data-visualization.html#cb287-1" tabindex="-1"></a><span class="co"># Data and mapping can be given both as global (in ggplot()) or per layer</span></span>
<span id="cb287-2"><a href="data-visualization.html#cb287-2" tabindex="-1"></a><span class="co"># ggplot() + </span></span>
<span id="cb287-3"><a href="data-visualization.html#cb287-3" tabindex="-1"></a><span class="co">#   geom_point(mapping = aes(x = eruptions, y = waiting),</span></span>
<span id="cb287-4"><a href="data-visualization.html#cb287-4" tabindex="-1"></a><span class="co">#              data = faithful)</span></span></code></pre></div>
</div>
<div id="create-main-title-axis-labels-caption" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Create main title, axis labels, caption<a href="data-visualization.html#create-main-title-axis-labels-caption" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Titles and captions turn plots into “report-ready” figures.<br />
Axis labels should make units explicit, and captions should record the data source if applicable.</p>
<p>pay attention whether argument is factor or continuous.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="data-visualization.html#cb288-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> faithful, </span>
<span id="cb288-2"><a href="data-visualization.html#cb288-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting)) <span class="sc">+</span> </span>
<span id="cb288-3"><a href="data-visualization.html#cb288-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb288-4"><a href="data-visualization.html#cb288-4" tabindex="-1"></a>  </span>
<span id="cb288-5"><a href="data-visualization.html#cb288-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of xxx&quot;</span>,</span>
<span id="cb288-6"><a href="data-visualization.html#cb288-6" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: http://xxx&quot;</span>,</span>
<span id="cb288-7"><a href="data-visualization.html#cb288-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Eruptions&quot;</span> ,</span>
<span id="cb288-8"><a href="data-visualization.html#cb288-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Waiting time&quot;</span> ) <span class="sc">+</span></span>
<span id="cb288-9"><a href="data-visualization.html#cb288-9" tabindex="-1"></a><span class="co"># customize title, axis, caption  </span></span>
<span id="cb288-10"><a href="data-visualization.html#cb288-10" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb288-11"><a href="data-visualization.html#cb288-11" tabindex="-1"></a><span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">14</span>, <span class="at">face=</span><span class="st">&quot;bold.italic&quot;</span>),</span>
<span id="cb288-12"><a href="data-visualization.html#cb288-12" tabindex="-1"></a><span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">face=</span><span class="st">&quot;italic&quot;</span>),</span>
<span id="cb288-13"><a href="data-visualization.html#cb288-13" tabindex="-1"></a><span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">14</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb288-14"><a href="data-visualization.html#cb288-14" tabindex="-1"></a><span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">&quot;#993333&quot;</span>, <span class="at">size=</span><span class="dv">14</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb288-15"><a href="data-visualization.html#cb288-15" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb288-16"><a href="data-visualization.html#cb288-16" tabindex="-1"></a>  </span>
<span id="cb288-17"><a href="data-visualization.html#cb288-17" tabindex="-1"></a><span class="co"># hide main title  </span></span>
<span id="cb288-18"><a href="data-visualization.html#cb288-18" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>() )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-149-1.png" alt="" width="672" /></p>
</div>
<div id="create-legend-title-position" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Create legend title, position<a href="data-visualization.html#create-legend-title-position" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Legends should explain the mapping clearly (what does color mean? what does size mean?).<br />
You can also move the legend depending on layout constraints (e.g., left for tall plots, bottom for wide panels).</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="data-visualization.html#cb289-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb289-2"><a href="data-visualization.html#cb289-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting, <span class="at">colour =</span> eruptions <span class="sc">&lt;</span> <span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb289-3"><a href="data-visualization.html#cb289-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Numbers of eruptions&quot;</span>) <span class="sc">+</span></span>
<span id="cb289-4"><a href="data-visualization.html#cb289-4" tabindex="-1"></a>  </span>
<span id="cb289-5"><a href="data-visualization.html#cb289-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>)<span class="sc">+</span></span>
<span id="cb289-6"><a href="data-visualization.html#cb289-6" tabindex="-1"></a><span class="co"># Change the appearance of legend title and labels</span></span>
<span id="cb289-7"><a href="data-visualization.html#cb289-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;blue&quot;</span>),</span>
<span id="cb289-8"><a href="data-visualization.html#cb289-8" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>))<span class="sc">+</span></span>
<span id="cb289-9"><a href="data-visualization.html#cb289-9" tabindex="-1"></a><span class="co"># Change legend box background color</span></span>
<span id="cb289-10"><a href="data-visualization.html#cb289-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NULL</span>))</span>
<span id="cb289-11"><a href="data-visualization.html#cb289-11" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-150-1.png" alt="" width="672" /></p>
<ul>
<li><code>customize legends using scale functions</code><br />
Scales can rename and reorder legend entries.<br />
This is often necessary when boolean variables show up as “FALSE/TRUE” but you want more meaningful labels.</li>
</ul>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="data-visualization.html#cb290-1" tabindex="-1"></a><span class="co"># how to change order of legend?  </span></span>
<span id="cb290-2"><a href="data-visualization.html#cb290-2" tabindex="-1"></a><span class="co"># Set legend title and labels</span></span>
<span id="cb290-3"><a href="data-visualization.html#cb290-3" tabindex="-1"></a>p<span class="sc">+</span> <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Numbers of eruptions change&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span> ))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-151-1.png" alt="" width="672" /></p>
<ul>
<li>customize legend<br />
<code>guide_colorbar()</code> is typically used for continuous variables;<br />
<code>guide_legend()</code> is used for discrete variables (colors, shapes, linetypes).<br />
This block shows how to control legend title and label appearance in detail.</li>
</ul>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="data-visualization.html#cb291-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb291-2"><a href="data-visualization.html#cb291-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting, <span class="at">size =</span> eruptions <span class="sc">&lt;</span> <span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb291-3"><a href="data-visualization.html#cb291-3" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb291-4"><a href="data-visualization.html#cb291-4" tabindex="-1"></a>    <span class="co"># legend title</span></span>
<span id="cb291-5"><a href="data-visualization.html#cb291-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;title is too low&quot;</span>,</span>
<span id="cb291-6"><a href="data-visualization.html#cb291-6" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb291-7"><a href="data-visualization.html#cb291-7" tabindex="-1"></a>    <span class="at">title.vjust =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb291-8"><a href="data-visualization.html#cb291-8" tabindex="-1"></a>    <span class="co"># legend label</span></span>
<span id="cb291-9"><a href="data-visualization.html#cb291-9" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb291-10"><a href="data-visualization.html#cb291-10" tabindex="-1"></a>    <span class="at">label.hjust =</span> <span class="dv">1</span>,</span>
<span id="cb291-11"><a href="data-visualization.html#cb291-11" tabindex="-1"></a>    <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb291-12"><a href="data-visualization.html#cb291-12" tabindex="-1"></a>                               <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>,</span>
<span id="cb291-13"><a href="data-visualization.html#cb291-13" tabindex="-1"></a>                               <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb291-14"><a href="data-visualization.html#cb291-14" tabindex="-1"></a>                               <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb291-15"><a href="data-visualization.html#cb291-15" tabindex="-1"></a>    <span class="co"># label reverse</span></span>
<span id="cb291-16"><a href="data-visualization.html#cb291-16" tabindex="-1"></a>    <span class="at">reverse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb291-17"><a href="data-visualization.html#cb291-17" tabindex="-1"></a>    </span>
<span id="cb291-18"><a href="data-visualization.html#cb291-18" tabindex="-1"></a>    <span class="co"># width of bin</span></span>
<span id="cb291-19"><a href="data-visualization.html#cb291-19" tabindex="-1"></a>    <span class="at">keywidth =</span> <span class="dv">1</span>,</span>
<span id="cb291-20"><a href="data-visualization.html#cb291-20" tabindex="-1"></a>    </span>
<span id="cb291-21"><a href="data-visualization.html#cb291-21" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">4</span></span>
<span id="cb291-22"><a href="data-visualization.html#cb291-22" tabindex="-1"></a>    </span>
<span id="cb291-23"><a href="data-visualization.html#cb291-23" tabindex="-1"></a>   )</span>
<span id="cb291-24"><a href="data-visualization.html#cb291-24" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning: Using size for a discrete variable is not advised.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" alt="" width="672" /></p>
<ul>
<li>delete a legend<br />
A common practical cleanup is to remove redundant legends when multiple aesthetics are shown.<br />
Here we keep the color legend but remove size legend.</li>
</ul>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="data-visualization.html#cb293-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class, <span class="at">size =</span> cyl)) <span class="sc">+</span></span>
<span id="cb293-2"><a href="data-visualization.html#cb293-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb293-3"><a href="data-visualization.html#cb293-3" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb293-4"><a href="data-visualization.html#cb293-4" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;type&quot;</span>),      <span class="co"># keep</span></span>
<span id="cb293-5"><a href="data-visualization.html#cb293-5" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">&quot;none&quot;</span>                      <span class="co"># remove</span></span>
<span id="cb293-6"><a href="data-visualization.html#cb293-6" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" alt="" width="672" /></p>
<ul>
<li>combine two legends when they use the same variable (mapping)<br />
Mapping both color and size to the same variable can create duplicate legends.<br />
Here we unify them by explicitly setting guides.</li>
</ul>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="data-visualization.html#cb294-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> cyl, <span class="at">size =</span> cyl)) <span class="sc">+</span></span>
<span id="cb294-2"><a href="data-visualization.html#cb294-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb294-3"><a href="data-visualization.html#cb294-3" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb294-4"><a href="data-visualization.html#cb294-4" tabindex="-1"></a>  </span>
<span id="cb294-5"><a href="data-visualization.html#cb294-5" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb294-6"><a href="data-visualization.html#cb294-6" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>),</span>
<span id="cb294-7"><a href="data-visualization.html#cb294-7" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="st">&quot;title&quot;</span>)</span>
<span id="cb294-8"><a href="data-visualization.html#cb294-8" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-154-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="data-visualization.html#cb295-1" tabindex="-1"></a><span class="co"># guide = &quot;legend&quot;</span></span></code></pre></div>
</div>
<div id="change-plot-colors" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Change plot colors<a href="data-visualization.html#change-plot-colors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section demonstrates the key concept:</p>
<ul>
<li><code>set color into aes()</code> means the color varies by a variable.<br />
</li>
<li><code>set color outside of aes()</code> means a constant color.</li>
</ul>
<p><code>set color into aes()</code></p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="data-visualization.html#cb296-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb296-2"><a href="data-visualization.html#cb296-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting, <span class="at">colour =</span> eruptions <span class="sc">&lt;</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-155-1.png" alt="" width="672" /></p>
<p><code>set color outside of aes()</code></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="data-visualization.html#cb297-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb297-2"><a href="data-visualization.html#cb297-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting),</span>
<span id="cb297-3"><a href="data-visualization.html#cb297-3" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;steelblue&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-156-1.png" alt="" width="672" /></p>
<ul>
<li>Colour the histogram with <code>color</code> and <code>fill</code><br />
This maps outline color and fill color to logical conditions.<br />
In practice, you might map fill to a categorical group or a binned continuous variable.</li>
</ul>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="data-visualization.html#cb298-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb298-2"><a href="data-visualization.html#cb298-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions,<span class="at">color=</span>eruptions <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="at">fill=</span>eruptions <span class="sc">&lt;</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" alt="" width="672" /></p>
<ul>
<li>Colour the histogram by <code>waiting</code> and changing <code>position</code><br />
Position controls how groups are displayed (stacked, dodged, or overlaid).</li>
</ul>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="data-visualization.html#cb300-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb300-2"><a href="data-visualization.html#cb300-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions,<span class="at">color=</span>waiting<span class="sc">&gt;</span><span class="dv">60</span>), <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-158-1.png" alt="" width="672" /></p>
<p>Overlaying histograms can be informative but can also become messy; using transparency or density curves can help.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="data-visualization.html#cb302-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb302-2"><a href="data-visualization.html#cb302-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions,<span class="at">color=</span>waiting<span class="sc">&gt;</span><span class="dv">60</span>), <span class="at">position =</span> <span class="st">&#39;identity&#39;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-159-1.png" alt="" width="672" /></p>
<p>For fill and stack position, please see <code>position</code> section.</p>
<ul>
<li><code>change colors manually using scale</code><br />
Manual scales are helpful for consistency across plots in a report.<br />
This example shows both fill and outline color manual control.</li>
</ul>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="data-visualization.html#cb304-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb304-2"><a href="data-visualization.html#cb304-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions,<span class="at">color=</span>eruptions <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="at">fill=</span>eruptions <span class="sc">&lt;</span> <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb304-3"><a href="data-visualization.html#cb304-3" tabindex="-1"></a>  <span class="co"># Box plot</span></span>
<span id="cb304-4"><a href="data-visualization.html#cb304-4" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-160-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="data-visualization.html#cb305-1" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb305-2"><a href="data-visualization.html#cb305-2" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>( <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>))</span></code></pre></div>
<pre><code>## &lt;ggproto object: Class ScaleDiscrete, Scale, gg&gt;
##     aesthetics: colour
##     axis_order: function
##     break_info: function
##     break_positions: function
##     breaks: waiver
##     call: call
##     clone: function
##     dimension: function
##     drop: TRUE
##     expand: waiver
##     fallback_palette: function
##     get_breaks: function
##     get_breaks_minor: function
##     get_labels: function
##     get_limits: function
##     get_transformation: function
##     guide: legend
##     is_discrete: function
##     is_empty: function
##     labels: waiver
##     limits: NULL
##     make_sec_title: function
##     make_title: function
##     map: function
##     map_df: function
##     minor_breaks: waiver
##     n.breaks.cache: NULL
##     na.translate: TRUE
##     na.value: grey50
##     name: waiver
##     palette: function
##     palette.cache: NULL
##     position: left
##     range: environment
##     rescale: function
##     reset: function
##     train: function
##     train_df: function
##     transform: function
##     transform_df: function
##     super:  &lt;ggproto object: Class ScaleDiscrete, Scale, gg&gt;</code></pre>
<ul>
<li><code>using scale brewer automatically</code><br />
Brewer palettes are widely used, especially for categorical palettes that are print-friendly.</li>
</ul>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="data-visualization.html#cb307-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb307-2"><a href="data-visualization.html#cb307-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions,<span class="at">color=</span>eruptions <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="at">fill=</span>eruptions <span class="sc">&lt;</span> <span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb307-3"><a href="data-visualization.html#cb307-3" tabindex="-1"></a>  <span class="co"># Box plot</span></span>
<span id="cb307-4"><a href="data-visualization.html#cb307-4" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-161-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="data-visualization.html#cb309-1" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb309-2"><a href="data-visualization.html#cb309-2" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette=</span><span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;ggproto object: Class ScaleDiscrete, Scale, gg&gt;
##     aesthetics: colour
##     axis_order: function
##     break_info: function
##     break_positions: function
##     breaks: waiver
##     call: call
##     clone: function
##     dimension: function
##     drop: TRUE
##     expand: waiver
##     fallback_palette: function
##     get_breaks: function
##     get_breaks_minor: function
##     get_labels: function
##     get_limits: function
##     get_transformation: function
##     guide: legend
##     is_discrete: function
##     is_empty: function
##     labels: waiver
##     limits: NULL
##     make_sec_title: function
##     make_title: function
##     map: function
##     map_df: function
##     minor_breaks: waiver
##     n.breaks.cache: NULL
##     na.translate: TRUE
##     na.value: NA
##     name: waiver
##     palette: function
##     palette.cache: NULL
##     position: left
##     range: environment
##     rescale: function
##     reset: function
##     train: function
##     train_df: function
##     transform: function
##     transform_df: function
##     super:  &lt;ggproto object: Class ScaleDiscrete, Scale, gg&gt;</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="data-visualization.html#cb311-1" tabindex="-1"></a>  <span class="co"># using guide to change the color of legend key</span></span></code></pre></div>
<ul>
<li><code>using gray colors using scale</code><br />
Grayscale is useful for black-and-white printing or when you want to avoid color emphasis.</li>
</ul>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="data-visualization.html#cb312-1" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb312-2"><a href="data-visualization.html#cb312-2" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_fill_grey</span>()  <span class="co">#no fill element</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-162-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-visualization.html#cb313-1" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb313-2"><a href="data-visualization.html#cb313-2" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_color_grey</span>()  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-162-2.png" alt="" width="672" /></p>
<ul>
<li><code>Gradient or continuous colors (can set the middle point as</code>white<code>)</code><br />
Continuous gradients are typically used for continuous variables.<br />
A diverging gradient is helpful when there is a meaningful midpoint.</li>
</ul>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="data-visualization.html#cb314-1" tabindex="-1"></a><span class="co"># Color by cty values</span></span>
<span id="cb314-2"><a href="data-visualization.html#cb314-2" tabindex="-1"></a>sp2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb314-3"><a href="data-visualization.html#cb314-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cty))</span>
<span id="cb314-4"><a href="data-visualization.html#cb314-4" tabindex="-1"></a>sp2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-163-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-visualization.html#cb315-1" tabindex="-1"></a><span class="co"># Change the low and high colors</span></span>
<span id="cb315-2"><a href="data-visualization.html#cb315-2" tabindex="-1"></a><span class="co"># Sequential color scheme</span></span>
<span id="cb315-3"><a href="data-visualization.html#cb315-3" tabindex="-1"></a>sp2<span class="sc">+</span><span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-163-2.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="data-visualization.html#cb316-1" tabindex="-1"></a><span class="co"># Diverging color scheme</span></span>
<span id="cb316-2"><a href="data-visualization.html#cb316-2" tabindex="-1"></a>mid<span class="ot">&lt;-</span><span class="fu">mean</span>(mpg<span class="sc">$</span>cty)</span>
<span id="cb316-3"><a href="data-visualization.html#cb316-3" tabindex="-1"></a>sp2<span class="sc">+</span><span class="fu">scale_color_gradient2</span>(<span class="at">midpoint=</span>mid, <span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">mid=</span><span class="st">&quot;white&quot;</span>,</span>
<span id="cb316-4"><a href="data-visualization.html#cb316-4" tabindex="-1"></a>                          <span class="at">high=</span><span class="st">&quot;red&quot;</span>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-163-3.png" alt="" width="672" /></p>
</div>
<div id="change-points-shapes-transparent-and-size" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Change points shapes, transparent and size<a href="data-visualization.html#change-points-shapes-transparent-and-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Transparency (<code>alpha</code>) helps when points overlap.<br />
Shape and size can carry additional information, but too many aesthetics can overwhelm the reader, so use thoughtfully.</p>
<p>make the points larger and slightly transparent.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="data-visualization.html#cb317-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb317-2"><a href="data-visualization.html#cb317-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting, <span class="at">shape=</span> eruptions <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="at">size=</span>eruptions), <span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-164-1.png" alt="" width="672" /></p>
<p>Reversing legend order can improve interpretability when sizes represent magnitude.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="data-visualization.html#cb318-1" tabindex="-1"></a><span class="co"># hwo to reverse order of legend size </span></span>
<span id="cb318-2"><a href="data-visualization.html#cb318-2" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb318-3"><a href="data-visualization.html#cb318-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting, <span class="at">shape=</span> eruptions <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="at">size=</span>eruptions), <span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb318-4"><a href="data-visualization.html#cb318-4" tabindex="-1"></a></span>
<span id="cb318-5"><a href="data-visualization.html#cb318-5" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">23</span> ))<span class="sc">+</span></span>
<span id="cb318-6"><a href="data-visualization.html#cb318-6" tabindex="-1"></a> </span>
<span id="cb318-7"><a href="data-visualization.html#cb318-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-165-1.png" alt="" width="672" /></p>
</div>
<div id="change-bars-position" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Change bars position<a href="data-visualization.html#change-bars-position" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Position is one of the most practical controls for bar charts:
- default is stacked,
- dodge is side-by-side,
- fill is normalized to proportions.</p>
<p>This block shows all four layouts in a panel.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="data-visualization.html#cb319-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(fl, <span class="at">fill =</span> drv))</span>
<span id="cb319-2"><a href="data-visualization.html#cb319-2" tabindex="-1"></a></span>
<span id="cb319-3"><a href="data-visualization.html#cb319-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_bar</span> ()</span>
<span id="cb319-4"><a href="data-visualization.html#cb319-4" tabindex="-1"></a></span>
<span id="cb319-5"><a href="data-visualization.html#cb319-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span>
<span id="cb319-6"><a href="data-visualization.html#cb319-6" tabindex="-1"></a> </span>
<span id="cb319-7"><a href="data-visualization.html#cb319-7" tabindex="-1"></a>p3 <span class="ot">&lt;-</span>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>)</span>
<span id="cb319-8"><a href="data-visualization.html#cb319-8" tabindex="-1"></a> </span>
<span id="cb319-9"><a href="data-visualization.html#cb319-9" tabindex="-1"></a>p4 <span class="ot">&lt;-</span>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>)</span>
<span id="cb319-10"><a href="data-visualization.html#cb319-10" tabindex="-1"></a></span>
<span id="cb319-11"><a href="data-visualization.html#cb319-11" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## Warning: package &#39;gridExtra&#39; was built under R version 4.4.3</code></pre>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="data-visualization.html#cb323-1" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3,p4, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-166-1.png" alt="" width="672" /></p>
</div>
<div id="add-text-annotations" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Add text annotations<a href="data-visualization.html#add-text-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Text annotations can highlight key points or provide labels.<br />
Be cautious with large datasets; consider <code>ggrepel</code> for label repulsion when needed.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="data-visualization.html#cb324-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg[(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>), ], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb324-2"><a href="data-visualization.html#cb324-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> cty))<span class="sc">+</span></span>
<span id="cb324-3"><a href="data-visualization.html#cb324-3" tabindex="-1"></a>  </span>
<span id="cb324-4"><a href="data-visualization.html#cb324-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> manufacturer ),</span>
<span id="cb324-5"><a href="data-visualization.html#cb324-5" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)  <span class="co">#vjust is site not direction</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-167-1.png" alt="" width="672" /></p>
</div>
<div id="add-a-line-that-separates-points" class="section level3 hasAnchor" number="4.5.8">
<h3><span class="header-section-number">4.5.8</span> Add a line that (separates points)<a href="data-visualization.html#add-a-line-that-separates-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Reference lines guide interpretation:
- <code>geom_abline()</code> for a line defined by slope/intercept,
- <code>geom_hline()</code> for a horizontal reference,
- <code>geom_vline()</code> for a vertical reference.</p>
<p>These are often used to mark thresholds or decision boundaries.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="data-visualization.html#cb325-1" tabindex="-1"></a><span class="fu">ggplot</span>(faithful) <span class="sc">+</span> </span>
<span id="cb325-2"><a href="data-visualization.html#cb325-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> eruptions, <span class="at">y =</span> waiting))<span class="sc">+</span></span>
<span id="cb325-3"><a href="data-visualization.html#cb325-3" tabindex="-1"></a>  </span>
<span id="cb325-4"><a href="data-visualization.html#cb325-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="sc">-</span><span class="dv">13</span>,<span class="at">intercept =</span> <span class="dv">100</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb325-5"><a href="data-visualization.html#cb325-5" tabindex="-1"></a>  <span class="co"># Add horizontal line at y = 2O; change line type and color</span></span>
<span id="cb325-6"><a href="data-visualization.html#cb325-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">20</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb325-7"><a href="data-visualization.html#cb325-7" tabindex="-1"></a><span class="co"># Add vertical line at x = 3; change line type, color and size</span></span>
<span id="cb325-8"><a href="data-visualization.html#cb325-8" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-168-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="data-visualization.html#cb326-1" tabindex="-1"></a><span class="co"># Add regression line</span></span></code></pre></div>
<p><code>add segment and arrow</code><br />
Segments and arrows are useful for pointing out specific regions of the plot.<br />
This is common in presentations and teaching.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="data-visualization.html#cb327-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy )) <span class="sc">+</span></span>
<span id="cb327-2"><a href="data-visualization.html#cb327-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb327-3"><a href="data-visualization.html#cb327-3" tabindex="-1"></a><span class="co"># Add horizontal line segment</span></span>
<span id="cb327-4"><a href="data-visualization.html#cb327-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">yend =</span> <span class="dv">15</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb327-5"><a href="data-visualization.html#cb327-5" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">33</span>, <span class="at">xend =</span> <span class="fl">2.5</span> , <span class="at">yend =</span> <span class="dv">30</span>),</span>
<span id="cb327-6"><a href="data-visualization.html#cb327-6" tabindex="-1"></a>                  <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>)))</span></code></pre></div>
<pre><code>## Warning in geom_segment(aes(x = 2, y = 15, xend = 3, yend = 15, size = 3, : All aesthetics have length 1, but the data has 234 rows.
## ℹ Please consider using `annotate()` or provide this layer with data
##   containing a single row.</code></pre>
<pre><code>## Warning in geom_segment(aes(x = 3, y = 33, xend = 2.5, yend = 30), arrow = arrow(length = unit(0.5, : All aesthetics have length 1, but the data has 234 rows.
## ℹ Please consider using `annotate()` or provide this layer with data
##   containing a single row.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-169-1.png" alt="" width="672" /></p>
<p><code>fitted curve</code><br />
A smooth curve shows the overall pattern.<br />
You can also subset data to remove categories that behave differently, as shown here.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="data-visualization.html#cb330-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg[mpg<span class="sc">$</span>fl<span class="sc">!=</span><span class="st">&quot;c&quot;</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb330-2"><a href="data-visualization.html#cb330-2" tabindex="-1"></a>  <span class="fu">geom_point</span>( ) <span class="sc">+</span></span>
<span id="cb330-3"><a href="data-visualization.html#cb330-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="co">#fitted curve</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-170-1.png" alt="" width="672" /></p>
<p>Quantile regression (<code>geom_quantile()</code>) can show how relationships differ across conditional quantiles.<br />
This is a useful exploratory tool when variance is not constant.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="data-visualization.html#cb332-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg[mpg<span class="sc">$</span>fl<span class="sc">!=</span><span class="st">&quot;c&quot;</span>,], <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb332-2"><a href="data-visualization.html#cb332-2" tabindex="-1"></a>  <span class="fu">geom_point</span>( ) <span class="sc">+</span> </span>
<span id="cb332-3"><a href="data-visualization.html#cb332-3" tabindex="-1"></a>  <span class="fu">geom_quantile</span>() <span class="sc">+</span></span>
<span id="cb332-4"><a href="data-visualization.html#cb332-4" tabindex="-1"></a>  <span class="fu">geom_rug</span>()<span class="sc">+</span></span>
<span id="cb332-5"><a href="data-visualization.html#cb332-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Smoothing formula not specified. Using: y ~ x</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-171-1.png" alt="" width="672" /></p>
<p><code>customize line</code><br />
This example shows how to control multiple aesthetics and manually customize scales.<br />
It also demonstrates a very important rule: if the plot is too complicated, consider simplifying—readability matters more than showing every possible mapping.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="data-visualization.html#cb334-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> fl, <span class="at">linetype =</span> fl, <span class="at">size=</span>fl)) <span class="sc">+</span></span>
<span id="cb334-2"><a href="data-visualization.html#cb334-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb334-3"><a href="data-visualization.html#cb334-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>( ) )<span class="sc">+</span></span>
<span id="cb334-4"><a href="data-visualization.html#cb334-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;What is fl&quot;</span>)<span class="sc">+</span></span>
<span id="cb334-5"><a href="data-visualization.html#cb334-5" tabindex="-1"></a>  </span>
<span id="cb334-6"><a href="data-visualization.html#cb334-6" tabindex="-1"></a><span class="co"># customize linetype, color, size  </span></span>
<span id="cb334-7"><a href="data-visualization.html#cb334-7" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotted&quot;</span>,<span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotted&quot;</span>,<span class="st">&quot;twodash&quot;</span>))<span class="sc">+</span></span>
<span id="cb334-8"><a href="data-visualization.html#cb334-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;continents&quot;</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;Oceania&quot;</span>),<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;africa&quot;</span>, <span class="st">&quot;americas&quot;</span>, <span class="st">&quot;asia&quot;</span>, <span class="st">&quot;europe&quot;</span>, <span class="st">&quot;oceania&quot;</span>),  <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;#999999&#39;</span>,<span class="st">&#39;#E69F00&#39;</span>,<span class="st">&#39;#999999&#39;</span>,<span class="st">&#39;#E69F00&#39;</span>,<span class="st">&#39;#999999&#39;</span>)   )<span class="sc">+</span> <span class="co">#using breaks define three labels   </span></span>
<span id="cb334-9"><a href="data-visualization.html#cb334-9" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>, <span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb334-10"><a href="data-visualization.html#cb334-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb334-11"><a href="data-visualization.html#cb334-11" tabindex="-1"></a>  </span>
<span id="cb334-12"><a href="data-visualization.html#cb334-12" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">&quot;legend&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-172-1.png" alt="" width="672" /></p>
</div>
<div id="using-scale_-function" class="section level3 hasAnchor" number="4.5.9">
<h3><span class="header-section-number">4.5.9</span> Using scale_ function<a href="data-visualization.html#using-scale_-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every aesthetic mapping has an associated scale, even if you do not specify it.<br />
Learning to use <code>scale_*()</code> functions is one of the fastest ways to level up plot quality.</p>
<ul>
<li>uisng <code>scale_colour_brewer</code>.</li>
</ul>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="data-visualization.html#cb335-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb335-2"><a href="data-visualization.html#cb335-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb335-3"><a href="data-visualization.html#cb335-3" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">type =</span> <span class="st">&#39;qual&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-173-1.png" alt="" width="672" /></p>
<p><code>RColorBrewer</code><br />
This displays available palettes—useful when choosing a consistent palette for a report.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="data-visualization.html#cb336-1" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-174-1.png" alt="" width="672" /></p>
<ul>
<li>using different palettes</li>
</ul>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="data-visualization.html#cb337-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb337-2"><a href="data-visualization.html#cb337-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb337-3"><a href="data-visualization.html#cb337-3" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span> (<span class="at">palette =</span> <span class="st">&#39;Paired&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-175-1.png" alt="" width="672" /></p>
<ul>
<li>showing <code>cyl</code> with size<br />
Combining color and size is common, but be mindful of legend clutter.<br />
Use breaks to simplify size legend.</li>
</ul>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="data-visualization.html#cb338-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb338-2"><a href="data-visualization.html#cb338-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span>  class, <span class="at">size=</span>cyl)) <span class="sc">+</span> </span>
<span id="cb338-3"><a href="data-visualization.html#cb338-3" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette  =</span> <span class="st">&#39;Set1&#39;</span> ) <span class="sc">+</span></span>
<span id="cb338-4"><a href="data-visualization.html#cb338-4" tabindex="-1"></a>  <span class="fu">scale_size</span> (<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>))   </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-176-1.png" alt="" width="672" /></p>
<ul>
<li>using <code>guides</code> to modify the <code>scale_</code><br />
Guides can override legend aesthetics.<br />
This is useful when you want legend points to be clearly visible and consistent.</li>
</ul>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="data-visualization.html#cb339-1" tabindex="-1"></a> <span class="fu">ggplot</span>(mpg) <span class="sc">+</span></span>
<span id="cb339-2"><a href="data-visualization.html#cb339-2" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span> cyl, <span class="at">size=</span>cyl)) <span class="sc">+</span></span>
<span id="cb339-3"><a href="data-visualization.html#cb339-3" tabindex="-1"></a>   <span class="co"># scale_colour_brewer(palette  = &#39;Set1&#39;) +   #can not continuous </span></span>
<span id="cb339-4"><a href="data-visualization.html#cb339-4" tabindex="-1"></a>   <span class="fu">scale_size</span> (<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))  <span class="sc">+</span></span>
<span id="cb339-5"><a href="data-visualization.html#cb339-5" tabindex="-1"></a>  </span>
<span id="cb339-6"><a href="data-visualization.html#cb339-6" tabindex="-1"></a>   <span class="fu">guides</span>( <span class="at">size =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb339-7"><a href="data-visualization.html#cb339-7" tabindex="-1"></a>            <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;black&#39;</span>))))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-177-1.png" alt="" width="672" /></p>
<ul>
<li>unite legends<br />
when multiple aesthetics are mapped to the same variable.<br />
This can reduce legend duplication and improve readability.</li>
</ul>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="data-visualization.html#cb340-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb340-2"><a href="data-visualization.html#cb340-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span> cyl, <span class="at">size=</span>cyl))   <span class="sc">+</span></span>
<span id="cb340-3"><a href="data-visualization.html#cb340-3" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="st">&quot;legend&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" alt="" width="672" /></p>
<p><code>category is also ok</code><br />
Discrete mapping works similarly, but some aesthetics (like size) may behave differently and can create awkward legends.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="data-visualization.html#cb341-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb341-2"><a href="data-visualization.html#cb341-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">colour =</span> fl, <span class="at">size=</span>fl))   <span class="sc">+</span></span>
<span id="cb341-3"><a href="data-visualization.html#cb341-3" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="st">&quot;legend&quot;</span>) <span class="co">#size is not ok</span></span></code></pre></div>
<pre><code>## Warning: Using size for a discrete variable is not advised.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" alt="" width="672" /></p>
<ul>
<li>x and y also have associated scales<br />
Scales can transform axes and control tick marks.<br />
This example demonstrates manual x breaks and log2 transformation for y.</li>
</ul>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="data-visualization.html#cb343-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb343-2"><a href="data-visualization.html#cb343-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb343-3"><a href="data-visualization.html#cb343-3" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb343-4"><a href="data-visualization.html#cb343-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&#39;log2&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" alt="" width="672" /></p>
</div>
<div id="change-coordinates" class="section level3 hasAnchor" number="4.5.10">
<h3><span class="header-section-number">4.5.10</span> Change coordinates<a href="data-visualization.html#change-coordinates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Coordinate transformations can change the story of a plot.<br />
Use them intentionally—especially for polar charts, which can look impressive but may distort comparisons.</p>
<ul>
<li>coord_polar<br />
This converts bar charts into a circular layout.<br />
Use with caution: it is harder to compare lengths in polar coordinates.</li>
</ul>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="data-visualization.html#cb344-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb344-2"><a href="data-visualization.html#cb344-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb344-3"><a href="data-visualization.html#cb344-3" tabindex="-1"></a>  <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-181-1.png" alt="" width="672" /></p>
<p>This version changes the polar mapping.<br />
<code>expand_limits()</code> is used to create extra space.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="data-visualization.html#cb345-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb345-2"><a href="data-visualization.html#cb345-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb345-3"><a href="data-visualization.html#cb345-3" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&#39;y&#39;</span>) <span class="sc">+</span> </span>
<span id="cb345-4"><a href="data-visualization.html#cb345-4" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">70</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-182-1.png" alt="" width="672" /></p>
<ul>
<li>specify the scale of coordinate<br />
You can set y limits and breaks.<br />
In practice, avoid truncating axes unless you have a strong reason and clearly indicate it.</li>
</ul>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="data-visualization.html#cb346-1" tabindex="-1"></a><span class="fu">require</span>(scales)</span></code></pre></div>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## Warning: package &#39;scales&#39; was built under R version 4.4.3</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     alpha, rescale</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="data-visualization.html#cb353-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb353-2"><a href="data-visualization.html#cb353-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb353-3"><a href="data-visualization.html#cb353-3" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">01</span>)) </span></code></pre></div>
<pre><code>## Warning: Removed 1 row containing missing values or values outside the scale
## range (`geom_bar()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-183-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="data-visualization.html#cb355-1" tabindex="-1"></a>  <span class="co"># scale_y_continuous(labels = percent) # labels as percents</span></span>
<span id="cb355-2"><a href="data-visualization.html#cb355-2" tabindex="-1"></a>  <span class="co"># +</span></span>
<span id="cb355-3"><a href="data-visualization.html#cb355-3" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels=c(1:7)  )</span></span></code></pre></div>
<ul>
<li>using coord_cartesian <code>zoom in</code><br />
<code>coord_cartesian()</code> zooms without dropping data outside the viewing range.<br />
This is usually preferable to setting scale limits, which can remove data.</li>
</ul>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="data-visualization.html#cb356-1" tabindex="-1"></a><span class="co"># have been deleted </span></span>
<span id="cb356-2"><a href="data-visualization.html#cb356-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb356-3"><a href="data-visualization.html#cb356-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb356-4"><a href="data-visualization.html#cb356-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb356-5"><a href="data-visualization.html#cb356-5" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>( <span class="at">limit=</span><span class="fu">c</span>(<span class="st">&quot;midsize&quot;</span>,<span class="st">&quot;compact&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 146 rows containing non-finite outside the scale range
## (`stat_count()`).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale
## range (`geom_bar()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-184-1.png" alt="" width="672" /></p>
<p>This version zooms into y limits while keeping the underlying data.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="data-visualization.html#cb359-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb359-2"><a href="data-visualization.html#cb359-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span> </span>
<span id="cb359-3"><a href="data-visualization.html#cb359-3" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>( <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb359-4"><a href="data-visualization.html#cb359-4" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>( <span class="at">limit=</span><span class="fu">c</span>(<span class="st">&quot;midsize&quot;</span>,<span class="st">&quot;compact&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 146 rows containing non-finite outside the scale range
## (`stat_count()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-185-1.png" alt="" width="672" /></p>
<ul>
<li>reverse direction of axes<br />
Axis reversal is useful for certain interpretive effects (e.g., ranking charts).<br />
Be careful combining multiple transformations in one plot—clarity first.</li>
</ul>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="data-visualization.html#cb361-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb361-2"><a href="data-visualization.html#cb361-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> displ))<span class="sc">+</span></span>
<span id="cb361-3"><a href="data-visualization.html#cb361-3" tabindex="-1"></a>  </span>
<span id="cb361-4"><a href="data-visualization.html#cb361-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">35</span>,<span class="dv">40</span>)) <span class="sc">+</span> </span>
<span id="cb361-5"><a href="data-visualization.html#cb361-5" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()<span class="sc">+</span></span>
<span id="cb361-6"><a href="data-visualization.html#cb361-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<pre><code>## Scale for y is already present.
## Adding another scale for y, which will replace the existing scale.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-186-1.png" alt="" width="672" /></p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="data-visualization.html#cb363-1" tabindex="-1"></a><span class="co"># log10, sqrt, reverse, scale_y_continuous(trans=&quot;log2&quot;)</span></span></code></pre></div>
</div>
<div id="customize-axis-ticks" class="section level3 hasAnchor" number="4.5.11">
<h3><span class="header-section-number">4.5.11</span> Customize axis ticks<a href="data-visualization.html#customize-axis-ticks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Small axis choices (angle, size, color) can significantly improve readability.<br />
This is especially important when plots are used in slides or printed reports.</p>
<ul>
<li>change axis text font, color, size, angle using theme</li>
</ul>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="data-visualization.html#cb364-1" tabindex="-1"></a><span class="co"># when use theme, scale, guide? </span></span>
<span id="cb364-2"><a href="data-visualization.html#cb364-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb364-3"><a href="data-visualization.html#cb364-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> displ))<span class="sc">+</span></span>
<span id="cb364-4"><a href="data-visualization.html#cb364-4" tabindex="-1"></a>  </span>
<span id="cb364-5"><a href="data-visualization.html#cb364-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">color=</span><span class="st">&quot;#993333&quot;</span>, </span>
<span id="cb364-6"><a href="data-visualization.html#cb364-6" tabindex="-1"></a>                           <span class="at">size=</span><span class="dv">14</span>, <span class="at">angle=</span><span class="dv">45</span>),</span>
<span id="cb364-7"><a href="data-visualization.html#cb364-7" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>, </span>
<span id="cb364-8"><a href="data-visualization.html#cb364-8" tabindex="-1"></a>                           <span class="at">size=</span><span class="dv">7</span>, <span class="at">angle=</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-187-1.png" alt="" width="672" /></p>
<ul>
<li><code>remove aixs ticks and tick labels</code><br />
Sometimes minimal plots are more effective—especially when the audience already understands the scale or when the plot is purely illustrative.</li>
</ul>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="data-visualization.html#cb365-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb365-2"><a href="data-visualization.html#cb365-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> displ))<span class="sc">+</span></span>
<span id="cb365-3"><a href="data-visualization.html#cb365-3" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb365-4"><a href="data-visualization.html#cb365-4" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove x axis tick labels</span></span>
<span id="cb365-5"><a href="data-visualization.html#cb365-5" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove y axis tick labels</span></span>
<span id="cb365-6"><a href="data-visualization.html#cb365-6" tabindex="-1"></a>  <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="co"># Remove ticks</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-188-1.png" alt="" width="672" /></p>
</div>
<div id="flip-and-reverse-plot" class="section level3 hasAnchor" number="4.5.12">
<h3><span class="header-section-number">4.5.12</span> Flip and reverse plot<a href="data-visualization.html#flip-and-reverse-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Flipping and reversing can help match how people naturally read categories (top-to-bottom ranking charts) or fit long labels.</p>
<ul>
<li>boxplot and violin<br />
Violin plots show distributions; boxplots show summary statistics.<br />
Overlaying both gives a compact distribution + summary view.</li>
</ul>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="data-visualization.html#cb366-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg ) <span class="sc">+</span> </span>
<span id="cb366-2"><a href="data-visualization.html#cb366-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>( <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(cyl), <span class="at">y=</span>hwy ,<span class="at">color=</span><span class="fu">as.factor</span>(cyl) ) ,<span class="at">trim =</span> <span class="cn">FALSE</span>,<span class="at">width =</span> <span class="dv">4</span> ) <span class="sc">+</span></span>
<span id="cb366-3"><a href="data-visualization.html#cb366-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(cyl), <span class="at">y=</span>hwy  ), <span class="at">notch =</span> F , <span class="at">width =</span> <span class="fl">0.1</span>)  </span></code></pre></div>
<pre><code>## Warning: `position_dodge()` requires non-overlapping x intervals.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-189-1.png" alt="" width="672" /></p>
<ul>
<li>dotplot<br />
Dotplots can show distributions with less emphasis on smooth density.<br />
Adding a mean and SD summary helps anchor interpretation.</li>
</ul>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="data-visualization.html#cb368-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg ,<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(cyl), <span class="at">y=</span>hwy ) )<span class="sc">+</span> </span>
<span id="cb368-2"><a href="data-visualization.html#cb368-2" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">color =</span><span class="fu">as.factor</span>(cyl), <span class="at">fill =</span> <span class="fu">as.factor</span>(cyl)), </span>
<span id="cb368-3"><a href="data-visualization.html#cb368-3" tabindex="-1"></a>                 <span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>, <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span> </span>
<span id="cb368-4"><a href="data-visualization.html#cb368-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span><span class="st">&quot;mean_sdl&quot;</span> )  </span></code></pre></div>
<pre><code>## Bin width defaults to 1/30 of the range of the data. Pick better
## value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-190-1.png" alt="" width="672" /></p>
<ul>
<li>errorbar<br />
This section builds a grouped summary dataset (<code>df3</code>) and then plots error bars.<br />
Error bars are useful for showing variability around means, but always clarify whether it is SD, SE, or CI.</li>
</ul>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="data-visualization.html#cb370-1" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">data_summary</span>(mpg, <span class="at">varname=</span><span class="st">&quot;hwy&quot;</span>, <span class="at">grps=</span> <span class="fu">c</span>(<span class="st">&quot;cyl&quot;</span> ))</span></code></pre></div>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggpubr&#39;:
## 
##     mutate</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="data-visualization.html#cb379-1" tabindex="-1"></a><span class="fu">head</span>(df3)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">cyl</th>
<th align="right">hwy</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">28.80247</td>
<td align="right">4.515030</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">28.75000</td>
<td align="right">0.500000</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">22.82278</td>
<td align="right">3.685590</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">17.62857</td>
<td align="right">3.262307</td>
</tr>
</tbody>
</table>
<p>This plot uses line + error bars.<br />
Grouping is set via <code>aes(group = 0)</code> as a simple way to connect points in one line.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="data-visualization.html#cb380-1" tabindex="-1"></a><span class="fu">ggplot</span>( df3, <span class="fu">aes</span>(<span class="fu">as.factor</span>(cyl) ,  (hwy), <span class="at">ymin =</span> hwy<span class="sc">-</span>sd, <span class="at">ymax =</span> hwy<span class="sc">+</span>sd)  ) <span class="sc">+</span></span>
<span id="cb380-2"><a href="data-visualization.html#cb380-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">0</span> )) <span class="sc">+</span></span>
<span id="cb380-3"><a href="data-visualization.html#cb380-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(cyl) ),<span class="at">width =</span> <span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-193-1.png" alt="" width="672" /></p>
<p>This version uses bars plus error bars, then flips coordinates for readability.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="data-visualization.html#cb381-1" tabindex="-1"></a><span class="fu">ggplot</span>( df3, <span class="fu">aes</span>(<span class="fu">as.factor</span>(cyl) ,  (hwy), <span class="at">ymin =</span> hwy<span class="sc">-</span>sd, <span class="at">ymax =</span> hwy<span class="sc">+</span>sd)  ) <span class="sc">+</span></span>
<span id="cb381-2"><a href="data-visualization.html#cb381-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(cyl)), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb381-3"><a href="data-visualization.html#cb381-3" tabindex="-1"></a>             <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb381-4"><a href="data-visualization.html#cb381-4" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(   ),<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb381-5"><a href="data-visualization.html#cb381-5" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-194-1.png" alt="" width="672" /></p>
<p><em>using original data</em><br />
Instead of precomputing summaries, you can also rely on <code>stat_summary()</code> directly on raw data.<br />
This is convenient and reduces manual preprocessing.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="data-visualization.html#cb382-1" tabindex="-1"></a>  <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cyl, hwy)) <span class="sc">+</span></span>
<span id="cb382-2"><a href="data-visualization.html#cb382-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;bar&quot;</span>) <span class="sc">+</span></span>
<span id="cb382-3"><a href="data-visualization.html#cb382-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>)</span></code></pre></div>
<pre><code>## No summary function supplied, defaulting to `mean_se()`
## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-195-1.png" alt="" width="672" /></p>
<p><code>flip</code></p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="data-visualization.html#cb384-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb384-2"><a href="data-visualization.html#cb384-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span></span>
<span id="cb384-3"><a href="data-visualization.html#cb384-3" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-196-1.png" alt="" width="672" /></p>
<p><code>reverse</code><br />
Be cautious: reversing y for bar charts can confuse readers unless you have a strong reason.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="data-visualization.html#cb385-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb385-2"><a href="data-visualization.html#cb385-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span></span>
<span id="cb385-3"><a href="data-visualization.html#cb385-3" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-197-1.png" alt="" width="672" /></p>
</div>
<div id="create-stats" class="section level3 hasAnchor" number="4.5.13">
<h3><span class="header-section-number">4.5.13</span> Create stats<a href="data-visualization.html#create-stats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Every geom has a stat. The stat can be overwritten if we use any additional computations.</em></p>
<p>Understanding stats is a major ggplot skill:
- bar charts default to counts (<code>stat_count</code>),
- histograms default to bin counts,
- smoothing defaults to fitting a curve,
- and <code>stat_summary()</code> computes summary measures.</p>
<p>Using original data (counts for <code>cyl</code>).</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="data-visualization.html#cb386-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg ) <span class="sc">+</span> </span>
<span id="cb386-2"><a href="data-visualization.html#cb386-2" tabindex="-1"></a>  <span class="fu">geom_bar</span> (<span class="fu">aes</span>(<span class="at">x =</span> cyl ),<span class="at">position =</span> <span class="st">&#39;identity&#39;</span> ) <span class="co">#using original data</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" alt="" width="672" /></p>
<ul>
<li>using transformed variables<br />
This section sets up data transformation patterns (commented out).<br />
The main idea: if you compute summary statistics yourself, you must use <code>stat='identity'</code> to plot them.</li>
</ul>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="data-visualization.html#cb387-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb387-2"><a href="data-visualization.html#cb387-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb387-3"><a href="data-visualization.html#cb387-3" tabindex="-1"></a><span class="co"># mpg_counted &lt;-    </span></span>
<span id="cb387-4"><a href="data-visualization.html#cb387-4" tabindex="-1"></a><span class="co">#   count(mpg,  cyl  )</span></span>
<span id="cb387-5"><a href="data-visualization.html#cb387-5" tabindex="-1"></a><span class="co"># head(mpg_counted)</span></span>
<span id="cb387-6"><a href="data-visualization.html#cb387-6" tabindex="-1"></a></span>
<span id="cb387-7"><a href="data-visualization.html#cb387-7" tabindex="-1"></a><span class="co"># ggplot(mpg_counted) + </span></span>
<span id="cb387-8"><a href="data-visualization.html#cb387-8" tabindex="-1"></a><span class="co">#   geom_smooth(aes(x =  cyl , y = n)) +</span></span>
<span id="cb387-9"><a href="data-visualization.html#cb387-9" tabindex="-1"></a><span class="co">#   geom_bar (aes(x =  cyl , y = n), stat = &#39;identity&#39;) #using summary data </span></span></code></pre></div>
<ul>
<li>using the <code>after_stat()</code> function inside <code>aes()</code>.<br />
This computes proportions directly inside the plot call, which is very convenient.<br />
Here we plot class proportions instead of raw counts.</li>
</ul>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="data-visualization.html#cb388-1" tabindex="-1"></a><span class="fu">require</span>(scales)</span>
<span id="cb388-2"><a href="data-visualization.html#cb388-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb388-3"><a href="data-visualization.html#cb388-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> <span class="fu">after_stat</span>(  count <span class="sc">/</span> <span class="fu">sum</span>(count))))<span class="sc">+</span></span>
<span id="cb388-4"><a href="data-visualization.html#cb388-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="co"># labels decimals as percents</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-200-1.png" alt="" width="672" /></p>
<ul>
<li>using <code>density</code> geometric in histogram<br />
Overlaying histogram density and a smoothed density curve is a classic approach to show distribution shape.</li>
</ul>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="data-visualization.html#cb389-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb389-2"><a href="data-visualization.html#cb389-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..))<span class="sc">+</span></span>
<span id="cb389-3"><a href="data-visualization.html#cb389-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(  ) </span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-201-1.png" alt="" width="672" /></p>
<ul>
<li>Use <code>stat_summary()</code> to add the mean of <code>hwy</code> for each group<br />
<code>STAT vs. GEOM</code> is a practical concept:</li>
<li><code>geom_*</code> draws shapes,</li>
<li><code>stat_*</code> computes something first (means, SE, CI, etc.) and then draws.</li>
</ul>
<p>This panel shows different summary layers and a 95% interval by setting <code>mult = 1.96</code>.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="data-visualization.html#cb391-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy) ) <span class="sc">+</span> </span>
<span id="cb391-2"><a href="data-visualization.html#cb391-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb391-3"><a href="data-visualization.html#cb391-3" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;pointrange&quot;</span>,</span>
<span id="cb391-4"><a href="data-visualization.html#cb391-4" tabindex="-1"></a>    <span class="at">fun.data =</span> mean_se</span>
<span id="cb391-5"><a href="data-visualization.html#cb391-5" tabindex="-1"></a>  )</span>
<span id="cb391-6"><a href="data-visualization.html#cb391-6" tabindex="-1"></a></span>
<span id="cb391-7"><a href="data-visualization.html#cb391-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy) ) <span class="sc">+</span> </span>
<span id="cb391-8"><a href="data-visualization.html#cb391-8" tabindex="-1"></a>  <span class="fu">stat_summary</span>( </span>
<span id="cb391-9"><a href="data-visualization.html#cb391-9" tabindex="-1"></a>  )</span>
<span id="cb391-10"><a href="data-visualization.html#cb391-10" tabindex="-1"></a></span>
<span id="cb391-11"><a href="data-visualization.html#cb391-11" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy) ) <span class="sc">+</span> </span>
<span id="cb391-12"><a href="data-visualization.html#cb391-12" tabindex="-1"></a>  <span class="fu">stat_summary</span>( </span>
<span id="cb391-13"><a href="data-visualization.html#cb391-13" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb391-14"><a href="data-visualization.html#cb391-14" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb391-15"><a href="data-visualization.html#cb391-15" tabindex="-1"></a>    <span class="at">fun.data =</span> <span class="sc">~</span><span class="fu">mean_se</span>(., <span class="at">mult =</span> <span class="fl">1.96</span>), <span class="co"># Increase `mult` value for bigger interval!</span></span>
<span id="cb391-16"><a href="data-visualization.html#cb391-16" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>,</span>
<span id="cb391-17"><a href="data-visualization.html#cb391-17" tabindex="-1"></a>  )</span>
<span id="cb391-18"><a href="data-visualization.html#cb391-18" tabindex="-1"></a></span>
<span id="cb391-19"><a href="data-visualization.html#cb391-19" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code></pre></div>
<pre><code>## Warning: package &#39;patchwork&#39; was built under R version 4.4.3</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="data-visualization.html#cb393-1" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span>p3</span></code></pre></div>
<pre><code>## No summary function supplied, defaulting to `mean_se()`
## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-202-1.png" alt="" width="672" /></p>
<p>Overlaying the group mean on top of raw points is a great way to show both individual variability and group central tendency.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="data-visualization.html#cb395-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb395-2"><a href="data-visualization.html#cb395-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy), <span class="at">width =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb395-3"><a href="data-visualization.html#cb395-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>( <span class="at">x =</span> class,<span class="at">y =</span> hwy), <span class="at">geom=</span><span class="st">&quot;point&quot;</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">size=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = class, y = hwy), width = 0.2): Ignoring unknown
## parameters: `width`</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-203-1.png" alt="" width="672" /></p>
<p><code>jitter points</code><br />
Jittering helps reduce overplotting when x is discrete.<br />
This is one of the most common practical improvements for categorical scatter plots.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="data-visualization.html#cb398-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb398-2"><a href="data-visualization.html#cb398-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy), <span class="at">width =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb398-3"><a href="data-visualization.html#cb398-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>( <span class="at">x =</span> class,<span class="at">y =</span> hwy), <span class="at">geom=</span><span class="st">&quot;point&quot;</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">size=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-204-1.png" alt="" width="672" /></p>
</div>
<div id="facets" class="section level3 hasAnchor" number="4.5.14">
<h3><span class="header-section-number">4.5.14</span> Facets<a href="data-visualization.html#facets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Facets are one of ggplot2’s strongest features. They let you compare the same relationship across groups.</p>
<p><code>facet_wrap()</code> allows you to place facet side by side into a rectangular layout. <code>facet_grid()</code> allows you to specify different directions and works on two variables.</p>
<ul>
<li>share the axes between the different panels<br />
Shared axes are helpful for direct comparison across panels.</li>
</ul>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="data-visualization.html#cb400-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb400-2"><a href="data-visualization.html#cb400-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb400-3"><a href="data-visualization.html#cb400-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-205-1.png" alt="" width="672" /></p>
<p>Facet grid with rows: <code>drv</code> by row.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="data-visualization.html#cb401-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb401-2"><a href="data-visualization.html#cb401-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb401-3"><a href="data-visualization.html#cb401-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv<span class="sc">~</span> .  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-206-1.png" alt="" width="672" /></p>
<p>Facet grid with columns: <code>drv</code> by column.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="data-visualization.html#cb402-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb402-2"><a href="data-visualization.html#cb402-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb402-3"><a href="data-visualization.html#cb402-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> drv  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-207-1.png" alt="" width="672" /></p>
<p>Facet by two variables at once.<br />
This is powerful but can create many small panels; use only when needed.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="data-visualization.html#cb403-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb403-2"><a href="data-visualization.html#cb403-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb403-3"><a href="data-visualization.html#cb403-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> drv)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-208-1.png" alt="" width="672" /></p>
<ul>
<li>do not share the axes between the different panels<br />
Free scales can make each panel readable but can harm comparability across panels.<br />
Use free scales when ranges differ drastically across groups.</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="data-visualization.html#cb404-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb404-2"><a href="data-visualization.html#cb404-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb404-3"><a href="data-visualization.html#cb404-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> drv , <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-209-1.png" alt="" width="672" /></p>
<p><code>only free y axes</code><br />
This is a compromise: preserve x comparability but allow y to adjust per group.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="data-visualization.html#cb405-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb405-2"><a href="data-visualization.html#cb405-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb405-3"><a href="data-visualization.html#cb405-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> drv , <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-1.png" alt="" width="672" /></p>
<ul>
<li>adjust y scale (space) between the panels<br />
For bar charts with many categories, allowing free space can prevent labels from being squeezed.</li>
</ul>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="data-visualization.html#cb406-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb406-2"><a href="data-visualization.html#cb406-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> manufacturer)) <span class="sc">+</span> </span>
<span id="cb406-3"><a href="data-visualization.html#cb406-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(class <span class="sc">~</span> .)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-211-1.png" alt="" width="672" /></p>
<p>This version frees y spacing and y scale to improve panel readability.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="data-visualization.html#cb407-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb407-2"><a href="data-visualization.html#cb407-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> manufacturer)) <span class="sc">+</span> </span>
<span id="cb407-3"><a href="data-visualization.html#cb407-3" tabindex="-1"></a>  <span class="fu">facet_grid</span>(class <span class="sc">~</span> ., <span class="at">space =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-212-1.png" alt="" width="672" /></p>
<ul>
<li>display by adding multiple variables together<br />
Facetting by both year and drive type in one call.<br />
This is useful when you want a grid of comparisons.</li>
</ul>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="data-visualization.html#cb408-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb408-2"><a href="data-visualization.html#cb408-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span> </span>
<span id="cb408-3"><a href="data-visualization.html#cb408-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(year <span class="sc">~</span> drv)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-213-1.png" alt="" width="672" /></p>
</div>
<div id="theme" class="section level3 hasAnchor" number="4.5.15">
<h3><span class="header-section-number">4.5.15</span> Theme<a href="data-visualization.html#theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Themes control the overall appearance: background, grid lines, fonts, and spacing.</p>
<p><code>theme_minimal</code><br />
Minimal themes are clean for slides and modern reports.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="data-visualization.html#cb409-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb409-2"><a href="data-visualization.html#cb409-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> class)) <span class="sc">+</span> </span>
<span id="cb409-3"><a href="data-visualization.html#cb409-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb409-4"><a href="data-visualization.html#cb409-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-214-1.png" alt="" width="672" /></p>
<p><code>Further adjustments</code><br />
<code>theme_bw</code> is a common default for academic-style plots.<br />
This block demonstrates how to customize facet strip text, captions, and grid lines.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="data-visualization.html#cb410-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb410-2"><a href="data-visualization.html#cb410-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> class)) <span class="sc">+</span> </span>
<span id="cb410-3"><a href="data-visualization.html#cb410-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb410-4"><a href="data-visualization.html#cb410-4" tabindex="-1"></a>  </span>
<span id="cb410-5"><a href="data-visualization.html#cb410-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of car models per class&quot;</span>,</span>
<span id="cb410-6"><a href="data-visualization.html#cb410-6" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: http://fueleconomy.gov&quot;</span>,</span>
<span id="cb410-7"><a href="data-visualization.html#cb410-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb410-8"><a href="data-visualization.html#cb410-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb410-9"><a href="data-visualization.html#cb410-9" tabindex="-1"></a>   </span>
<span id="cb410-10"><a href="data-visualization.html#cb410-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb410-11"><a href="data-visualization.html#cb410-11" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb410-12"><a href="data-visualization.html#cb410-12" tabindex="-1"></a> </span>
<span id="cb410-13"><a href="data-visualization.html#cb410-13" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb410-14"><a href="data-visualization.html#cb410-14" tabindex="-1"></a>    </span>
<span id="cb410-15"><a href="data-visualization.html#cb410-15" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&#39;italic&#39;</span>),</span>
<span id="cb410-16"><a href="data-visualization.html#cb410-16" tabindex="-1"></a>    </span>
<span id="cb410-17"><a href="data-visualization.html#cb410-17" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb410-18"><a href="data-visualization.html#cb410-18" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb410-19"><a href="data-visualization.html#cb410-19" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb410-20"><a href="data-visualization.html#cb410-20" tabindex="-1"></a>    <span class="co"># ,</span></span>
<span id="cb410-21"><a href="data-visualization.html#cb410-21" tabindex="-1"></a>    <span class="co"># panel.ontop = TRUE</span></span>
<span id="cb410-22"><a href="data-visualization.html#cb410-22" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-215-1.png" alt="" width="672" /></p>
<p><code>theme_classic</code><br />
Classic themes remove background grids and look clean for publication.<br />
This example also shows manual fill scales with custom legend labels.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="data-visualization.html#cb411-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb411-2"><a href="data-visualization.html#cb411-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> class, <span class="at">fill =</span> drv)  ,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb411-3"><a href="data-visualization.html#cb411-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb411-4"><a href="data-visualization.html#cb411-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of car models per class&quot;</span>,</span>
<span id="cb411-5"><a href="data-visualization.html#cb411-5" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: http://fueleconomy.gov&quot;</span>,</span>
<span id="cb411-6"><a href="data-visualization.html#cb411-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Number of cars&#39;</span>,</span>
<span id="cb411-7"><a href="data-visualization.html#cb411-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb411-8"><a href="data-visualization.html#cb411-8" tabindex="-1"></a>  </span>
<span id="cb411-9"><a href="data-visualization.html#cb411-9" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Drive Models&quot;</span>,<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey50&quot;</span>,  <span class="st">&quot;grey80&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4w&quot;</span>,<span class="st">&quot;Fw&quot;</span>,<span class="st">&quot;Rw&quot;</span> )) <span class="sc">+</span></span>
<span id="cb411-10"><a href="data-visualization.html#cb411-10" tabindex="-1"></a>  </span>
<span id="cb411-11"><a href="data-visualization.html#cb411-11" tabindex="-1"></a>  <span class="co"># scale_x_continuous(expand = c(0, NA)) + </span></span>
<span id="cb411-12"><a href="data-visualization.html#cb411-12" tabindex="-1"></a>  </span>
<span id="cb411-13"><a href="data-visualization.html#cb411-13" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb411-14"><a href="data-visualization.html#cb411-14" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb411-15"><a href="data-visualization.html#cb411-15" tabindex="-1"></a>    <span class="co"># text = element_text(&#39;Avenir Next Condensed&#39;),</span></span>
<span id="cb411-16"><a href="data-visualization.html#cb411-16" tabindex="-1"></a>    <span class="co"># strip.text = element_text(face = &#39;bold&#39;, hjust = 0),</span></span>
<span id="cb411-17"><a href="data-visualization.html#cb411-17" tabindex="-1"></a>    </span>
<span id="cb411-18"><a href="data-visualization.html#cb411-18" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&#39;italic&#39;</span>),</span>
<span id="cb411-19"><a href="data-visualization.html#cb411-19" tabindex="-1"></a>    </span>
<span id="cb411-20"><a href="data-visualization.html#cb411-20" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb411-21"><a href="data-visualization.html#cb411-21" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb411-22"><a href="data-visualization.html#cb411-22" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb411-23"><a href="data-visualization.html#cb411-23" tabindex="-1"></a>    </span>
<span id="cb411-24"><a href="data-visualization.html#cb411-24" tabindex="-1"></a>    <span class="co"># panel.ontop = TRUE)</span></span>
<span id="cb411-25"><a href="data-visualization.html#cb411-25" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-216-1.png" alt="" width="672" /></p>
<ul>
<li>using ggthemes<br />
Themes from <code>ggthemes</code> provide recognizable styles.<br />
Use them when consistent branding is desired.</li>
</ul>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="data-visualization.html#cb412-1" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb412-2"><a href="data-visualization.html#cb412-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb412-3"><a href="data-visualization.html#cb412-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> class, <span class="at">fill =</span> drv)  ,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb412-4"><a href="data-visualization.html#cb412-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb412-5"><a href="data-visualization.html#cb412-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of car models per class&quot;</span>,</span>
<span id="cb412-6"><a href="data-visualization.html#cb412-6" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: http://fueleconomy.gov&quot;</span>,</span>
<span id="cb412-7"><a href="data-visualization.html#cb412-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Number of cars&#39;</span>,</span>
<span id="cb412-8"><a href="data-visualization.html#cb412-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb412-9"><a href="data-visualization.html#cb412-9" tabindex="-1"></a>  </span>
<span id="cb412-10"><a href="data-visualization.html#cb412-10" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_economist</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-217-1.png" alt="" width="672" /></p>
<ul>
<li>customized theme<br />
This block demonstrates a wide range of theme elements you can control:</li>
<li>legend background, key, position,</li>
<li>panel background and border,</li>
<li>plot background,</li>
<li>axis line, ticks, and text rotation,</li>
<li>facet strip appearance,</li>
<li>panel spacing.</li>
</ul>
<p>In practice, you typically standardize a simpler theme, but it is valuable to see what is possible.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="data-visualization.html#cb413-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg) <span class="sc">+</span> </span>
<span id="cb413-2"><a href="data-visualization.html#cb413-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> class, <span class="at">fill =</span> drv)  ,<span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span> </span>
<span id="cb413-3"><a href="data-visualization.html#cb413-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span> </span>
<span id="cb413-4"><a href="data-visualization.html#cb413-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of car models per class&quot;</span>,</span>
<span id="cb413-5"><a href="data-visualization.html#cb413-5" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;source: http://fueleconomy.gov&quot;</span>,</span>
<span id="cb413-6"><a href="data-visualization.html#cb413-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Number of cars&#39;</span>,</span>
<span id="cb413-7"><a href="data-visualization.html#cb413-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb413-8"><a href="data-visualization.html#cb413-8" tabindex="-1"></a>  </span>
<span id="cb413-9"><a href="data-visualization.html#cb413-9" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb413-10"><a href="data-visualization.html#cb413-10" tabindex="-1"></a>  </span>
<span id="cb413-11"><a href="data-visualization.html#cb413-11" tabindex="-1"></a>    <span class="co"># 1 change legend</span></span>
<span id="cb413-12"><a href="data-visualization.html#cb413-12" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb413-13"><a href="data-visualization.html#cb413-13" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;#fff6c2&quot;</span>,</span>
<span id="cb413-14"><a href="data-visualization.html#cb413-14" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb413-15"><a href="data-visualization.html#cb413-15" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span></span>
<span id="cb413-16"><a href="data-visualization.html#cb413-16" tabindex="-1"></a>    ),</span>
<span id="cb413-17"><a href="data-visualization.html#cb413-17" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;brown&quot;</span>),</span>
<span id="cb413-18"><a href="data-visualization.html#cb413-18" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb413-19"><a href="data-visualization.html#cb413-19" tabindex="-1"></a>    </span>
<span id="cb413-20"><a href="data-visualization.html#cb413-20" tabindex="-1"></a>    <span class="co"># 2 change panel (middle erea) background </span></span>
<span id="cb413-21"><a href="data-visualization.html#cb413-21" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb413-22"><a href="data-visualization.html#cb413-22" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;#005F59&quot;</span>,</span>
<span id="cb413-23"><a href="data-visualization.html#cb413-23" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb413-24"><a href="data-visualization.html#cb413-24" tabindex="-1"></a>    ),</span>
<span id="cb413-25"><a href="data-visualization.html#cb413-25" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(</span>
<span id="cb413-26"><a href="data-visualization.html#cb413-26" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb413-27"><a href="data-visualization.html#cb413-27" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb413-28"><a href="data-visualization.html#cb413-28" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb413-29"><a href="data-visualization.html#cb413-29" tabindex="-1"></a>    ),</span>
<span id="cb413-30"><a href="data-visualization.html#cb413-30" tabindex="-1"></a>    </span>
<span id="cb413-31"><a href="data-visualization.html#cb413-31" tabindex="-1"></a>    <span class="co"># 3 change plot background</span></span>
<span id="cb413-32"><a href="data-visualization.html#cb413-32" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(</span>
<span id="cb413-33"><a href="data-visualization.html#cb413-33" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">&quot;#a1dce9&quot;</span>,</span>
<span id="cb413-34"><a href="data-visualization.html#cb413-34" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb413-35"><a href="data-visualization.html#cb413-35" tabindex="-1"></a>      <span class="at">size =</span> <span class="fl">1.3</span></span>
<span id="cb413-36"><a href="data-visualization.html#cb413-36" tabindex="-1"></a>    ),</span>
<span id="cb413-37"><a href="data-visualization.html#cb413-37" tabindex="-1"></a>    </span>
<span id="cb413-38"><a href="data-visualization.html#cb413-38" tabindex="-1"></a>   </span>
<span id="cb413-39"><a href="data-visualization.html#cb413-39" tabindex="-1"></a>    </span>
<span id="cb413-40"><a href="data-visualization.html#cb413-40" tabindex="-1"></a>    <span class="co"># 4 change axis elements</span></span>
<span id="cb413-41"><a href="data-visualization.html#cb413-41" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>),</span>
<span id="cb413-42"><a href="data-visualization.html#cb413-42" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb413-43"><a href="data-visualization.html#cb413-43" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>),</span>
<span id="cb413-44"><a href="data-visualization.html#cb413-44" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb413-45"><a href="data-visualization.html#cb413-45" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>), </span>
<span id="cb413-46"><a href="data-visualization.html#cb413-46" tabindex="-1"></a>    </span>
<span id="cb413-47"><a href="data-visualization.html#cb413-47" tabindex="-1"></a>    <span class="co"># 5 change facet panel</span></span>
<span id="cb413-48"><a href="data-visualization.html#cb413-48" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb413-49"><a href="data-visualization.html#cb413-49" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb413-50"><a href="data-visualization.html#cb413-50" tabindex="-1"></a>    <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.3</span>, <span class="st">&quot;inch&quot;</span>) </span>
<span id="cb413-51"><a href="data-visualization.html#cb413-51" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-218-1.png" alt="" width="672" /></p>
</div>
<div id="how-to-setup-subscripts-or-superscripts" class="section level3 hasAnchor" number="4.5.16">
<h3><span class="header-section-number">4.5.16</span> How to setup subscripts or superscripts<a href="data-visualization.html#how-to-setup-subscripts-or-superscripts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scientific writing often needs subscripts/superscripts (e.g., CO_2, R²).<br />
This link provides a focused guide for that formatting in R Markdown and ggplot text elements.</p>
<p><a href="https://rpubs.com/Daniel_He/1041883">see here</a></p>
</div>
</div>
<div id="how-to-create-advanced-plots" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> How to create advanced plots<a href="data-visualization.html#how-to-create-advanced-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once you master the basics (data → aes → geoms → scales → themes), advanced plots become much easier.<br />
This link collects more advanced patterns and examples.</p>
<p><a href="https://rpubs.com/Daniel_He/941386">see here</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="deep-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-datavisu.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
