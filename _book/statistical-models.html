<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Statistical models | My Little Handbook</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Statistical models | My Little Handbook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Statistical models | My Little Handbook" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Daniel He" />


<meta name="date" content="2024-03-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-statistics.html"/>
<link rel="next" href="probability.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">My Little Handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>1</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-do-data-wrangling"><i class="fa fa-check"></i><b>1.1</b> How to do data wrangling</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#load-data-and-package"><i class="fa fa-check"></i><b>1.1.1</b> Load data and package</a></li>
<li class="chapter" data-level="1.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#select-certain-rows"><i class="fa fa-check"></i><b>1.1.2</b> Select certain rows</a></li>
<li class="chapter" data-level="1.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#select-certain-columns"><i class="fa fa-check"></i><b>1.1.3</b> Select certain columns</a></li>
<li class="chapter" data-level="1.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#rename-variables"><i class="fa fa-check"></i><b>1.1.4</b> Rename variables</a></li>
<li class="chapter" data-level="1.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-in-ascending-or-descending-order"><i class="fa fa-check"></i><b>1.1.5</b> Sorting in ascending or descending order</a></li>
<li class="chapter" data-level="1.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#transform-variables"><i class="fa fa-check"></i><b>1.1.6</b> Transform variables</a></li>
<li class="chapter" data-level="1.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#working-with-pipes"><i class="fa fa-check"></i><b>1.1.7</b> Working with pipes %&gt;%</a></li>
<li class="chapter" data-level="1.1.8" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wider-long-to-wide"><i class="fa fa-check"></i><b>1.1.8</b> Pivot wider (long to wide)</a></li>
<li class="chapter" data-level="1.1.9" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-longer-wide-to-long"><i class="fa fa-check"></i><b>1.1.9</b> Pivot longer (wide to long)</a></li>
<li class="chapter" data-level="1.1.10" data-path="data-wrangling.html"><a href="data-wrangling.html#separate-columns"><i class="fa fa-check"></i><b>1.1.10</b> Separate columns</a></li>
<li class="chapter" data-level="1.1.11" data-path="data-wrangling.html"><a href="data-wrangling.html#recoderelabel-data"><i class="fa fa-check"></i><b>1.1.11</b> Recode/relabel data</a></li>
<li class="chapter" data-level="1.1.12" data-path="data-wrangling.html"><a href="data-wrangling.html#deduplication"><i class="fa fa-check"></i><b>1.1.12</b> deduplication</a></li>
<li class="chapter" data-level="1.1.13" data-path="data-wrangling.html"><a href="data-wrangling.html#combine-data-sets"><i class="fa fa-check"></i><b>1.1.13</b> Combine data sets</a></li>
<li class="chapter" data-level="1.1.14" data-path="data-wrangling.html"><a href="data-wrangling.html#working-with-character-strings"><i class="fa fa-check"></i><b>1.1.14</b> Working with character strings</a></li>
<li class="chapter" data-level="1.1.15" data-path="data-wrangling.html"><a href="data-wrangling.html#conditional-operations"><i class="fa fa-check"></i><b>1.1.15</b> Conditional operations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-do-aggregation-summarization"><i class="fa fa-check"></i><b>1.2</b> How to do aggregation/ summarization</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#summarization-after-grouping"><i class="fa fa-check"></i><b>1.2.1</b> Summarization after grouping</a></li>
<li class="chapter" data-level="1.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#summarization-with-upgroup"><i class="fa fa-check"></i><b>1.2.2</b> Summarization with upgroup</a></li>
<li class="chapter" data-level="1.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate-new-variables-after-grouping"><i class="fa fa-check"></i><b>1.2.3</b> Mutate new variables after grouping</a></li>
<li class="chapter" data-level="1.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#recode-and-generate-new-variables-then-value-label"><i class="fa fa-check"></i><b>1.2.4</b> Recode and generate new variables, then value label</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#how-to-creat-table-1-with-test"><i class="fa fa-check"></i><b>1.3</b> How to creat table 1 with test</a></li>
<li class="chapter" data-level="1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#imputing-missing-data-with-mice"><i class="fa fa-check"></i><b>1.4</b> Imputing Missing Data with MICE</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>2</b> Machine learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-workflow"><i class="fa fa-check"></i><b>2.1</b> Machine learning workflow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="machine-learning.html"><a href="machine-learning.html#loading-packages-and-datasets"><i class="fa fa-check"></i><b>2.1.1</b> Loading packages and datasets</a></li>
<li class="chapter" data-level="2.1.2" data-path="machine-learning.html"><a href="machine-learning.html#spliting-the-dataset-into-training-and-test-data-sets"><i class="fa fa-check"></i><b>2.1.2</b> Spliting the dataset into training and test data sets</a></li>
<li class="chapter" data-level="2.1.3" data-path="machine-learning.html"><a href="machine-learning.html#implement-data-imputation"><i class="fa fa-check"></i><b>2.1.3</b> Implement data imputation</a></li>
<li class="chapter" data-level="2.1.4" data-path="machine-learning.html"><a href="machine-learning.html#one-hot-endcoding"><i class="fa fa-check"></i><b>2.1.4</b> One-hot-endcoding</a></li>
<li class="chapter" data-level="2.1.5" data-path="machine-learning.html"><a href="machine-learning.html#normalizing-features"><i class="fa fa-check"></i><b>2.1.5</b> Normalizing features</a></li>
<li class="chapter" data-level="2.1.6" data-path="machine-learning.html"><a href="machine-learning.html#plot-features"><i class="fa fa-check"></i><b>2.1.6</b> Plot features</a></li>
<li class="chapter" data-level="2.1.7" data-path="machine-learning.html"><a href="machine-learning.html#recursive-feature-elimination-rfe"><i class="fa fa-check"></i><b>2.1.7</b> <strong>Recursive feature elimination (rfe)</strong></a></li>
<li class="chapter" data-level="2.1.8" data-path="machine-learning.html"><a href="machine-learning.html#training-a-model-multivariate-adaptive-regression-splines-mars"><i class="fa fa-check"></i><b>2.1.8</b> Training a model <code>Multivariate Adaptive Regression Splines (MARS)</code></a></li>
<li class="chapter" data-level="2.1.9" data-path="machine-learning.html"><a href="machine-learning.html#prepare-the-test-data-set"><i class="fa fa-check"></i><b>2.1.9</b> Prepare the test data set</a></li>
<li class="chapter" data-level="2.1.10" data-path="machine-learning.html"><a href="machine-learning.html#prediction-uisng-testdata"><i class="fa fa-check"></i><b>2.1.10</b> Prediction uisng testdata</a></li>
<li class="chapter" data-level="2.1.11" data-path="machine-learning.html"><a href="machine-learning.html#compute-confusion-matrix"><i class="fa fa-check"></i><b>2.1.11</b> Compute confusion matrix</a></li>
<li class="chapter" data-level="2.1.12" data-path="machine-learning.html"><a href="machine-learning.html#tuning-hyperparameter-to-optimize-the-model"><i class="fa fa-check"></i><b>2.1.12</b> Tuning hyperparameter to optimize the model</a></li>
<li class="chapter" data-level="2.1.13" data-path="machine-learning.html"><a href="machine-learning.html#other-marchine-learning-algorithms"><i class="fa fa-check"></i><b>2.1.13</b> Other marchine learning algorithms</a></li>
<li class="chapter" data-level="2.1.14" data-path="machine-learning.html"><a href="machine-learning.html#comparisons-of-different-models"><i class="fa fa-check"></i><b>2.1.14</b> Comparisons of different models</a></li>
<li class="chapter" data-level="2.1.15" data-path="machine-learning.html"><a href="machine-learning.html#plot-comparisons-of-models"><i class="fa fa-check"></i><b>2.1.15</b> Plot comparisons of models</a></li>
<li class="chapter" data-level="2.1.16" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-predictions-from-multiple-models"><i class="fa fa-check"></i><b>2.1.16</b> Ensemble predictions from multiple models</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="machine-learning.html"><a href="machine-learning.html#knn-classifier"><i class="fa fa-check"></i><b>2.2</b> KNN Classifier</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="machine-learning.html"><a href="machine-learning.html#splitting-data"><i class="fa fa-check"></i><b>2.2.1</b> Splitting data</a></li>
<li class="chapter" data-level="2.2.2" data-path="machine-learning.html"><a href="machine-learning.html#creating-knn-model"><i class="fa fa-check"></i><b>2.2.2</b> Creating KNN model</a></li>
<li class="chapter" data-level="2.2.3" data-path="machine-learning.html"><a href="machine-learning.html#model-evaluation"><i class="fa fa-check"></i><b>2.2.3</b> Model Evaluation</a></li>
<li class="chapter" data-level="2.2.4" data-path="machine-learning.html"><a href="machine-learning.html#calculate-accuracy-with-different-k"><i class="fa fa-check"></i><b>2.2.4</b> Calculate accuracy with different K</a></li>
<li class="chapter" data-level="2.2.5" data-path="machine-learning.html"><a href="machine-learning.html#optimization"><i class="fa fa-check"></i><b>2.2.5</b> Optimization</a></li>
<li class="chapter" data-level="2.2.6" data-path="machine-learning.html"><a href="machine-learning.html#visualization"><i class="fa fa-check"></i><b>2.2.6</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="machine-learning.html"><a href="machine-learning.html#knn-regression"><i class="fa fa-check"></i><b>2.3</b> KNN regression</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="machine-learning.html"><a href="machine-learning.html#data-exploring"><i class="fa fa-check"></i><b>2.3.1</b> Data exploring</a></li>
<li class="chapter" data-level="2.3.2" data-path="machine-learning.html"><a href="machine-learning.html#prepareing-data"><i class="fa fa-check"></i><b>2.3.2</b> Prepareing data</a></li>
<li class="chapter" data-level="2.3.3" data-path="machine-learning.html"><a href="machine-learning.html#creating-model"><i class="fa fa-check"></i><b>2.3.3</b> Creating model</a></li>
<li class="chapter" data-level="2.3.4" data-path="machine-learning.html"><a href="machine-learning.html#evaluation"><i class="fa fa-check"></i><b>2.3.4</b> Evaluation</a></li>
<li class="chapter" data-level="2.3.5" data-path="machine-learning.html"><a href="machine-learning.html#optimization-1"><i class="fa fa-check"></i><b>2.3.5</b> Optimization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>3</b> Deep learning</a>
<ul>
<li class="chapter" data-level="3.1" data-path="deep-learning.html"><a href="deep-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>3.1</b> Deep neural network</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="deep-learning.html"><a href="deep-learning.html#load-data"><i class="fa fa-check"></i><b>3.1.1</b> Load data</a></li>
<li class="chapter" data-level="3.1.2" data-path="deep-learning.html"><a href="deep-learning.html#process-data-and-variable"><i class="fa fa-check"></i><b>3.1.2</b> Process data and variable</a></li>
<li class="chapter" data-level="3.1.3" data-path="deep-learning.html"><a href="deep-learning.html#split-data-into-training-and-test-datasets"><i class="fa fa-check"></i><b>3.1.3</b> Split data into training and test datasets</a></li>
<li class="chapter" data-level="3.1.4" data-path="deep-learning.html"><a href="deep-learning.html#creating-neural-network-model"><i class="fa fa-check"></i><b>3.1.4</b> Creating neural network model</a></li>
<li class="chapter" data-level="3.1.5" data-path="deep-learning.html"><a href="deep-learning.html#evaluation-1"><i class="fa fa-check"></i><b>3.1.5</b> Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="deep-learning.html"><a href="deep-learning.html#deep-neural-networks-for-regression"><i class="fa fa-check"></i><b>3.2</b> Deep neural networks for regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="deep-learning.html"><a href="deep-learning.html#loading-packages-and-data-sets"><i class="fa fa-check"></i><b>3.2.1</b> Loading packages and data sets</a></li>
<li class="chapter" data-level="3.2.2" data-path="deep-learning.html"><a href="deep-learning.html#convert-dataframe-to-matrix-without-dimnames"><i class="fa fa-check"></i><b>3.2.2</b> Convert dataframe to matrix without dimnames</a></li>
<li class="chapter" data-level="3.2.3" data-path="deep-learning.html"><a href="deep-learning.html#spiting-training-and-test-data"><i class="fa fa-check"></i><b>3.2.3</b> Spiting training and test data</a></li>
<li class="chapter" data-level="3.2.4" data-path="deep-learning.html"><a href="deep-learning.html#normalizing-xtrain-and-xtest-data"><i class="fa fa-check"></i><b>3.2.4</b> Normalizing <code>xtrain</code> and <code>xtest</code> data</a></li>
<li class="chapter" data-level="3.2.5" data-path="deep-learning.html"><a href="deep-learning.html#creating-the-model"><i class="fa fa-check"></i><b>3.2.5</b> Creating the model</a></li>
<li class="chapter" data-level="3.2.6" data-path="deep-learning.html"><a href="deep-learning.html#compiling-the-model-1"><i class="fa fa-check"></i><b>3.2.6</b> Compiling the model</a></li>
<li class="chapter" data-level="3.2.7" data-path="deep-learning.html"><a href="deep-learning.html#fitting-the-model"><i class="fa fa-check"></i><b>3.2.7</b> Fitting the model</a></li>
<li class="chapter" data-level="3.2.8" data-path="deep-learning.html"><a href="deep-learning.html#plot-the-training-process"><i class="fa fa-check"></i><b>3.2.8</b> Plot the training process</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="deep-learning.html"><a href="deep-learning.html#convolutional-neural-netwrok"><i class="fa fa-check"></i><b>3.3</b> Convolutional neural netwrok</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="deep-learning.html"><a href="deep-learning.html#import-library"><i class="fa fa-check"></i><b>3.3.1</b> Import library</a></li>
<li class="chapter" data-level="3.3.2" data-path="deep-learning.html"><a href="deep-learning.html#importing-the-data"><i class="fa fa-check"></i><b>3.3.2</b> Importing the data</a></li>
<li class="chapter" data-level="3.3.3" data-path="deep-learning.html"><a href="deep-learning.html#preparing-the-data"><i class="fa fa-check"></i><b>3.3.3</b> preparing the data</a></li>
<li class="chapter" data-level="3.3.4" data-path="deep-learning.html"><a href="deep-learning.html#creating-the-model-1"><i class="fa fa-check"></i><b>3.3.4</b> Creating the model</a></li>
<li class="chapter" data-level="3.3.5" data-path="deep-learning.html"><a href="deep-learning.html#training"><i class="fa fa-check"></i><b>3.3.5</b> Training</a></li>
<li class="chapter" data-level="3.3.6" data-path="deep-learning.html"><a href="deep-learning.html#evaluating-the-accuracy"><i class="fa fa-check"></i><b>3.3.6</b> Evaluating the accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>4</b> Data visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization.html"><a href="data-visualization.html#data-visualization-introduction"><i class="fa fa-check"></i><b>4.1</b> Data visualization introduction</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data-visualization.html"><a href="data-visualization.html#summarization"><i class="fa fa-check"></i><b>4.1.1</b> Summarization</a></li>
<li class="chapter" data-level="4.1.2" data-path="data-visualization.html"><a href="data-visualization.html#explore-missing-values"><i class="fa fa-check"></i><b>4.1.2</b> Explore missing values</a></li>
<li class="chapter" data-level="4.1.3" data-path="data-visualization.html"><a href="data-visualization.html#add-statistical-test"><i class="fa fa-check"></i><b>4.1.3</b> Add statistical test</a></li>
<li class="chapter" data-level="4.1.4" data-path="data-visualization.html"><a href="data-visualization.html#add-texts-to-dots"><i class="fa fa-check"></i><b>4.1.4</b> Add texts to dots</a></li>
<li class="chapter" data-level="4.1.5" data-path="data-visualization.html"><a href="data-visualization.html#set-the-legend"><i class="fa fa-check"></i><b>4.1.5</b> Set the legend</a></li>
<li class="chapter" data-level="4.1.6" data-path="data-visualization.html"><a href="data-visualization.html#create-a-panel-of-plots"><i class="fa fa-check"></i><b>4.1.6</b> Create a panel of plots</a></li>
<li class="chapter" data-level="4.1.7" data-path="data-visualization.html"><a href="data-visualization.html#plots-in-regression"><i class="fa fa-check"></i><b>4.1.7</b> Plots in regression</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>4.2</b> Scatter plot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-visualization.html"><a href="data-visualization.html#create-a-empty-canvas"><i class="fa fa-check"></i><b>4.2.1</b> Create a empty canvas</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-visualization.html"><a href="data-visualization.html#add-a-layergeom-of-points-to-the-canvas"><i class="fa fa-check"></i><b>4.2.2</b> Add a layer/geom of <code>points</code> to the canvas</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-visualization.html"><a href="data-visualization.html#add-another-aesthetic"><i class="fa fa-check"></i><b>4.2.3</b> Add another aesthetic</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-visualization.html"><a href="data-visualization.html#add-other-aesthetic"><i class="fa fa-check"></i><b>4.2.4</b> Add other aesthetic</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-visualization.html"><a href="data-visualization.html#bar-chart"><i class="fa fa-check"></i><b>4.3</b> Bar chart</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-visualization.html"><a href="data-visualization.html#grouped-bar-chart"><i class="fa fa-check"></i><b>4.3.1</b> Grouped bar chart</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-visualization.html"><a href="data-visualization.html#line-charts"><i class="fa fa-check"></i><b>4.4</b> Line charts</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-visualization.html"><a href="data-visualization.html#grouped-by-colour-variable"><i class="fa fa-check"></i><b>4.4.1</b> Grouped by <code>colour variable</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-visualization.html"><a href="data-visualization.html#multiple-aesthetics"><i class="fa fa-check"></i><b>4.4.2</b> Multiple aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-visualization.html"><a href="data-visualization.html#ggplot2-parameters"><i class="fa fa-check"></i><b>4.5</b> ggplot2 parameters</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-visualization.html"><a href="data-visualization.html#components-of-plot"><i class="fa fa-check"></i><b>4.5.1</b> Components of plot</a></li>
<li class="chapter" data-level="4.5.2" data-path="data-visualization.html"><a href="data-visualization.html#create-main-title-axis-labels-caption"><i class="fa fa-check"></i><b>4.5.2</b> Create main title, axis labels, caption</a></li>
<li class="chapter" data-level="4.5.3" data-path="data-visualization.html"><a href="data-visualization.html#create-legend-title-position"><i class="fa fa-check"></i><b>4.5.3</b> Create legend title, position</a></li>
<li class="chapter" data-level="4.5.4" data-path="data-visualization.html"><a href="data-visualization.html#change-plot-colors"><i class="fa fa-check"></i><b>4.5.4</b> Change plot colors</a></li>
<li class="chapter" data-level="4.5.5" data-path="data-visualization.html"><a href="data-visualization.html#change-points-shapes-transparent-and-size"><i class="fa fa-check"></i><b>4.5.5</b> Change points shapes, transparent and size</a></li>
<li class="chapter" data-level="4.5.6" data-path="data-visualization.html"><a href="data-visualization.html#change-bars-position"><i class="fa fa-check"></i><b>4.5.6</b> Change bars position</a></li>
<li class="chapter" data-level="4.5.7" data-path="data-visualization.html"><a href="data-visualization.html#add-text-annotations"><i class="fa fa-check"></i><b>4.5.7</b> Add text annotations</a></li>
<li class="chapter" data-level="4.5.8" data-path="data-visualization.html"><a href="data-visualization.html#add-a-line-that-separates-points"><i class="fa fa-check"></i><b>4.5.8</b> Add a line that (separates points)</a></li>
<li class="chapter" data-level="4.5.9" data-path="data-visualization.html"><a href="data-visualization.html#using-scale_-function"><i class="fa fa-check"></i><b>4.5.9</b> Using scale_ function</a></li>
<li class="chapter" data-level="4.5.10" data-path="data-visualization.html"><a href="data-visualization.html#change-coordinates"><i class="fa fa-check"></i><b>4.5.10</b> Change coordinates</a></li>
<li class="chapter" data-level="4.5.11" data-path="data-visualization.html"><a href="data-visualization.html#customize-axis-ticks"><i class="fa fa-check"></i><b>4.5.11</b> Customize axis ticks</a></li>
<li class="chapter" data-level="4.5.12" data-path="data-visualization.html"><a href="data-visualization.html#flip-and-reverse-plot"><i class="fa fa-check"></i><b>4.5.12</b> Flip and reverse plot</a></li>
<li class="chapter" data-level="4.5.13" data-path="data-visualization.html"><a href="data-visualization.html#create-stats"><i class="fa fa-check"></i><b>4.5.13</b> Create stats</a></li>
<li class="chapter" data-level="4.5.14" data-path="data-visualization.html"><a href="data-visualization.html#facets"><i class="fa fa-check"></i><b>4.5.14</b> Facets</a></li>
<li class="chapter" data-level="4.5.15" data-path="data-visualization.html"><a href="data-visualization.html#theme"><i class="fa fa-check"></i><b>4.5.15</b> Theme</a></li>
<li class="chapter" data-level="4.5.16" data-path="data-visualization.html"><a href="data-visualization.html#how-to-setup-subscripts-or-superscripts"><i class="fa fa-check"></i><b>4.5.16</b> How to setup subscripts or superscripts</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-visualization.html"><a href="data-visualization.html#how-to-create-advanced-plots"><i class="fa fa-check"></i><b>4.6</b> How to create advanced plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>5</b> Basic statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basic-statistics.html"><a href="basic-statistics.html#the-essentials-of-r"><i class="fa fa-check"></i><b>5.1</b> The essentials of R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="basic-statistics.html"><a href="basic-statistics.html#manipulation-of-vector"><i class="fa fa-check"></i><b>5.1.1</b> Manipulation of vector</a></li>
<li class="chapter" data-level="5.1.2" data-path="basic-statistics.html"><a href="basic-statistics.html#generate-sequence-or-repeted-sequece"><i class="fa fa-check"></i><b>5.1.2</b> Generate sequence or repeted sequece</a></li>
<li class="chapter" data-level="5.1.3" data-path="basic-statistics.html"><a href="basic-statistics.html#get-directory-and-write-data-out-and-in"><i class="fa fa-check"></i><b>5.1.3</b> Get directory and write data out and in</a></li>
<li class="chapter" data-level="5.1.4" data-path="basic-statistics.html"><a href="basic-statistics.html#function"><i class="fa fa-check"></i><b>5.1.4</b> Function</a></li>
<li class="chapter" data-level="5.1.5" data-path="basic-statistics.html"><a href="basic-statistics.html#plot"><i class="fa fa-check"></i><b>5.1.5</b> Plot</a></li>
<li class="chapter" data-level="5.1.6" data-path="basic-statistics.html"><a href="basic-statistics.html#class-of-dataframe"><i class="fa fa-check"></i><b>5.1.6</b> Class of dataframe</a></li>
<li class="chapter" data-level="5.1.7" data-path="basic-statistics.html"><a href="basic-statistics.html#generate-new-variable-for-dataframe-character"><i class="fa fa-check"></i><b>5.1.7</b> Generate new variable for dataframe (character)</a></li>
<li class="chapter" data-level="5.1.8" data-path="basic-statistics.html"><a href="basic-statistics.html#create-a-new-dataframe-using-rnorm---random-number-from-distribution"><i class="fa fa-check"></i><b>5.1.8</b> Create a new dataframe using ‘rnorm’ - random number from distribution</a></li>
<li class="chapter" data-level="5.1.9" data-path="basic-statistics.html"><a href="basic-statistics.html#left-join-two-dataframes"><i class="fa fa-check"></i><b>5.1.9</b> Left join two dataframes</a></li>
<li class="chapter" data-level="5.1.10" data-path="basic-statistics.html"><a href="basic-statistics.html#select-variables"><i class="fa fa-check"></i><b>5.1.10</b> Select variables</a></li>
<li class="chapter" data-level="5.1.11" data-path="basic-statistics.html"><a href="basic-statistics.html#filter-observations"><i class="fa fa-check"></i><b>5.1.11</b> Filter observations</a></li>
<li class="chapter" data-level="5.1.12" data-path="basic-statistics.html"><a href="basic-statistics.html#append-rows"><i class="fa fa-check"></i><b>5.1.12</b> Append rows</a></li>
<li class="chapter" data-level="5.1.13" data-path="basic-statistics.html"><a href="basic-statistics.html#create-new-variables-instead-of-old-variables"><i class="fa fa-check"></i><b>5.1.13</b> Create new variables instead of old variables</a></li>
<li class="chapter" data-level="5.1.14" data-path="basic-statistics.html"><a href="basic-statistics.html#summarise-statistics"><i class="fa fa-check"></i><b>5.1.14</b> summarise statistics</a></li>
<li class="chapter" data-level="5.1.15" data-path="basic-statistics.html"><a href="basic-statistics.html#group-dataframe-then-summarise-statistics"><i class="fa fa-check"></i><b>5.1.15</b> Group dataframe then summarise statistics</a></li>
<li class="chapter" data-level="5.1.16" data-path="basic-statistics.html"><a href="basic-statistics.html#ungroup-then-summarise-statistics"><i class="fa fa-check"></i><b>5.1.16</b> Ungroup then summarise statistics</a></li>
<li class="chapter" data-level="5.1.17" data-path="basic-statistics.html"><a href="basic-statistics.html#summary-linear-regression-model"><i class="fa fa-check"></i><b>5.1.17</b> Summary linear regression model</a></li>
<li class="chapter" data-level="5.1.18" data-path="basic-statistics.html"><a href="basic-statistics.html#create-frequency-table"><i class="fa fa-check"></i><b>5.1.18</b> Create frequency table</a></li>
<li class="chapter" data-level="5.1.19" data-path="basic-statistics.html"><a href="basic-statistics.html#value-and-variable-label"><i class="fa fa-check"></i><b>5.1.19</b> Value and variable label</a></li>
<li class="chapter" data-level="5.1.20" data-path="basic-statistics.html"><a href="basic-statistics.html#recode-a-variable"><i class="fa fa-check"></i><b>5.1.20</b> Recode a variable</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basic-statistics.html"><a href="basic-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>5.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.3" data-path="basic-statistics.html"><a href="basic-statistics.html#common-statistical-distribution"><i class="fa fa-check"></i><b>5.3</b> Common statistical distribution</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-models.html"><a href="statistical-models.html"><i class="fa fa-check"></i><b>6</b> Statistical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-models.html"><a href="statistical-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistical-models.html"><a href="statistical-models.html#linear-regeression-assumptions"><i class="fa fa-check"></i><b>6.1.1</b> Linear regeression assumptions</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistical-models.html"><a href="statistical-models.html#population-regression-function"><i class="fa fa-check"></i><b>6.1.2</b> Population regression function</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistical-models.html"><a href="statistical-models.html#population-regression-model"><i class="fa fa-check"></i><b>6.1.3</b> Population regression model</a></li>
<li class="chapter" data-level="6.1.4" data-path="statistical-models.html"><a href="statistical-models.html#sample-regression-model"><i class="fa fa-check"></i><b>6.1.4</b> Sample regression model</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistical-models.html"><a href="statistical-models.html#solve-hatbeta_1hatbeta_2-and-variance"><i class="fa fa-check"></i><b>6.1.5</b> Solve <span class="math inline">\(\hat{\beta_1},\hat{\beta_2}\)</span> and variance</a></li>
<li class="chapter" data-level="6.1.6" data-path="statistical-models.html"><a href="statistical-models.html#calculate-the-variance-hatsigma2-of-error-e_i"><i class="fa fa-check"></i><b>6.1.6</b> Calculate the variance <span class="math inline">\(\hat{\sigma}^2\)</span> of error <span class="math inline">\(e_i\)</span></a></li>
<li class="chapter" data-level="6.1.7" data-path="statistical-models.html"><a href="statistical-models.html#sum-of-squares-decomposition"><i class="fa fa-check"></i><b>6.1.7</b> Sum of squares decomposition</a></li>
<li class="chapter" data-level="6.1.8" data-path="statistical-models.html"><a href="statistical-models.html#coefficient-of-determination-r2-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.1.8</b> Coefficient of determination <span class="math inline">\(R^2\)</span> and goodness of fit</a></li>
<li class="chapter" data-level="6.1.9" data-path="statistical-models.html"><a href="statistical-models.html#test-of-regression-coefficients"><i class="fa fa-check"></i><b>6.1.9</b> Test of regression coefficients</a></li>
<li class="chapter" data-level="6.1.10" data-path="statistical-models.html"><a href="statistical-models.html#statistical-test-of-model"><i class="fa fa-check"></i><b>6.1.10</b> Statistical test of model</a></li>
<li class="chapter" data-level="6.1.11" data-path="statistical-models.html"><a href="statistical-models.html#mean-prediction"><i class="fa fa-check"></i><b>6.1.11</b> Mean prediction</a></li>
<li class="chapter" data-level="6.1.12" data-path="statistical-models.html"><a href="statistical-models.html#individual-prediction"><i class="fa fa-check"></i><b>6.1.12</b> Individual prediction</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistical-models.html"><a href="statistical-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.2</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="statistical-models.html"><a href="statistical-models.html#matrix-format"><i class="fa fa-check"></i><b>6.2.1</b> Matrix format</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistical-models.html"><a href="statistical-models.html#variance-covariance-matrix-of-random-errors"><i class="fa fa-check"></i><b>6.2.2</b> Variance covariance matrix of random errors</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistical-models.html"><a href="statistical-models.html#minimize-q-sumy-haty2"><i class="fa fa-check"></i><b>6.2.3</b> Minimize Q, <span class="math inline">\(\sum{(y-\hat{y})^2}\)</span></a></li>
<li class="chapter" data-level="6.2.4" data-path="statistical-models.html"><a href="statistical-models.html#solve-hatbeta-by-derivation"><i class="fa fa-check"></i><b>6.2.4</b> Solve <span class="math inline">\(\hat{\beta}\)</span> by derivation</a></li>
<li class="chapter" data-level="6.2.5" data-path="statistical-models.html"><a href="statistical-models.html#solve-hatsigma_beta2"><i class="fa fa-check"></i><b>6.2.5</b> Solve <span class="math inline">\(\hat{\sigma_\beta}^2\)</span></a></li>
<li class="chapter" data-level="6.2.6" data-path="statistical-models.html"><a href="statistical-models.html#solve-s2mathbfhatbeta"><i class="fa fa-check"></i><b>6.2.6</b> Solve <span class="math inline">\(S^2(\mathbf{\hat{\beta}})\)</span></a></li>
<li class="chapter" data-level="6.2.7" data-path="statistical-models.html"><a href="statistical-models.html#sum-of-squares-decomposition-matrix-format"><i class="fa fa-check"></i><b>6.2.7</b> Sum of squares decomposition (matrix format)</a></li>
<li class="chapter" data-level="6.2.8" data-path="statistical-models.html"><a href="statistical-models.html#determination-coefficient-r2-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.2.8</b> Determination coefficient <span class="math inline">\(R^2\)</span> and goodness of fit</a></li>
<li class="chapter" data-level="6.2.9" data-path="statistical-models.html"><a href="statistical-models.html#test-of-regression-coefficients-1"><i class="fa fa-check"></i><b>6.2.9</b> Test of regression coefficients</a></li>
<li class="chapter" data-level="6.2.10" data-path="statistical-models.html"><a href="statistical-models.html#test-of-model"><i class="fa fa-check"></i><b>6.2.10</b> Test of model</a></li>
<li class="chapter" data-level="6.2.11" data-path="statistical-models.html"><a href="statistical-models.html#mean-prediction-1"><i class="fa fa-check"></i><b>6.2.11</b> Mean prediction</a></li>
<li class="chapter" data-level="6.2.12" data-path="statistical-models.html"><a href="statistical-models.html#individual-prediction-1"><i class="fa fa-check"></i><b>6.2.12</b> Individual prediction</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="statistical-models.html"><a href="statistical-models.html#multiple-linear-regression-practice"><i class="fa fa-check"></i><b>6.3</b> Multiple linear regression practice</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="statistical-models.html"><a href="statistical-models.html#loading-and-describing-data"><i class="fa fa-check"></i><b>6.3.1</b> Loading and describing data</a></li>
<li class="chapter" data-level="6.3.2" data-path="statistical-models.html"><a href="statistical-models.html#create-table-1"><i class="fa fa-check"></i><b>6.3.2</b> Create table 1</a></li>
<li class="chapter" data-level="6.3.3" data-path="statistical-models.html"><a href="statistical-models.html#missingness-checking"><i class="fa fa-check"></i><b>6.3.3</b> Missingness checking</a></li>
<li class="chapter" data-level="6.3.4" data-path="statistical-models.html"><a href="statistical-models.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.3.4</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.3.5" data-path="statistical-models.html"><a href="statistical-models.html#transformations"><i class="fa fa-check"></i><b>6.3.5</b> Transformations</a></li>
<li class="chapter" data-level="6.3.6" data-path="statistical-models.html"><a href="statistical-models.html#data-imputation-and-normalization"><i class="fa fa-check"></i><b>6.3.6</b> Data imputation and normalization</a></li>
<li class="chapter" data-level="6.3.7" data-path="statistical-models.html"><a href="statistical-models.html#generate-dummy-variables"><i class="fa fa-check"></i><b>6.3.7</b> Generate dummy variables</a></li>
<li class="chapter" data-level="6.3.8" data-path="statistical-models.html"><a href="statistical-models.html#spliting-data-into-trainning-data-and-test-data"><i class="fa fa-check"></i><b>6.3.8</b> Spliting data into trainning data and test data</a></li>
<li class="chapter" data-level="6.3.9" data-path="statistical-models.html"><a href="statistical-models.html#step-regression"><i class="fa fa-check"></i><b>6.3.9</b> Step regression</a></li>
<li class="chapter" data-level="6.3.10" data-path="statistical-models.html"><a href="statistical-models.html#create-a-model-after-selecting-variables"><i class="fa fa-check"></i><b>6.3.10</b> Create a model after selecting variables</a></li>
<li class="chapter" data-level="6.3.11" data-path="statistical-models.html"><a href="statistical-models.html#multicollinearity-checking"><i class="fa fa-check"></i><b>6.3.11</b> Multicollinearity checking</a></li>
<li class="chapter" data-level="6.3.12" data-path="statistical-models.html"><a href="statistical-models.html#plot-model-to-check-assumptions"><i class="fa fa-check"></i><b>6.3.12</b> Plot model to check assumptions</a></li>
<li class="chapter" data-level="6.3.13" data-path="statistical-models.html"><a href="statistical-models.html#add-polynomial-of-quadratic-term"><i class="fa fa-check"></i><b>6.3.13</b> Add polynomial of quadratic term</a></li>
<li class="chapter" data-level="6.3.14" data-path="statistical-models.html"><a href="statistical-models.html#add-interaction-terms"><i class="fa fa-check"></i><b>6.3.14</b> Add interaction terms</a></li>
<li class="chapter" data-level="6.3.15" data-path="statistical-models.html"><a href="statistical-models.html#robust-regression"><i class="fa fa-check"></i><b>6.3.15</b> Robust regression</a></li>
<li class="chapter" data-level="6.3.16" data-path="statistical-models.html"><a href="statistical-models.html#create-a-model-before-transforming-data"><i class="fa fa-check"></i><b>6.3.16</b> Create a model before transforming data</a></li>
<li class="chapter" data-level="6.3.17" data-path="statistical-models.html"><a href="statistical-models.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>6.3.17</b> K-fold cross validation</a></li>
<li class="chapter" data-level="6.3.18" data-path="statistical-models.html"><a href="statistical-models.html#nonnest-models-comparisons"><i class="fa fa-check"></i><b>6.3.18</b> Nonnest models comparisons</a></li>
<li class="chapter" data-level="6.3.19" data-path="statistical-models.html"><a href="statistical-models.html#create-forest-plot-for-coefficients"><i class="fa fa-check"></i><b>6.3.19</b> Create forest plot for coefficients</a></li>
<li class="chapter" data-level="6.3.20" data-path="statistical-models.html"><a href="statistical-models.html#relative-importance"><i class="fa fa-check"></i><b>6.3.20</b> Relative Importance</a></li>
<li class="chapter" data-level="6.3.21" data-path="statistical-models.html"><a href="statistical-models.html#model-prediction"><i class="fa fa-check"></i><b>6.3.21</b> Model prediction</a></li>
<li class="chapter" data-level="6.3.22" data-path="statistical-models.html"><a href="statistical-models.html#external-data-validation"><i class="fa fa-check"></i><b>6.3.22</b> External data validation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="statistical-models.html"><a href="statistical-models.html#variable-selection"><i class="fa fa-check"></i><b>6.4</b> Variable selection</a></li>
<li class="chapter" data-level="6.5" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-theory"><i class="fa fa-check"></i><b>6.5</b> Linear mixed model theory</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="statistical-models.html"><a href="statistical-models.html#matrix-format-1"><i class="fa fa-check"></i><b>6.5.1</b> Matrix format</a></li>
<li class="chapter" data-level="6.5.2" data-path="statistical-models.html"><a href="statistical-models.html#exmaple-reducing-the-work-stress-of-nurses"><i class="fa fa-check"></i><b>6.5.2</b> Exmaple: reducing the work stress of nurses</a></li>
<li class="chapter" data-level="6.5.3" data-path="statistical-models.html"><a href="statistical-models.html#dependent-variable-y"><i class="fa fa-check"></i><b>6.5.3</b> Dependent variable, <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="6.5.4" data-path="statistical-models.html"><a href="statistical-models.html#independent-variables-fixed-effects-xs"><i class="fa fa-check"></i><b>6.5.4</b> Independent variables (fixed effects), <span class="math inline">\(Xs\)</span></a></li>
<li class="chapter" data-level="6.5.5" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficients-hatbeta"><i class="fa fa-check"></i><b>6.5.5</b> Fixed effect coefficients, <span class="math inline">\(\hat{\beta}\)</span></a></li>
<li class="chapter" data-level="6.5.6" data-path="statistical-models.html"><a href="statistical-models.html#variance--covariance-matrix-of-hatbeta"><i class="fa fa-check"></i><b>6.5.6</b> Variance- covariance matrix of <span class="math inline">\(\hat{\beta}\)</span></a></li>
<li class="chapter" data-level="6.5.7" data-path="statistical-models.html"><a href="statistical-models.html#random-effects-z"><i class="fa fa-check"></i><b>6.5.7</b> Random effects, <span class="math inline">\(Z\)</span></a></li>
<li class="chapter" data-level="6.5.8" data-path="statistical-models.html"><a href="statistical-models.html#random-effects-coefficients-u"><i class="fa fa-check"></i><b>6.5.8</b> Random effects coefficients, <span class="math inline">\(u\)</span></a></li>
<li class="chapter" data-level="6.5.9" data-path="statistical-models.html"><a href="statistical-models.html#variance-covariance-matrix-of-the-random-effects-boldsymbolu"><i class="fa fa-check"></i><b>6.5.9</b> Variance-covariance matrix of the random effects, <span class="math inline">\(\boldsymbol{u}\)</span></a></li>
<li class="chapter" data-level="6.5.10" data-path="statistical-models.html"><a href="statistical-models.html#how-to-solve-sigma2-and-sigma_ub2"><i class="fa fa-check"></i><b>6.5.10</b> How to solve <span class="math inline">\(\sigma^{2}\)</span> and <span class="math inline">\(\sigma_{u(B)}^{2}\)</span></a></li>
<li class="chapter" data-level="6.5.11" data-path="statistical-models.html"><a href="statistical-models.html#residuals-errors-and-their-variance--covariance-matrix"><i class="fa fa-check"></i><b>6.5.11</b> Residuals (errors) and their variance- covariance matrix</a></li>
<li class="chapter" data-level="6.5.12" data-path="statistical-models.html"><a href="statistical-models.html#estimated-parameters"><i class="fa fa-check"></i><b>6.5.12</b> Estimated parameters</a></li>
<li class="chapter" data-level="6.5.13" data-path="statistical-models.html"><a href="statistical-models.html#lmm-equation"><i class="fa fa-check"></i><b>6.5.13</b> LMM equation</a></li>
<li class="chapter" data-level="6.5.14" data-path="statistical-models.html"><a href="statistical-models.html#testing-of-models-also-suitable-for-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.5.14</b> Testing of models (also suitable for fixed effect coefficients)</a></li>
<li class="chapter" data-level="6.5.15" data-path="statistical-models.html"><a href="statistical-models.html#testing-of-fixed-effect-coefficients-only-ml"><i class="fa fa-check"></i><b>6.5.15</b> Testing of fixed effect coefficients (only ML)</a></li>
<li class="chapter" data-level="6.5.16" data-path="statistical-models.html"><a href="statistical-models.html#the-95-confidence-interval-of-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.5.16</b> The <span class="math inline">\(95 \%\)</span> confidence interval of fixed effect coefficients</a></li>
<li class="chapter" data-level="6.5.17" data-path="statistical-models.html"><a href="statistical-models.html#testing-of-random-effect-coefficients-typically-variances-reml"><i class="fa fa-check"></i><b>6.5.17</b> Testing of random effect coefficients (typically variances, REML)</a></li>
<li class="chapter" data-level="6.5.18" data-path="statistical-models.html"><a href="statistical-models.html#confidence-intervals-for-random-effects-parameters-variances"><i class="fa fa-check"></i><b>6.5.18</b> Confidence intervals for random effects parameters (variances)</a></li>
<li class="chapter" data-level="6.5.19" data-path="statistical-models.html"><a href="statistical-models.html#model-diagnostics"><i class="fa fa-check"></i><b>6.5.19</b> Model diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-practice"><i class="fa fa-check"></i><b>6.6</b> Linear mixed model practice</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="statistical-models.html"><a href="statistical-models.html#loading-data-and-library"><i class="fa fa-check"></i><b>6.6.1</b> Loading data and library</a></li>
<li class="chapter" data-level="6.6.2" data-path="statistical-models.html"><a href="statistical-models.html#general-linear-regression"><i class="fa fa-check"></i><b>6.6.2</b> General linear regression</a></li>
<li class="chapter" data-level="6.6.3" data-path="statistical-models.html"><a href="statistical-models.html#generalized-linear-regression"><i class="fa fa-check"></i><b>6.6.3</b> Generalized linear regression</a></li>
<li class="chapter" data-level="6.6.4" data-path="statistical-models.html"><a href="statistical-models.html#varying-intercept-by-adding-a-stratum-variable-as-fixed-effect-glm"><i class="fa fa-check"></i><b>6.6.4</b> Varying intercept by adding a stratum variable as fixed effect (glm)</a></li>
<li class="chapter" data-level="6.6.5" data-path="statistical-models.html"><a href="statistical-models.html#comparisions-of-models"><i class="fa fa-check"></i><b>6.6.5</b> Comparisions of models</a></li>
<li class="chapter" data-level="6.6.6" data-path="statistical-models.html"><a href="statistical-models.html#adding-class-and-school-as-fixed-effects-glm"><i class="fa fa-check"></i><b>6.6.6</b> Adding class and school as fixed effects (glm)</a></li>
<li class="chapter" data-level="6.6.7" data-path="statistical-models.html"><a href="statistical-models.html#considering-different-slopes-by-stratum-glm"><i class="fa fa-check"></i><b>6.6.7</b> Considering different slopes by stratum (glm)</a></li>
<li class="chapter" data-level="6.6.8" data-path="statistical-models.html"><a href="statistical-models.html#varying-intercept-with-lmm"><i class="fa fa-check"></i><b>6.6.8</b> Varying intercept with LMM</a></li>
<li class="chapter" data-level="6.6.9" data-path="statistical-models.html"><a href="statistical-models.html#varying-slope-with-lmm"><i class="fa fa-check"></i><b>6.6.9</b> Varying slope with LMM</a></li>
<li class="chapter" data-level="6.6.10" data-path="statistical-models.html"><a href="statistical-models.html#summary-the-model-8"><i class="fa fa-check"></i><b>6.6.10</b> Summary the model 8</a></li>
<li class="chapter" data-level="6.6.11" data-path="statistical-models.html"><a href="statistical-models.html#extracting-elements-parameters"><i class="fa fa-check"></i><b>6.6.11</b> Extracting elements (parameters)</a></li>
<li class="chapter" data-level="6.6.12" data-path="statistical-models.html"><a href="statistical-models.html#model-diagnostics-1"><i class="fa fa-check"></i><b>6.6.12</b> Model diagnostics</a></li>
<li class="chapter" data-level="6.6.13" data-path="statistical-models.html"><a href="statistical-models.html#notice"><i class="fa fa-check"></i><b>6.6.13</b> Notice</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-intercept--lme4"><i class="fa fa-check"></i><b>6.7</b> Linear mixed model covariance decomposition with random intercept- lme4</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data-1"><i class="fa fa-check"></i><b>6.7.1</b> Load data</a></li>
<li class="chapter" data-level="6.7.2" data-path="statistical-models.html"><a href="statistical-models.html#using-glm"><i class="fa fa-check"></i><b>6.7.2</b> Using glm</a></li>
<li class="chapter" data-level="6.7.3" data-path="statistical-models.html"><a href="statistical-models.html#using-glm-with-random-slopes"><i class="fa fa-check"></i><b>6.7.3</b> Using glm with random slopes</a></li>
<li class="chapter" data-level="6.7.4" data-path="statistical-models.html"><a href="statistical-models.html#using-lmm"><i class="fa fa-check"></i><b>6.7.4</b> Using lmm</a></li>
<li class="chapter" data-level="6.7.5" data-path="statistical-models.html"><a href="statistical-models.html#get-xyz"><i class="fa fa-check"></i><b>6.7.5</b> Get x,y,z</a></li>
<li class="chapter" data-level="6.7.6" data-path="statistical-models.html"><a href="statistical-models.html#get-fixed-effect-and-random-effect-coefficients"><i class="fa fa-check"></i><b>6.7.6</b> Get fixed effect and random effect coefficients</a></li>
<li class="chapter" data-level="6.7.7" data-path="statistical-models.html"><a href="statistical-models.html#get-random-effect-covariance-structure-covariance-matrix-expandation"><i class="fa fa-check"></i><b>6.7.7</b> Get random effect covariance structure (covariance matrix expandation)</a></li>
<li class="chapter" data-level="6.7.8" data-path="statistical-models.html"><a href="statistical-models.html#get-residual-variance-and-its-identity-matrix"><i class="fa fa-check"></i><b>6.7.8</b> Get residual variance and its identity matrix</a></li>
<li class="chapter" data-level="6.7.9" data-path="statistical-models.html"><a href="statistical-models.html#get-y-covariance-matrix"><i class="fa fa-check"></i><b>6.7.9</b> Get y covariance matrix</a></li>
<li class="chapter" data-level="6.7.10" data-path="statistical-models.html"><a href="statistical-models.html#get-fixed-effect-coefficients-covariance-matrix"><i class="fa fa-check"></i><b>6.7.10</b> Get fixed effect coefficients covariance matrix</a></li>
<li class="chapter" data-level="6.7.11" data-path="statistical-models.html"><a href="statistical-models.html#get-random-effect-coefficients-covariance-matrix-standard-deviation"><i class="fa fa-check"></i><b>6.7.11</b> Get random effect coefficients covariance matrix (standard deviation)</a></li>
<li class="chapter" data-level="6.7.12" data-path="statistical-models.html"><a href="statistical-models.html#computer-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.7.12</b> Computer fixed effect coefficients</a></li>
<li class="chapter" data-level="6.7.13" data-path="statistical-models.html"><a href="statistical-models.html#computer-covariance-of-fixed-efffect-coefficients"><i class="fa fa-check"></i><b>6.7.13</b> Computer covariance of fixed efffect coefficients</a></li>
<li class="chapter" data-level="6.7.14" data-path="statistical-models.html"><a href="statistical-models.html#computer-random-effect-coefficients"><i class="fa fa-check"></i><b>6.7.14</b> Computer random effect coefficients</a></li>
<li class="chapter" data-level="6.7.15" data-path="statistical-models.html"><a href="statistical-models.html#computer-predicted-values"><i class="fa fa-check"></i><b>6.7.15</b> Computer predicted values</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-slopes--lme4"><i class="fa fa-check"></i><b>6.8</b> Linear mixed model covariance decomposition with random slopes- lme4</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data-2"><i class="fa fa-check"></i><b>6.8.1</b> Load data</a></li>
<li class="chapter" data-level="6.8.2" data-path="statistical-models.html"><a href="statistical-models.html#using-lmm-1"><i class="fa fa-check"></i><b>6.8.2</b> Using lmm</a></li>
<li class="chapter" data-level="6.8.3" data-path="statistical-models.html"><a href="statistical-models.html#get-xyz-1"><i class="fa fa-check"></i><b>6.8.3</b> Get x,y,z</a></li>
<li class="chapter" data-level="6.8.4" data-path="statistical-models.html"><a href="statistical-models.html#get-fixed-effect-and-random-effect-coefficients-1"><i class="fa fa-check"></i><b>6.8.4</b> Get fixed effect and random effect coefficients</a></li>
<li class="chapter" data-level="6.8.5" data-path="statistical-models.html"><a href="statistical-models.html#get-random-effect-covariance-structure-covariance-matrix-expandation-1"><i class="fa fa-check"></i><b>6.8.5</b> Get random effect covariance structure (covariance matrix expandation)</a></li>
<li class="chapter" data-level="6.8.6" data-path="statistical-models.html"><a href="statistical-models.html#get-residual-variance-and-its-identity-matrix-1"><i class="fa fa-check"></i><b>6.8.6</b> Get residual variance and its identity matrix</a></li>
<li class="chapter" data-level="6.8.7" data-path="statistical-models.html"><a href="statistical-models.html#get-y-covariance-matrix-1"><i class="fa fa-check"></i><b>6.8.7</b> Get y covariance matrix</a></li>
<li class="chapter" data-level="6.8.8" data-path="statistical-models.html"><a href="statistical-models.html#get-fixed-effect-coefficients-covariance-matrix-1"><i class="fa fa-check"></i><b>6.8.8</b> Get fixed effect coefficients covariance matrix</a></li>
<li class="chapter" data-level="6.8.9" data-path="statistical-models.html"><a href="statistical-models.html#get-random-effect-coefficients-covariance-matrix-standard-deviation-1"><i class="fa fa-check"></i><b>6.8.9</b> Get random effect coefficients covariance matrix (standard deviation)</a></li>
<li class="chapter" data-level="6.8.10" data-path="statistical-models.html"><a href="statistical-models.html#computer-fixed-effect-coefficients-1"><i class="fa fa-check"></i><b>6.8.10</b> Computer fixed effect coefficients</a></li>
<li class="chapter" data-level="6.8.11" data-path="statistical-models.html"><a href="statistical-models.html#computer-covariance-of-fixed-efffect-coefficients-1"><i class="fa fa-check"></i><b>6.8.11</b> Computer covariance of fixed efffect coefficients</a></li>
<li class="chapter" data-level="6.8.12" data-path="statistical-models.html"><a href="statistical-models.html#computer-random-effect-coefficients-1"><i class="fa fa-check"></i><b>6.8.12</b> Computer random effect coefficients</a></li>
<li class="chapter" data-level="6.8.13" data-path="statistical-models.html"><a href="statistical-models.html#computer-predicted-values-1"><i class="fa fa-check"></i><b>6.8.13</b> Computer predicted values</a></li>
<li class="chapter" data-level="6.8.14" data-path="statistical-models.html"><a href="statistical-models.html#using-lmm-with-two-grouping-factors"><i class="fa fa-check"></i><b>6.8.14</b> Using lmm with two grouping factors</a></li>
<li class="chapter" data-level="6.8.15" data-path="statistical-models.html"><a href="statistical-models.html#get-z2"><i class="fa fa-check"></i><b>6.8.15</b> Get z2</a></li>
<li class="chapter" data-level="6.8.16" data-path="statistical-models.html"><a href="statistical-models.html#using-lmm-with-nested-or-crossed-random-effects"><i class="fa fa-check"></i><b>6.8.16</b> Using lmm with nested or crossed random effects</a></li>
<li class="chapter" data-level="6.8.17" data-path="statistical-models.html"><a href="statistical-models.html#get-z3"><i class="fa fa-check"></i><b>6.8.17</b> Get z3</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="statistical-models.html"><a href="statistical-models.html#linear-mixed-model-covariance-decomposition-nlme"><i class="fa fa-check"></i><b>6.9</b> Linear mixed model covariance decomposition (nlme)</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="statistical-models.html"><a href="statistical-models.html#load-data-3"><i class="fa fa-check"></i><b>6.9.1</b> Load data</a></li>
<li class="chapter" data-level="6.9.2" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-nlme"><i class="fa fa-check"></i><b>6.9.2</b> Using lme (nlme)</a></li>
<li class="chapter" data-level="6.9.3" data-path="statistical-models.html"><a href="statistical-models.html#model-diagnosing"><i class="fa fa-check"></i><b>6.9.3</b> Model diagnosing</a></li>
<li class="chapter" data-level="6.9.4" data-path="statistical-models.html"><a href="statistical-models.html#get-x-y-z-matrixs-using-lme4"><i class="fa fa-check"></i><b>6.9.4</b> Get x, y, z matrixs (using lme4)</a></li>
<li class="chapter" data-level="6.9.5" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficient"><i class="fa fa-check"></i><b>6.9.5</b> Fixed effect coefficient</a></li>
<li class="chapter" data-level="6.9.6" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-coefficient"><i class="fa fa-check"></i><b>6.9.6</b> Random effect coefficient</a></li>
<li class="chapter" data-level="6.9.7" data-path="statistical-models.html"><a href="statistical-models.html#fixed-effect-coefficients-covariance"><i class="fa fa-check"></i><b>6.9.7</b> Fixed effect coefficients covariance</a></li>
<li class="chapter" data-level="6.9.8" data-path="statistical-models.html"><a href="statistical-models.html#random-effect-covariance-and-correlation"><i class="fa fa-check"></i><b>6.9.8</b> Random effect covariance and correlation</a></li>
<li class="chapter" data-level="6.9.9" data-path="statistical-models.html"><a href="statistical-models.html#get-y-covariance-directly"><i class="fa fa-check"></i><b>6.9.9</b> Get y covariance directly</a></li>
<li class="chapter" data-level="6.9.10" data-path="statistical-models.html"><a href="statistical-models.html#residual-variance"><i class="fa fa-check"></i><b>6.9.10</b> Residual variance</a></li>
<li class="chapter" data-level="6.9.11" data-path="statistical-models.html"><a href="statistical-models.html#compute-fixed-effect-coefficients"><i class="fa fa-check"></i><b>6.9.11</b> Compute fixed effect coefficients</a></li>
<li class="chapter" data-level="6.9.12" data-path="statistical-models.html"><a href="statistical-models.html#compute-covariance-of-fixed-efffect-coefficients"><i class="fa fa-check"></i><b>6.9.12</b> Compute covariance of fixed efffect coefficients</a></li>
<li class="chapter" data-level="6.9.13" data-path="statistical-models.html"><a href="statistical-models.html#compute-random-effect-coefficients"><i class="fa fa-check"></i><b>6.9.13</b> Compute random effect coefficients</a></li>
<li class="chapter" data-level="6.9.14" data-path="statistical-models.html"><a href="statistical-models.html#compute-predicted-values"><i class="fa fa-check"></i><b>6.9.14</b> Compute predicted values</a></li>
<li class="chapter" data-level="6.9.15" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-gaussian"><i class="fa fa-check"></i><b>6.9.15</b> Using lme with Gaussian</a></li>
<li class="chapter" data-level="6.9.16" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-autoregressive"><i class="fa fa-check"></i><b>6.9.16</b> Using lme with autoregressive</a></li>
<li class="chapter" data-level="6.9.17" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-exponential"><i class="fa fa-check"></i><b>6.9.17</b> Using lme with exponential</a></li>
<li class="chapter" data-level="6.9.18" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-unstructured"><i class="fa fa-check"></i><b>6.9.18</b> Using lme with unstructured</a></li>
<li class="chapter" data-level="6.9.19" data-path="statistical-models.html"><a href="statistical-models.html#using-lme-with-compound-symm"><i class="fa fa-check"></i><b>6.9.19</b> Using lme with compound symm</a></li>
<li class="chapter" data-level="6.9.20" data-path="statistical-models.html"><a href="statistical-models.html#using-gls-with-unstructured-corsymm"><i class="fa fa-check"></i><b>6.9.20</b> Using gls with unstructured, corSymm</a></li>
<li class="chapter" data-level="6.9.21" data-path="statistical-models.html"><a href="statistical-models.html#using-gls-with-compound-symm-which-lmer-model-default-lme-default-lme-compound-symm-lme-auto-reg-in-this-example"><i class="fa fa-check"></i><b>6.9.21</b> Using gls with compound symm, which = lmer model default = lme default = lme compound symm =lme auto reg in this example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="statistical-models.html"><a href="statistical-models.html#manual-simulating-data-for-linear-mix-model"><i class="fa fa-check"></i><b>6.10</b> Manual simulating data for linear mix model</a></li>
<li class="chapter" data-level="6.11" data-path="statistical-models.html"><a href="statistical-models.html#how-to-calculate-the-prediction-interval-for-lmm"><i class="fa fa-check"></i><b>6.11</b> How to calculate the prediction interval for LMM</a></li>
<li class="chapter" data-level="6.12" data-path="statistical-models.html"><a href="statistical-models.html#least-squares-means-with-interaction-effect"><i class="fa fa-check"></i><b>6.12</b> Least-squares means with interaction effect</a></li>
<li class="chapter" data-level="6.13" data-path="statistical-models.html"><a href="statistical-models.html#spline-regression"><i class="fa fa-check"></i><b>6.13</b> Spline regression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>7</b> Probability</a>
<ul>
<li class="chapter" data-level="7.1" data-path="probability.html"><a href="probability.html#probability-basics"><i class="fa fa-check"></i><b>7.1</b> Probability basics</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="probability.html"><a href="probability.html#events"><i class="fa fa-check"></i><b>7.1.1</b> Events</a></li>
<li class="chapter" data-level="7.1.2" data-path="probability.html"><a href="probability.html#probability-formulas"><i class="fa fa-check"></i><b>7.1.2</b> Probability formulas</a></li>
<li class="chapter" data-level="7.1.3" data-path="probability.html"><a href="probability.html#calculation-of-probability-operations"><i class="fa fa-check"></i><b>7.1.3</b> Calculation of probability (operations)</a></li>
<li class="chapter" data-level="7.1.4" data-path="probability.html"><a href="probability.html#bayess-theorem"><i class="fa fa-check"></i><b>7.1.4</b> Bayes’s theorem</a></li>
<li class="chapter" data-level="7.1.5" data-path="probability.html"><a href="probability.html#random-variables-and-distribution-functions"><i class="fa fa-check"></i><b>7.1.5</b> Random variables and distribution functions</a></li>
<li class="chapter" data-level="7.1.6" data-path="probability.html"><a href="probability.html#probability-distribution"><i class="fa fa-check"></i><b>7.1.6</b> Probability distribution</a></li>
<li class="chapter" data-level="7.1.7" data-path="probability.html"><a href="probability.html#conditional-expectation"><i class="fa fa-check"></i><b>7.1.7</b> Conditional expectation</a></li>
<li class="chapter" data-level="7.1.8" data-path="probability.html"><a href="probability.html#conditional-variance"><i class="fa fa-check"></i><b>7.1.8</b> Conditional variance</a></li>
<li class="chapter" data-level="7.1.9" data-path="probability.html"><a href="probability.html#sampling"><i class="fa fa-check"></i><b>7.1.9</b> Sampling</a></li>
<li class="chapter" data-level="7.1.10" data-path="probability.html"><a href="probability.html#confidence-interval"><i class="fa fa-check"></i><b>7.1.10</b> Confidence interval</a></li>
<li class="chapter" data-level="7.1.11" data-path="probability.html"><a href="probability.html#introduction-to-hypothesis-testing"><i class="fa fa-check"></i><b>7.1.11</b> Introduction to Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="probability.html"><a href="probability.html#probability-r-practice"><i class="fa fa-check"></i><b>7.2</b> Probability R practice</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="probability.html"><a href="probability.html#integrate"><i class="fa fa-check"></i><b>7.2.1</b> Integrate</a></li>
<li class="chapter" data-level="7.2.2" data-path="probability.html"><a href="probability.html#derivation"><i class="fa fa-check"></i><b>7.2.2</b> Derivation</a></li>
<li class="chapter" data-level="7.2.3" data-path="probability.html"><a href="probability.html#create-random-variables-with-specific-distributions"><i class="fa fa-check"></i><b>7.2.3</b> Create random variables with specific distributions</a></li>
<li class="chapter" data-level="7.2.4" data-path="probability.html"><a href="probability.html#prob-function"><i class="fa fa-check"></i><b>7.2.4</b> Prob function</a></li>
<li class="chapter" data-level="7.2.5" data-path="probability.html"><a href="probability.html#vector-and-operations"><i class="fa fa-check"></i><b>7.2.5</b> Vector and operations</a></li>
<li class="chapter" data-level="7.2.6" data-path="probability.html"><a href="probability.html#select-and-substitute-elements-of-vector"><i class="fa fa-check"></i><b>7.2.6</b> Select and substitute elements of vector</a></li>
<li class="chapter" data-level="7.2.7" data-path="probability.html"><a href="probability.html#matrix-and-operations"><i class="fa fa-check"></i><b>7.2.7</b> Matrix and operations</a></li>
<li class="chapter" data-level="7.2.8" data-path="probability.html"><a href="probability.html#compute-inverse-determinant-and-eigen-values-of-matrix"><i class="fa fa-check"></i><b>7.2.8</b> Compute inverse, determinant and eigen values of matrix</a></li>
<li class="chapter" data-level="7.2.9" data-path="probability.html"><a href="probability.html#dataframe"><i class="fa fa-check"></i><b>7.2.9</b> Dataframe</a></li>
<li class="chapter" data-level="7.2.10" data-path="probability.html"><a href="probability.html#solve-problems-using-simulation"><i class="fa fa-check"></i><b>7.2.10</b> Solve problems using simulation</a></li>
<li class="chapter" data-level="7.2.11" data-path="probability.html"><a href="probability.html#permutations-and-combinations"><i class="fa fa-check"></i><b>7.2.11</b> Permutations and combinations</a></li>
<li class="chapter" data-level="7.2.12" data-path="probability.html"><a href="probability.html#search-value-position-in-vector"><i class="fa fa-check"></i><b>7.2.12</b> Search value position in vector</a></li>
<li class="chapter" data-level="7.2.13" data-path="probability.html"><a href="probability.html#solve-directly-and-optimize"><i class="fa fa-check"></i><b>7.2.13</b> Solve directly and optimize</a></li>
<li class="chapter" data-level="7.2.14" data-path="probability.html"><a href="probability.html#calculate-probability-using-simulation-method"><i class="fa fa-check"></i><b>7.2.14</b> Calculate probability using simulation method</a></li>
<li class="chapter" data-level="7.2.15" data-path="probability.html"><a href="probability.html#discrete-random-variable"><i class="fa fa-check"></i><b>7.2.15</b> Discrete random variable</a></li>
<li class="chapter" data-level="7.2.16" data-path="probability.html"><a href="probability.html#exponent-distribution"><i class="fa fa-check"></i><b>7.2.16</b> Exponent distribution</a></li>
<li class="chapter" data-level="7.2.17" data-path="probability.html"><a href="probability.html#normal-distribution-plot"><i class="fa fa-check"></i><b>7.2.17</b> Normal distribution plot</a></li>
<li class="chapter" data-level="7.2.18" data-path="probability.html"><a href="probability.html#distribution-of-random-variable-function"><i class="fa fa-check"></i><b>7.2.18</b> Distribution of random variable function</a></li>
<li class="chapter" data-level="7.2.19" data-path="probability.html"><a href="probability.html#join-and-margin-probability"><i class="fa fa-check"></i><b>7.2.19</b> Join and margin probability</a></li>
<li class="chapter" data-level="7.2.20" data-path="probability.html"><a href="probability.html#multiple-random-variables-plots"><i class="fa fa-check"></i><b>7.2.20</b> Multiple random variables plots</a></li>
<li class="chapter" data-level="7.2.21" data-path="probability.html"><a href="probability.html#generate-a-circle-using-simulated-random-dots"><i class="fa fa-check"></i><b>7.2.21</b> Generate a circle using simulated random dots</a></li>
<li class="chapter" data-level="7.2.22" data-path="probability.html"><a href="probability.html#expectation"><i class="fa fa-check"></i><b>7.2.22</b> Expectation</a></li>
<li class="chapter" data-level="7.2.23" data-path="probability.html"><a href="probability.html#central-limit-theorem-1"><i class="fa fa-check"></i><b>7.2.23</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="7.2.24" data-path="probability.html"><a href="probability.html#law-of-large-numbers"><i class="fa fa-check"></i><b>7.2.24</b> Law of large numbers</a></li>
<li class="chapter" data-level="7.2.25" data-path="probability.html"><a href="probability.html#empirical-distribution"><i class="fa fa-check"></i><b>7.2.25</b> Empirical distribution</a></li>
<li class="chapter" data-level="7.2.26" data-path="probability.html"><a href="probability.html#maximum-likelihood-estimate"><i class="fa fa-check"></i><b>7.2.26</b> Maximum likelihood estimate</a></li>
<li class="chapter" data-level="7.2.27" data-path="probability.html"><a href="probability.html#t-distribution-f-distribution-plots-and-common-distributions"><i class="fa fa-check"></i><b>7.2.27</b> t distribution, F distribution plots, and common distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>8</b> Algorithms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>8.1</b> Maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="algorithms.html"><a href="algorithms.html#likelihood-estimation"><i class="fa fa-check"></i><b>8.1.1</b> Likelihood estimation</a></li>
<li class="chapter" data-level="8.1.2" data-path="algorithms.html"><a href="algorithms.html#r-demonstration"><i class="fa fa-check"></i><b>8.1.2</b> <code>R demonstration</code></a></li>
<li class="chapter" data-level="8.1.3" data-path="algorithms.html"><a href="algorithms.html#estimate-confidence-intervals-using-the-likelihood"><i class="fa fa-check"></i><b>8.1.3</b> Estimate confidence intervals using the likelihood</a></li>
<li class="chapter" data-level="8.1.4" data-path="algorithms.html"><a href="algorithms.html#the-profile-likelihood"><i class="fa fa-check"></i><b>8.1.4</b> The profile likelihood</a></li>
<li class="chapter" data-level="8.1.5" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimate-practice"><i class="fa fa-check"></i><b>8.1.5</b> Maximum likelihood estimate practice</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="algorithms.html"><a href="algorithms.html#gradient-descent"><i class="fa fa-check"></i><b>8.2</b> Gradient descent</a></li>
<li class="chapter" data-level="8.3" data-path="algorithms.html"><a href="algorithms.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>8.3</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="8.4" data-path="algorithms.html"><a href="algorithms.html#expectation-maximum"><i class="fa fa-check"></i><b>8.4</b> Expectation maximum</a></li>
<li class="chapter" data-level="8.5" data-path="algorithms.html"><a href="algorithms.html#combine-estimates-by-pooling-rules"><i class="fa fa-check"></i><b>8.5</b> Combine estimates by pooling rules</a></li>
<li class="chapter" data-level="8.6" data-path="algorithms.html"><a href="algorithms.html#simulations-and-bootstrapping"><i class="fa fa-check"></i><b>8.6</b> Simulations and Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sasmarkdown.html"><a href="sasmarkdown.html"><i class="fa fa-check"></i><b>9</b> SASmarkdown</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#how-to-install-sasmarkdown"><i class="fa fa-check"></i><b>9.1</b> How to install sasmarkdown</a></li>
<li class="chapter" data-level="9.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#common-statements"><i class="fa fa-check"></i><b>9.2</b> Common statements</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#read-in-date-data-using-informat"><i class="fa fa-check"></i><b>9.2.1</b> read in (date) data using informat</a></li>
<li class="chapter" data-level="9.2.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#compute-mean-and-freqency"><i class="fa fa-check"></i><b>9.2.2</b> compute mean and freqency</a></li>
<li class="chapter" data-level="9.2.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#sort-a-data-set"><i class="fa fa-check"></i><b>9.2.3</b> sort a data set</a></li>
<li class="chapter" data-level="9.2.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#transpose-or-reshape"><i class="fa fa-check"></i><b>9.2.4</b> transpose or reshape</a></li>
<li class="chapter" data-level="9.2.5" data-path="sasmarkdown.html"><a href="sasmarkdown.html#conditional-statement"><i class="fa fa-check"></i><b>9.2.5</b> conditional statement</a></li>
<li class="chapter" data-level="9.2.6" data-path="sasmarkdown.html"><a href="sasmarkdown.html#using-like-operation-to-select-rows-contaning-a-pattern"><i class="fa fa-check"></i><b>9.2.6</b> using like operation to select rows contaning a pattern</a></li>
<li class="chapter" data-level="9.2.7" data-path="sasmarkdown.html"><a href="sasmarkdown.html#change-format-of-the-variable"><i class="fa fa-check"></i><b>9.2.7</b> change format of the variable</a></li>
<li class="chapter" data-level="9.2.8" data-path="sasmarkdown.html"><a href="sasmarkdown.html#basic-operations"><i class="fa fa-check"></i><b>9.2.8</b> basic operations</a></li>
<li class="chapter" data-level="9.2.9" data-path="sasmarkdown.html"><a href="sasmarkdown.html#rename-variables-1"><i class="fa fa-check"></i><b>9.2.9</b> rename variables</a></li>
<li class="chapter" data-level="9.2.10" data-path="sasmarkdown.html"><a href="sasmarkdown.html#extract-text-from-a-character-value"><i class="fa fa-check"></i><b>9.2.10</b> extract text from a character value</a></li>
<li class="chapter" data-level="9.2.11" data-path="sasmarkdown.html"><a href="sasmarkdown.html#convert-the-character-value-into-a-numeric-value-and-reverse"><i class="fa fa-check"></i><b>9.2.11</b> convert the character value into a numeric value and reverse</a></li>
<li class="chapter" data-level="9.2.12" data-path="sasmarkdown.html"><a href="sasmarkdown.html#change-the-length-of-the-variable"><i class="fa fa-check"></i><b>9.2.12</b> change the length of the variable</a></li>
<li class="chapter" data-level="9.2.13" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-a-report"><i class="fa fa-check"></i><b>9.2.13</b> create a report</a></li>
<li class="chapter" data-level="9.2.14" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-a-random-variable"><i class="fa fa-check"></i><b>9.2.14</b> create a random variable</a></li>
<li class="chapter" data-level="9.2.15" data-path="sasmarkdown.html"><a href="sasmarkdown.html#combine-two-texts"><i class="fa fa-check"></i><b>9.2.15</b> combine two texts</a></li>
<li class="chapter" data-level="9.2.16" data-path="sasmarkdown.html"><a href="sasmarkdown.html#compress-spaces"><i class="fa fa-check"></i><b>9.2.16</b> compress spaces</a></li>
<li class="chapter" data-level="9.2.17" data-path="sasmarkdown.html"><a href="sasmarkdown.html#identify-the-position-of-a-specified-text"><i class="fa fa-check"></i><b>9.2.17</b> identify the position of a specified text</a></li>
<li class="chapter" data-level="9.2.18" data-path="sasmarkdown.html"><a href="sasmarkdown.html#convert-upcase-lower-case-and-propcase"><i class="fa fa-check"></i><b>9.2.18</b> convert upcase, lower case and propcase</a></li>
<li class="chapter" data-level="9.2.19" data-path="sasmarkdown.html"><a href="sasmarkdown.html#deduplication-1"><i class="fa fa-check"></i><b>9.2.19</b> deduplication</a></li>
<li class="chapter" data-level="9.2.20" data-path="sasmarkdown.html"><a href="sasmarkdown.html#select-sub-data-set"><i class="fa fa-check"></i><b>9.2.20</b> select sub data set</a></li>
<li class="chapter" data-level="9.2.21" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-macro-using-do-loop-statement"><i class="fa fa-check"></i><b>9.2.21</b> create macro using do loop statement</a></li>
<li class="chapter" data-level="9.2.22" data-path="sasmarkdown.html"><a href="sasmarkdown.html#output-intermediate-tables"><i class="fa fa-check"></i><b>9.2.22</b> output intermediate tables</a></li>
<li class="chapter" data-level="9.2.23" data-path="sasmarkdown.html"><a href="sasmarkdown.html#creat-a-sequence-number"><i class="fa fa-check"></i><b>9.2.23</b> creat a sequence number</a></li>
<li class="chapter" data-level="9.2.24" data-path="sasmarkdown.html"><a href="sasmarkdown.html#merge-data-sets"><i class="fa fa-check"></i><b>9.2.24</b> merge data sets</a></li>
<li class="chapter" data-level="9.2.25" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-table-1-1"><i class="fa fa-check"></i><b>9.2.25</b> create table 1</a></li>
<li class="chapter" data-level="9.2.26" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-table-1-without-statistical-test"><i class="fa fa-check"></i><b>9.2.26</b> create table 1 without statistical test</a></li>
<li class="chapter" data-level="9.2.27" data-path="sasmarkdown.html"><a href="sasmarkdown.html#perform-a-regression"><i class="fa fa-check"></i><b>9.2.27</b> perform a regression</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#using-macro"><i class="fa fa-check"></i><b>9.3</b> Using macro</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-a-macro-variable"><i class="fa fa-check"></i><b>9.3.1</b> Create a macro variable</a></li>
<li class="chapter" data-level="9.3.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#select-variables-names"><i class="fa fa-check"></i><b>9.3.2</b> Select variables names</a></li>
<li class="chapter" data-level="9.3.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-iterative-do-to-syntax-to-iterate-a-specific-number"><i class="fa fa-check"></i><b>9.3.3</b> Use iterative DO TO syntax to iterate a Specific Number</a></li>
<li class="chapter" data-level="9.3.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#proc-report-allows-more-flexibility-in-displaying-the-data"><i class="fa fa-check"></i><b>9.3.4</b> PROC REPORT allows more flexibility in displaying the data</a></li>
<li class="chapter" data-level="9.3.5" data-path="sasmarkdown.html"><a href="sasmarkdown.html#create-a-macro-to-calculate-descriptive-stats-and-summarize-tabels"><i class="fa fa-check"></i><b>9.3.5</b> Create a macro to calculate descriptive stats and summarize tabels</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-sas-format"><i class="fa fa-check"></i><b>9.4</b> Use SAS format</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sasmarkdown.html"><a href="sasmarkdown.html#creating-labels-for-different-values"><i class="fa fa-check"></i><b>9.4.1</b> Creating labels for different values</a></li>
<li class="chapter" data-level="9.4.2" data-path="sasmarkdown.html"><a href="sasmarkdown.html#storing-farmats-to-a-library--way-1"><i class="fa fa-check"></i><b>9.4.2</b> Storing farmats to a library- way 1</a></li>
<li class="chapter" data-level="9.4.3" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-stored-defined-format--way-2"><i class="fa fa-check"></i><b>9.4.3</b> Use stored defined format- way 2</a></li>
<li class="chapter" data-level="9.4.4" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-stored-defined-format--way-3"><i class="fa fa-check"></i><b>9.4.4</b> Use stored defined format- way 3</a></li>
<li class="chapter" data-level="9.4.5" data-path="sasmarkdown.html"><a href="sasmarkdown.html#use-stored-defined-format-in-batch--way-4"><i class="fa fa-check"></i><b>9.4.5</b> Use stored defined format in batch- way 4</a></li>
<li class="chapter" data-level="9.4.6" data-path="sasmarkdown.html"><a href="sasmarkdown.html#modify-format-of-the-existing-proc-format"><i class="fa fa-check"></i><b>9.4.6</b> Modify format of the existing proc format</a></li>
<li class="chapter" data-level="9.4.7" data-path="sasmarkdown.html"><a href="sasmarkdown.html#transform-missing-to-char-then-to-numeric-again"><i class="fa fa-check"></i><b>9.4.7</b> Transform missing to char then to numeric again</a></li>
<li class="chapter" data-level="9.4.8" data-path="sasmarkdown.html"><a href="sasmarkdown.html#output-format-of-the-existing-format-name-by-alphabet-order"><i class="fa fa-check"></i><b>9.4.8</b> Output format of the existing format name by alphabet order</a></li>
<li class="chapter" data-level="9.4.9" data-path="sasmarkdown.html"><a href="sasmarkdown.html#a-macro-to-copy-the-existing-proc-format"><i class="fa fa-check"></i><b>9.4.9</b> A macro to copy the existing proc format</a></li>
<li class="chapter" data-level="9.4.10" data-path="sasmarkdown.html"><a href="sasmarkdown.html#a-macro-to-view-the-list-of-variables"><i class="fa fa-check"></i><b>9.4.10</b> A macro to view the list of variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>10</b> Causal inference</a>
<ul>
<li class="chapter" data-level="10.1" data-path="causal-inference.html"><a href="causal-inference.html#causal-inference-introduction"><i class="fa fa-check"></i><b>10.1</b> Causal inference introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="causal-inference.html"><a href="causal-inference.html#definitions-and-directed-acyclic-graph-dag"><i class="fa fa-check"></i><b>10.1.1</b> Definitions and directed acyclic graph (DAG)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="causal-inference.html"><a href="causal-inference.html#inverse-probability-weighting"><i class="fa fa-check"></i><b>10.2</b> Inverse probability weighting</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="causal-inference.html"><a href="causal-inference.html#matching-and-weighting-wo-imputation"><i class="fa fa-check"></i><b>10.2.1</b> Matching and weighting w/o imputation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="causal-inference.html"><a href="causal-inference.html#g-formula"><i class="fa fa-check"></i><b>10.3</b> G formula</a></li>
<li class="chapter" data-level="10.4" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators"><i class="fa fa-check"></i><b>10.4</b> Double Robust Estimators</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="causal-inference.html"><a href="causal-inference.html#superlearner"><i class="fa fa-check"></i><b>10.4.1</b> SuperLearner</a></li>
<li class="chapter" data-level="10.4.2" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators-using-superlearner_sl3"><i class="fa fa-check"></i><b>10.4.2</b> Double robust estimators using SuperLearner_sl3</a></li>
<li class="chapter" data-level="10.4.3" data-path="causal-inference.html"><a href="causal-inference.html#double-robust-estimators-using-tmle"><i class="fa fa-check"></i><b>10.4.3</b> Double robust estimators using TMLE</a></li>
<li class="chapter" data-level="10.4.4" data-path="causal-inference.html"><a href="causal-inference.html#longitudinal-targeted-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>10.4.4</b> Longitudinal targeted maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="causal-inference.html"><a href="causal-inference.html#instrumental-variable-regression"><i class="fa fa-check"></i><b>10.5</b> Instrumental variable regression</a></li>
<li class="chapter" data-level="10.6" data-path="causal-inference.html"><a href="causal-inference.html#mediation-analysis"><i class="fa fa-check"></i><b>10.6</b> Mediation analysis</a></li>
<li class="chapter" data-level="10.7" data-path="causal-inference.html"><a href="causal-inference.html#confounding-and-effect-measure-modification"><i class="fa fa-check"></i><b>10.7</b> Confounding and effect measure modification</a></li>
<li class="chapter" data-level="10.8" data-path="causal-inference.html"><a href="causal-inference.html#causal-inference-and-associated-regression"><i class="fa fa-check"></i><b>10.8</b> Causal inference and associated regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="clinical-trial.html"><a href="clinical-trial.html"><i class="fa fa-check"></i><b>11</b> Clinical Trial</a>
<ul>
<li class="chapter" data-level="11.1" data-path="clinical-trial.html"><a href="clinical-trial.html#statistics-in-clinical-trial"><i class="fa fa-check"></i><b>11.1</b> Statistics in clinical trial</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="clinical-trial.html"><a href="clinical-trial.html#sample-size-interim-data-reports-and-randomization-of-assignment"><i class="fa fa-check"></i><b>11.1.1</b> Sample size, interim data reports and randomization of assignment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="common-statistical-models.html"><a href="common-statistical-models.html"><i class="fa fa-check"></i><b>12</b> Common statistical models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="common-statistical-models.html"><a href="common-statistical-models.html#survival-analysis"><i class="fa fa-check"></i><b>12.1</b> Survival analysis</a></li>
<li class="chapter" data-level="12.2" data-path="common-statistical-models.html"><a href="common-statistical-models.html#logistical-regression"><i class="fa fa-check"></i><b>12.2</b> Logistical regression</a></li>
<li class="chapter" data-level="12.3" data-path="common-statistical-models.html"><a href="common-statistical-models.html#poisson-regression"><i class="fa fa-check"></i><b>12.3</b> Poisson regression</a></li>
<li class="chapter" data-level="12.4" data-path="common-statistical-models.html"><a href="common-statistical-models.html#quantile-regression"><i class="fa fa-check"></i><b>12.4</b> Quantile regression</a></li>
<li class="chapter" data-level="12.5" data-path="common-statistical-models.html"><a href="common-statistical-models.html#principle-components-analysis"><i class="fa fa-check"></i><b>12.5</b> Principle components analysis</a></li>
<li class="chapter" data-level="12.6" data-path="common-statistical-models.html"><a href="common-statistical-models.html#which-covariates-should-be-adjusted"><i class="fa fa-check"></i><b>12.6</b> Which covariates should be adjusted</a></li>
<li class="chapter" data-level="12.7" data-path="common-statistical-models.html"><a href="common-statistical-models.html#variable-selection-1"><i class="fa fa-check"></i><b>12.7</b> Variable selection</a></li>
<li class="chapter" data-level="12.8" data-path="common-statistical-models.html"><a href="common-statistical-models.html#fit-regression-model-with-a-fan-shaped-relation"><i class="fa fa-check"></i><b>12.8</b> Fit regression model with a fan-shaped relation</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html"><i class="fa fa-check"></i><b>13</b> Bayesian statistics</a>
<ul>
<li class="chapter" data-level="13.1" data-path="bayesian-statistics.html"><a href="bayesian-statistics.html#bayesian-inference-in-r"><i class="fa fa-check"></i><b>13.1</b> Bayesian Inference in R</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="epidemiolgy.html"><a href="epidemiolgy.html"><i class="fa fa-check"></i><b>14</b> Epidemiolgy</a>
<ul>
<li class="chapter" data-level="14.1" data-path="epidemiolgy.html"><a href="epidemiolgy.html#introduction"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="epidemiolgy.html"><a href="epidemiolgy.html#bias-analysis-and-control-in-r"><i class="fa fa-check"></i><b>14.2</b> Bias analysis and control IN R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="bioinformation.html"><a href="bioinformation.html"><i class="fa fa-check"></i><b>15</b> Bioinformation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="bioinformation.html"><a href="bioinformation.html#sequence-analysis"><i class="fa fa-check"></i><b>15.1</b> Sequence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="common-issues-in-statistics.html"><a href="common-issues-in-statistics.html"><i class="fa fa-check"></i><b>16</b> Common issues in Statistics</a></li>
<li class="chapter" data-level="17" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>17</b> Miscellaneous</a>
<ul>
<li class="chapter" data-level="17.1" data-path="miscellaneous.html"><a href="miscellaneous.html#linear-algebra"><i class="fa fa-check"></i><b>17.1</b> Linear algebra</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="miscellaneous.html"><a href="miscellaneous.html#matrix-basics"><i class="fa fa-check"></i><b>17.1.1</b> Matrix basics</a></li>
<li class="chapter" data-level="17.1.2" data-path="miscellaneous.html"><a href="miscellaneous.html#operations"><i class="fa fa-check"></i><b>17.1.2</b> Operations</a></li>
<li class="chapter" data-level="17.1.3" data-path="miscellaneous.html"><a href="miscellaneous.html#advanced-operations"><i class="fa fa-check"></i><b>17.1.3</b> Advanced operations</a></li>
<li class="chapter" data-level="17.1.4" data-path="miscellaneous.html"><a href="miscellaneous.html#solve-linear-equations"><i class="fa fa-check"></i><b>17.1.4</b> Solve linear equations</a></li>
<li class="chapter" data-level="17.1.5" data-path="miscellaneous.html"><a href="miscellaneous.html#summary"><i class="fa fa-check"></i><b>17.1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="miscellaneous.html"><a href="miscellaneous.html#calculus"><i class="fa fa-check"></i><b>17.2</b> Calculus</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="miscellaneous.html"><a href="miscellaneous.html#derivation-1"><i class="fa fa-check"></i><b>17.2.1</b> Derivation</a></li>
<li class="chapter" data-level="17.2.2" data-path="miscellaneous.html"><a href="miscellaneous.html#integration"><i class="fa fa-check"></i><b>17.2.2</b> Integration</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="miscellaneous.html"><a href="miscellaneous.html#sample-size-calculation"><i class="fa fa-check"></i><b>17.3</b> Sample size calculation</a></li>
<li class="chapter" data-level="17.4" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-evaluate-z-score"><i class="fa fa-check"></i><b>17.4</b> How to evaluate z score</a></li>
<li class="chapter" data-level="17.5" data-path="miscellaneous.html"><a href="miscellaneous.html#mathmatic-coupling"><i class="fa fa-check"></i><b>17.5</b> Mathmatic coupling</a></li>
<li class="chapter" data-level="17.6" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-create-a-bookdown"><i class="fa fa-check"></i><b>17.6</b> How to create a bookdown</a></li>
<li class="chapter" data-level="17.7" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-create-a-blogdown"><i class="fa fa-check"></i><b>17.7</b> How to create a blogdown</a></li>
<li class="chapter" data-level="17.8" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-install-tensorflow-and-keras"><i class="fa fa-check"></i><b>17.8</b> How to install tensorflow and keras</a></li>
<li class="chapter" data-level="17.9" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-use-github-in-team"><i class="fa fa-check"></i><b>17.9</b> How to use github in team</a></li>
<li class="chapter" data-level="17.10" data-path="miscellaneous.html"><a href="miscellaneous.html#how-to-insert-picture-indrectly-in-markdown"><i class="fa fa-check"></i><b>17.10</b> How to insert picture indrectly in markdown</a></li>
<li class="chapter" data-level="17.11" data-path="miscellaneous.html"><a href="miscellaneous.html#r-cheatsheets"><i class="fa fa-check"></i><b>17.11</b> R cheatsheets</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Little Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-models" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Statistical models<a href="statistical-models.html#statistical-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<div id="simple-linear-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Simple linear regression<a href="statistical-models.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="linear-regeression-assumptions" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Linear regeression assumptions<a href="statistical-models.html#linear-regeression-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are four principal assumptions:</p>
<ul>
<li><p>linearity of the relationship between dependent and independent variables.</p></li>
<li><p>statistical independence of the errors with y variable.</p></li>
<li><p>homoscedasticity (constant variance) of the errors for all x.</p></li>
<li><p>normality of the error distribution.</p></li>
</ul>
<p><code>if independent assumption violated, the estimated standard errors tend to underestimate the true standard error. P value associated thus is lower.</code></p>
<p><code>only the prediction errors need to be normally distributed. but with extremely asymmetric or long-tailed, it may be hard to fit them (x and y) into a linear model whose errors will be normally distributed.</code></p>
</div>
<div id="population-regression-function" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Population regression function<a href="statistical-models.html#population-regression-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Regression is to estimate and/or predict the population mean (expectation) of dependent variable (yi) by a known or a set value of explanatory variables (xi). Population regression line (PRL) is the trajectory of the conditional expectation value given Xi.</p>
<p><span class="math display">\[
E(Y|X_i)=f(X_i)=\beta_1+\beta_2X_i
\]</span>
<code>This is an unknown but fixed value (can be estimated).</code></p>
<!-- - SRF, Sample regression function -->
<!-- $$ -->
<!-- \hat{Y_i}=f(X_i)=\hat{\beta}_1+\hat{\beta}_2X_i -->
<!-- $$ -->
</div>
<div id="population-regression-model" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Population regression model<a href="statistical-models.html#population-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>the errors <span class="math inline">\(u_i=y_i-\hat{y}_i\)</span> have equal variance
<span class="math display">\[
Y_i=\beta_1+\beta_2X_i+u_i
\]</span></p>
</div>
<div id="sample-regression-model" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Sample regression model<a href="statistical-models.html#sample-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(using hat to indicate sample)
<span class="math display">\[
Y_i=\hat{\beta}_1+\hat{\beta}_2X_i+e_i
\]</span></p>
<p>since<br />
<span class="math display">\[
u_i  \sim N(0,\sigma^2)
\]</span>
or
<span class="math display">\[
e_i  \sim N(0,\hat{\sigma} ^2)
\]</span>
and</p>
<p><code>i.i.d., independent identically distribution,  the probability distributions are all the same and variables are independent of each other.</code></p>
<p><span class="math display">\[
\begin{align}
u_i \sim i.i.d \ N(0,\sigma^2)  
\end{align}
\]</span></p>
<p>then</p>
<p><span class="math display">\[
\begin{align}
Y_i- \beta_1+\beta_2X_i (\hat{Y_i}) &amp;\sim i.i.d \ N(0,\sigma^2)\\
\end{align}
\]</span></p>
<p>thence, to minimize Q <span class="math inline">\(\sum{(Y_i-\hat{Y}_i)^2}\)</span> to solve b0 and b1.</p>
<p><span class="math display">\[
\begin{align}
Min(Q) &amp;=\sum{(Y_i-\hat{Y}_i)^2}\\
&amp;=\sum{\left ( Y_i-(\hat{\beta}_1+\hat{\beta}_2X_i) \right )^2}\\
       &amp;=f(\hat{\beta}_1,\hat{\beta}_2)
\end{align}
\]</span></p>
</div>
<div id="solve-hatbeta_1hatbeta_2-and-variance" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Solve <span class="math inline">\(\hat{\beta_1},\hat{\beta_2}\)</span> and variance<a href="statistical-models.html#solve-hatbeta_1hatbeta_2-and-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
  \begin{split}
  \hat{\beta}_2 &amp;=\frac{\sum{x_iy_i}}{\sum{x_i^2}}\\
  \hat{\beta_1} &amp;=\bar{Y}_i-\hat{\beta}_2\bar{X}_i
  \end{split} \\
var(\hat{\beta}_2) =\sigma_{\hat{\beta}_2}^2&amp;=\frac{1}{\sum{x_i^2}}\cdot\sigma^2&amp;&amp;\text{} \\
var(\hat{\beta}_1) =\sigma_{\hat{\beta}_1}^2 &amp;=\frac{\sum{X_i^2}}{n\sum{x_i^2}}\cdot\sigma^2
\end{align}
\]</span></p>
</div>
<div id="calculate-the-variance-hatsigma2-of-error-e_i" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Calculate the variance <span class="math inline">\(\hat{\sigma}^2\)</span> of error <span class="math inline">\(e_i\)</span><a href="statistical-models.html#calculate-the-variance-hatsigma2-of-error-e_i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(for sample)</p>
<p><span class="math display">\[
\begin{align}
  \hat{Y}_i &amp;=\hat{\beta}_1+\hat{\beta}_2X_i  \\
  e_i &amp;=Y_i-\hat{Y}_i  \\
  \hat{\sigma}^2 &amp;=\frac{\sum{e_i^2}}{n-1}=\frac{\sum{(Y_i-\hat{Y}_i)^2}}{n-1}  
\end{align}
\]</span></p>
</div>
<div id="sum-of-squares-decomposition" class="section level3 hasAnchor" number="6.1.7">
<h3><span class="header-section-number">6.1.7</span> Sum of squares decomposition<a href="statistical-models.html#sum-of-squares-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
(Y_i-\bar{Y_i})  &amp;= (\hat{Y_i}-\bar{Y_i}) +(Y_i-\hat{Y_i})  \\
\sum{y_i^2} &amp;= \sum{\hat{y_i}^2} +\sum{e_i^2}  \\
TSS&amp;=ESS+RSS  
\end{align}
\]</span></p>
</div>
<div id="coefficient-of-determination-r2-and-goodness-of-fit" class="section level3 hasAnchor" number="6.1.8">
<h3><span class="header-section-number">6.1.8</span> Coefficient of determination <span class="math inline">\(R^2\)</span> and goodness of fit<a href="statistical-models.html#coefficient-of-determination-r2-and-goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
r^2 &amp;=\frac{ESS}{TSS}=\frac{\sum{(\hat{Y_i}-\bar{Y})^2}}{\sum{(Y_i-\bar{Y})^2}}\\
    &amp;=1-\frac{RSS}{TSS}=1-\frac{\sum{(Y_i-\hat{Y_i})^2}}{\sum{(Y_i-\bar{Y})^2}}
\end{align}
\]</span></p>
<!-- $$ -->
<!-- \begin{align} -->
<!-- r_{X_i,Y_i}&=\frac{Cov(X_i,Y_i)}{S_{X_i}\cdot S_{Y_i}} -->
<!-- = \frac{\sum{(X_i-\bar{X})(Y_i-\bar{Y})}}{\sqrt{\sum{(X_i-\bar{X}})^2\sum{(Y_i-\bar{Y})^2}}} -->
<!--  \\ -->
<!-- (r_{X_i,Y_i})^2 &\simeq r^2   -->
<!-- \end{align} -->
<!-- $$ -->
</div>
<div id="test-of-regression-coefficients" class="section level3 hasAnchor" number="6.1.9">
<h3><span class="header-section-number">6.1.9</span> Test of regression coefficients<a href="statistical-models.html#test-of-regression-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since<br />
<span class="math display">\[
\begin{align}
\hat{\beta_2} &amp;\sim N(\beta_2,\sigma^2_{\hat{\beta_2}})  \\
\hat{\beta_1} &amp;\sim N(\beta_1,\sigma^2_{\hat{\beta_1}})  
\end{align}
\]</span></p>
<p>and
<span class="math display">\[
\begin{align}
S_{\hat{\beta}_2} &amp;=\sqrt{\frac{1}{\sum{x_i^2}}}\cdot\hat{\sigma}
\\
S_{\hat{\beta}_1} &amp;=\sqrt{\frac{\sum{X_i^2}}{n\sum{x_i^2}}}\cdot\hat{\sigma}
\end{align}
\]</span></p>
<p>therefore<br />
<span class="math display">\[
\begin{align}
t_{\hat{\beta_2}}^{\ast}&amp;=\frac{\hat{\beta_2}-\beta_2}{S_{\hat{\beta_2}}}
=\frac{\hat{\beta_2}}{S_{\hat{\beta_2}}}
=\frac{\hat{\beta_2}}{\sqrt{\frac{1}{\sum{x_i^2}}}\cdot\hat{\sigma}}
\sim t(n-2)
  \\
t_{\hat{\beta_1}}^{\ast}&amp;=\frac{\hat{\beta_1}-\beta_1}{S_{\hat{\beta_1}}}
=\frac{\hat{\beta_1}}{S_{\hat{\beta_1}}}
=\frac{\hat{\beta_1}}{\sqrt{\frac{\sum{X_i^2}}{n\sum{x_i^2}}}\cdot\hat{\sigma}}
\sim t(n-2)
\end{align}
\]</span></p>
</div>
<div id="statistical-test-of-model" class="section level3 hasAnchor" number="6.1.10">
<h3><span class="header-section-number">6.1.10</span> Statistical test of model<a href="statistical-models.html#statistical-test-of-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since
<span class="math display">\[
\begin{align}
Y_i&amp;\sim i.i.d \ N(\beta_1+\beta_2X_i,\sigma^2)\\
\end{align}
\]</span>
and<br />
<span class="math display">\[
\begin{align}
ESS&amp;=\sum{(\hat{Y_i}-\bar{Y})^2} \sim \chi^2(df_{ESS})  \\
RSS&amp;=\sum{(Y_i-\hat{Y_i})^2} \sim \chi^2(df_{RSS})  
\end{align}
\]</span></p>
<!-- $$ -->
<!-- \begin{align} -->
<!-- F^{\ast}&=\frac{ESS/df_{ESS}}{RSS/df_{RSS}}=\frac{MSS_{ESS}}{MSS_{RSS}}  \\ -->
<!--         &=\frac{\sum{(\hat{Y_i}-\bar{Y})^2}/df_{ESS}}{\sum{(Y_i-\hat{Y_i})^2}/df_{RSS}} \\ -->
<!--         &\sim F(df_{ESS},df_{RSS}) -->
<!-- \end{align} -->
<!-- $$ -->
<p>therefore
<span class="math display">\[
\begin{align}
F^{\ast}&amp;=\frac{ESS/df_{ESS}}{RSS/df_{RSS}}=\frac{MSS_{ESS}}{MSS_{RSS}}\\
        &amp;=\frac{\sum{(\hat{Y_i}-\bar{Y})^2}/df_{ESS}}{\sum{(Y_i-\hat{Y_i})^2}/df_{RSS}} \\
        &amp;=\frac{\hat{\beta_2}^2\sum{x_i^2}}{\sum{e_i^2}/{(n-2)}}\\
        &amp;=\frac{\hat{\beta_2}^2\sum{x_i^2}}{\hat{\sigma}^2}
\end{align}
\]</span></p>
</div>
<div id="mean-prediction" class="section level3 hasAnchor" number="6.1.11">
<h3><span class="header-section-number">6.1.11</span> Mean prediction<a href="statistical-models.html#mean-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since</p>
<p><span class="math display">\[
\begin{align}
\mu_{\hat{Y}_0}&amp;=E(\hat{Y}_0)\\
&amp;=E(\hat{\beta}_1+\hat{\beta}_2X_0)\\
&amp;=\beta_1+\beta_2X_0\\
&amp;=E(Y|X_0)
\end{align}
\]</span>
and
<span class="math display">\[
\begin{align}
var(\hat{Y}_0)&amp;=\sigma^2_{\hat{Y}_0}\\
&amp;=E(\hat{\beta}_1+\hat{\beta}_2X_0)\\
&amp;=\sigma^2 \left( \frac{1}{n}+ \frac{(X_0-\bar{X})^2}{\sum{x_i^2}} \right)
\end{align}
\]</span>
therefore
<span class="math display">\[
\begin{align}
\hat{Y}_0&amp; \sim N(\mu_{\hat{Y}_0},\sigma^2_{\hat{Y}_0})\\
\hat{Y}_0&amp; \sim N \left(E(Y|X_0), \sigma^2 \left( \frac{1}{n}+ \frac{(X_0-\bar{X})^2}{\sum{x_i^2}} \right) \right)
\end{align}
\]</span></p>
<p>then <code>construct t statistic</code> to estimate CI
<span class="math display">\[
\begin{align}
t_{\hat{Y}_0}&amp; =\frac{\hat{Y}_0-E(Y|X_0)}{S_{\hat{Y}_0}} \sim t(n-2)
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\hat{Y}_0-t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0} \leq E(Y|X_0) \leq \hat{Y}_0+t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0}
\end{align}
\]</span></p>
</div>
<div id="individual-prediction" class="section level3 hasAnchor" number="6.1.12">
<h3><span class="header-section-number">6.1.12</span> Individual prediction<a href="statistical-models.html#individual-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since</p>
<p><span class="math display">\[
\begin{align}
(Y_0-\hat{Y}_0)&amp; \sim N \left(\mu_{(Y_0-\hat{Y}_0)},\sigma^2_{(Y_0-\hat{Y}_0)} \right)\\
(Y_0-\hat{Y}_0)&amp; \sim N \left(0, \sigma^2 \left(1+ \frac{1}{n}+ \frac{(X_0-\bar{X})^2}{\sum{x_i^2}} \right) \right)
\end{align}
\]</span></p>
<p>and <code>Construct t statistic</code>
<span class="math display">\[
\begin{align}
t_{\hat{Y}_0}&amp; =\frac{\hat{Y}_0-E(Y|X_0)}{S_{\hat{Y}_0}} \sim t(n-2)
\end{align}
\]</span></p>
<p>and
<span class="math display">\[
\begin{align}
S_{\hat{Y}_0}&amp; = \sqrt{\hat{\sigma}^2 \left( \frac{1}{n}+ \frac{(X_0-\bar{X})^2}{\sum{x_i^2}} \right)}
\end{align}
\]</span>
therefore</p>
<p><span class="math display">\[
\begin{align}
\hat{Y}_0-t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0} \leq E(Y|X_0) \leq \hat{Y}_0+t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0}
\end{align}
\]</span></p>
<p><code>it is harder to predict your weight based on your age than to predict the mean weight of people who are your age. so, the interval of individual prediction is wider than those of mean prediction.</code></p>
</div>
</div>
<div id="multiple-linear-regression" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Multiple linear regression<a href="statistical-models.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="matrix-format" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Matrix format<a href="statistical-models.html#matrix-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
Y_i&amp;=\beta_1+\beta_2X_{2i}+\beta_3X_{3i}+\cdots+\beta_kX_{ki}+u_i
&amp;&amp; \
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{equation}
  \begin{bmatrix}
  Y_1 \\  Y_2 \\  \cdots \\  Y_n \\
  \end{bmatrix}  =
  \begin{bmatrix}
  1 &amp;  X_{21} &amp; X_{31} &amp; \cdots &amp;  X_{k1} \\
  1 &amp;  X_{22} &amp; X_{32} &amp; \cdots &amp;  X_{k2} \\
  \cdots &amp;  \cdots &amp; \cdots &amp; \cdots &amp;  \cdots \\
  1 &amp;  X_{2n} &amp; X_{3n} &amp; \cdots &amp;  X_{kn}
  \end{bmatrix}
  \begin{bmatrix}
  \beta_1 \\  \beta_2 \\  \vdots \\  \beta_k \\
  \end{bmatrix}+
  \begin{bmatrix}
  u_1 \\  u_2 \\  \vdots \\  u_n \\
  \end{bmatrix}
\end{equation}
\]</span></p>
<p><span class="math display">\[
\begin{alignat}{4}
\mathbf{y} &amp;= &amp;\mathbf{X}&amp;\mathbf{\beta}&amp;+&amp;\mathbf{u}
\\
(n \times 1) &amp;  &amp;{(n \times k)} &amp;{(k \times 1)}&amp;+&amp;{(n \times 1)}
\end{alignat}
\]</span></p>
</div>
<div id="variance-covariance-matrix-of-random-errors" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Variance covariance matrix of random errors<a href="statistical-models.html#variance-covariance-matrix-of-random-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- $$ -->
<!-- \begin{align} -->
<!-- var-cov(\mathbf{u})&=E(\mathbf{uu'})\\ -->
<!-- &=E -->
<!--   \begin{bmatrix} -->
<!--   u_1\\  u_2\\ \vdots \\ u_n -->
<!--   \end{bmatrix} -->
<!--   \begin{bmatrix} -->
<!--   u_1 &  u_2& \cdots & u_n -->
<!--   \end{bmatrix}\\ -->
<!-- &=E -->
<!--   \begin{bmatrix} -->
<!--   u_1^2 & u_1u_2  &\cdots &u_1u_n\\ -->
<!--   u_2u_1 & u_2^2  &\cdots &u_2u_n\\ -->
<!--   \vdots & \vdots &\vdots &\vdots \\ -->
<!--   u_nu_1 & u_nu_2  &\cdots &u_n^2\\ -->
<!--   \end{bmatrix}\\ -->
<!-- &= -->
<!--   \begin{bmatrix} -->
<!--   E(u_1^2) & E(u_1u_2)  &\cdots &E(u_1u_n)\\ -->
<!--   E(u_2u_1) & E(u_2^2)  &\cdots &E(u_2u_n)\\ -->
<!--   \vdots & \vdots &\vdots &\vdots \\ -->
<!--   E(u_nu_1) &E(u_nu_2)  &\cdots &E(u_n^2)\\ -->
<!--   \end{bmatrix}\\ -->
<!-- \end{align} -->
<!-- $$ -->
<p>because
<span class="math display">\[
\mathbf{u} \sim N(\mathbf{0},\sigma^2\mathbf{I})\text{    population}\\
\mathbf{e} \sim N(\mathbf{0},\sigma^2\mathbf{I})\text{    sample}\
\]</span></p>
<p>therefore
<span class="math display">\[
\begin{align}
var-cov(\mathbf{u})&amp;=E(\mathbf{uu&#39;})\\
&amp;=
  \begin{bmatrix}
  \sigma_1^2 &amp; \sigma_{12}^2  &amp;\cdots &amp;\sigma_{1n}^2\\
  \sigma_{21}^2 &amp; \sigma_2^2  &amp;\cdots &amp;\sigma_{2n}^2\\
  \vdots &amp; \vdots &amp;\vdots &amp;\vdots \\
  \sigma_{n1}^2 &amp; \sigma_{n2}^2  &amp;\cdots &amp;\sigma_n^2\\
  \end{bmatrix}  
  &amp;&amp; \leftarrow (E{(u_i)}=0)\\
&amp;=
  \begin{bmatrix}
  \sigma^2 &amp; \sigma_{12}^2  &amp;\cdots &amp;\sigma_{1n}^2\\
  \sigma_{21}^2 &amp; \sigma^2  &amp;\cdots &amp;\sigma_{2n}^2\\
  \vdots &amp; \vdots &amp;\vdots &amp;\vdots \\
  \sigma_{n1}^2 &amp; \sigma_{n2}^2  &amp;\cdots &amp;\sigma^2\\
  \end{bmatrix}
  &amp;&amp; \leftarrow (var{(u_i)}=\sigma^2)\\
&amp;=
  \begin{bmatrix}
  \sigma^2 &amp; 0  &amp;\cdots &amp;0\\
  0 &amp; \sigma^2  &amp;\cdots &amp;0\\
  \vdots &amp; \vdots &amp;\vdots &amp;\vdots \\
  0 &amp; 0  &amp;\cdots &amp;\sigma^2\\
  \end{bmatrix}
  &amp;&amp; \leftarrow (cov{(u_i,u_j)}=0,i \neq j)\\
&amp;=\sigma^2
  \begin{bmatrix}
  1 &amp; 0  &amp;\cdots &amp;0\\
  0 &amp; 1  &amp;\cdots &amp;0\\
  \vdots &amp; \vdots &amp;\vdots &amp;\vdots \\
  0 &amp; 0  &amp;\cdots &amp;1\\
  \end{bmatrix}\\
&amp;=\sigma^2\mathbf{I}
\end{align}
\]</span></p>
</div>
<div id="minimize-q-sumy-haty2" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Minimize Q, <span class="math inline">\(\sum{(y-\hat{y})^2}\)</span><a href="statistical-models.html#minimize-q-sumy-haty2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
Q&amp;=\sum{e_i^2}\\
&amp;=\mathbf{e&#39;e}\\
&amp;=\mathbf{(y-X\hat{\beta})&#39;(y-X\hat{\beta})}\\
&amp;=\mathbf{y&#39;y-2\hat{\beta}&#39;X&#39;y+\hat{\beta}&#39;X&#39;X\hat{\beta}}
\end{align}
\]</span></p>
</div>
<div id="solve-hatbeta-by-derivation" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Solve <span class="math inline">\(\hat{\beta}\)</span> by derivation<a href="statistical-models.html#solve-hatbeta-by-derivation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(population=sample)</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial Q}{\partial \mathbf{\hat{\beta}}}&amp;=0\\
\frac{\partial(\mathbf{y&#39;y-2\hat{\beta}&#39;X&#39;y+\hat{\beta}&#39;X&#39;X\hat{\beta}})}{\partial \mathbf{\hat{\beta}}}&amp;=0\\
-2\mathbf{X&#39;y}+2\mathbf{X&#39;X\hat{\beta}}&amp;=0\\
-\mathbf{X&#39;y}+\mathbf{X&#39;X\hat{\beta}}&amp;=0\\
\mathbf{X&#39;X\hat{\beta}} &amp;=\mathbf{X&#39;y}
\end{align}
\]</span>
<span class="math display">\[
\begin{align}
\mathbf{\hat{\beta}} &amp;=\mathbf{(X&#39;X)^{-1}X&#39;y}
\end{align}
\]</span></p>
</div>
<div id="solve-hatsigma_beta2" class="section level3 hasAnchor" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Solve <span class="math inline">\(\hat{\sigma_\beta}^2\)</span><a href="statistical-models.html#solve-hatsigma_beta2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
var-cov(\mathbf{\hat{\beta}})
&amp;=\mathbf{E\left( \left(\hat{\beta}-E(\hat{\beta}) \right) \left( \hat{\beta}-E(\hat{\beta}) \right )&#39; \right)}\\
&amp;=\mathbf{E\left( \left(\hat{\beta}-{\beta} \right) \left( \hat{\beta}-\beta \right )&#39; \right)} \\
&amp;=\mathbf{E\left( \left((X&#39;X)^{-1}X&#39;u \right) \left( (X&#39;X)^{-1}X&#39;u \right )&#39; \right)} \\
&amp;=\mathbf{E\left( (X&#39;X)^{-1}X&#39;uu&#39;X(X&#39;X)^{-1}  \right)} \\
&amp;= \mathbf{(X&#39;X)^{-1}X&#39;E(uu&#39;)X(X&#39;X)^{-1}}   \\
&amp;= \mathbf{(X&#39;X)^{-1}X&#39;}\sigma^2\mathbf{IX(X&#39;X)^{-1}}   \\
&amp;= \sigma^2\mathbf{(X&#39;X)^{-1}X&#39;X(X&#39;X)^{-1}}   \\
&amp;= \sigma^2\mathbf{(X&#39;X)^{-1}}   \\
\end{align}
\]</span></p>
</div>
<div id="solve-s2mathbfhatbeta" class="section level3 hasAnchor" number="6.2.6">
<h3><span class="header-section-number">6.2.6</span> Solve <span class="math inline">\(S^2(\mathbf{\hat{\beta}})\)</span><a href="statistical-models.html#solve-s2mathbfhatbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(for sample)</p>
<p>where
<span class="math display">\[
\begin{align}
\hat{\sigma}^2&amp;=\frac{\sum{e_i^2}}{n-k}=\frac{\mathbf{e&#39;e}}{n-k} \\
E(\hat{\sigma}^2)&amp;=\sigma^2
\end{align}
\]</span></p>
<p>therefore
<span class="math display">\[
\begin{align}
S^2_{ij}(\mathbf{\hat{\beta}})
&amp;= \hat{\sigma}^2\mathbf{(X&#39;X)^{-1}}   \\
&amp;= \frac{\mathbf{e&#39;e}}{n-k}\mathbf{(X&#39;X)^{-1}}   \\
\end{align}
\]</span>
<code>which is variance-covariance of coefficients</code></p>
</div>
<div id="sum-of-squares-decomposition-matrix-format" class="section level3 hasAnchor" number="6.2.7">
<h3><span class="header-section-number">6.2.7</span> Sum of squares decomposition (matrix format)<a href="statistical-models.html#sum-of-squares-decomposition-matrix-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
TSS&amp;=\mathbf{y&#39;y}-n\bar{Y}^2 \\
RSS&amp;=\mathbf{ee&#39;}=\mathbf{yy&#39;-\hat{\beta}&#39;X&#39;y} \\
ESS&amp;=\mathbf{\hat{\beta}&#39;X&#39;y}-n\bar{Y}^2
\end{align}
\]</span></p>
</div>
<div id="determination-coefficient-r2-and-goodness-of-fit" class="section level3 hasAnchor" number="6.2.8">
<h3><span class="header-section-number">6.2.8</span> Determination coefficient <span class="math inline">\(R^2\)</span> and goodness of fit<a href="statistical-models.html#determination-coefficient-r2-and-goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{align}
R^2&amp;=\frac{ESS}{TSS}\\
&amp;=\frac{\mathbf{\hat{\beta}&#39;X&#39;y}-n\bar{Y}^2}{\mathbf{y&#39;y}-n\bar{Y}^2}
\end{align}
\]</span></p>
</div>
<div id="test-of-regression-coefficients-1" class="section level3 hasAnchor" number="6.2.9">
<h3><span class="header-section-number">6.2.9</span> Test of regression coefficients<a href="statistical-models.html#test-of-regression-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>because
<span class="math display">\[
\begin{align}
\mathbf{u}&amp;\sim N(\mathbf{0},\sigma^2\mathbf{I})  \\
\mathbf{\hat{\beta}} &amp;\sim N\left(\mathbf{\beta},\sigma^2\mathbf{X&#39;X}^{-1} \right)   \\
\end{align}
\]</span>
therefore</p>
<p><code>(for all coefficients test, vector, see above</code> <span class="math inline">\(S_{\hat{\beta}}^2\)</span> <code>)</code>
<span class="math display">\[
\begin{align}
\mathbf{t_{\hat{\beta}}}&amp;=\mathbf{\frac{\hat{\beta}-\beta}{S_{\hat{\beta}}}}
\sim \mathbf{t(n-k)}
\end{align}
\]</span></p>
<p><code>(for individual coefficient test)</code>
<span class="math display">\[
\begin{align}
\mathbf{t_{\hat{\beta}}^{\ast}}&amp;=\frac{\mathbf{\hat{\beta}}}{\mathbf{\sqrt{S^2_{ij}(\hat{\beta}_{kk})}}}
\end{align}
\]</span>
where
<span class="math display">\[
S^2_{ij}(\hat{\beta}_{kk})=[s^2_{\hat{\beta}_1},s^2_{\hat{\beta}_2},\cdots,s^2_{\hat{\beta}_k}]&#39;
\]</span></p>
<p><code>they are on diagonal line of the matrix of</code> <span class="math inline">\(S^2(\mathbf{\hat{\beta}})\)</span></p>
</div>
<div id="test-of-model" class="section level3 hasAnchor" number="6.2.10">
<h3><span class="header-section-number">6.2.10</span> Test of model<a href="statistical-models.html#test-of-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>unrestricted model
<span class="math display">\[
\begin{align}
u_i &amp;\sim i.i.d \ N(0,\sigma^2)\\
Y_i&amp;\sim i.i.d \ N(\beta_1+\beta_2X_i+\cdots+\beta_kX_i,\sigma^2)\\
RSS_U&amp;=\sum{(Y_i-\hat{Y_i})^2} \sim \chi^2(n-k) \\
\end{align}
\]</span>
restricted model
<span class="math display">\[
\begin{align}
u_i &amp;\sim i.i.d \ N(0,\sigma^2)\\
Y_i&amp;\sim i.i.d \ N(\beta_1,\sigma^2)\\
RSS_R&amp;=\sum{(Y_i-\hat{Y_i})^2} \sim \chi^2(n-1) \\
\end{align}
\]</span>
F test
<span class="math display">\[
\begin{align}
F^{\ast}&amp;=\frac{(RSS_R-RSS_U)/(k-1)}{RSS_U/(n-k)} \\
        &amp;=\frac{ESS_U/df_{ESS_U}}{RSS_U/df_{RSS_U}} \\
        &amp;\sim F(df_{ESS_U},df_{RSS_U})
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
F^{\ast}&amp;=\frac{ESS_U/df_{ESS_U}}{RSS_U/df_{RSS_U}}
=\frac{\left(\mathbf{\hat{\beta}&#39;X&#39;y}-n\bar{Y}^2  \right)/{(k-1)}}{\left(\mathbf{yy&#39;-\hat{\beta}&#39;X&#39;y}\right)/{(n-k)}}
\end{align}
\]</span></p>
</div>
<div id="mean-prediction-1" class="section level3 hasAnchor" number="6.2.11">
<h3><span class="header-section-number">6.2.11</span> Mean prediction<a href="statistical-models.html#mean-prediction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since
<span class="math display">\[
\begin{align}
E(\hat{Y}_0)&amp;=E\mathbf{(X_0\hat{\beta})}=\mathbf{X_0\beta}=E\mathbf{(Y_0)}\\
var(\hat{Y}_0)&amp;=E\mathbf{(X_0\hat{\beta}-X_0\beta)}^2\\
              &amp;=E\mathbf{\left( X_0(\hat{\beta}-\beta)(\hat{\beta}-\beta)&#39;X_0&#39; \right)}\\
              &amp;=E\mathbf{X_0\left( (\hat{\beta}-\beta)(\hat{\beta}-\beta)&#39; \right)X_0&#39;}\\
              &amp;=\sigma^2\mathbf{X_0\left( X&#39;X \right)^{-1}X_0&#39;}\\
\end{align}
\]</span>
and
<span class="math display">\[
\begin{align}
\hat{Y}_0&amp; \sim N(\mu_{\hat{Y}_0},\sigma^2_{\hat{Y}_0})\\
\hat{Y}_0&amp; \sim N\left(E(Y_0|X_0), \sigma^2\mathbf{X_0(X&#39;X)^{-1}X_0&#39;}\right)
\end{align}
\]</span>
<code>construct t statistic</code>
<span class="math display">\[
\begin{align}
t_{\hat{Y}_0}&amp; =\frac{\hat{Y}_0-E(Y|X_0)}{S_{\hat{Y}_0}}
&amp;\sim t(n-k)
\end{align}
\]</span></p>
<p>therefore
<span class="math display">\[
\begin{align}
\hat{Y}_0-t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0} \leq E(Y|X_0) \leq \hat{Y}_0+t_{1-\alpha/2}(n-2) \cdot S_{\hat{Y}_0}
\end{align}
\]</span></p>
<p>where
<span class="math display">\[
\begin{align}
\mathbf{S_{\hat{Y}_0}}
&amp;=\sqrt{\hat{\sigma}^2X_0(X&#39;X)^{-1}X_0&#39;} \\
\hat{\sigma}^2&amp;=\frac{\mathbf{ee&#39;}}{(n-k)}
\end{align}
\]</span></p>
</div>
<div id="individual-prediction-1" class="section level3 hasAnchor" number="6.2.12">
<h3><span class="header-section-number">6.2.12</span> Individual prediction<a href="statistical-models.html#individual-prediction-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since
<span class="math display">\[
\begin{align}
e_0&amp;=Y_0-\hat{Y}_0
\end{align}
\]</span></p>
<p>and
<span class="math display">\[
\begin{align}
E(e_0)&amp;=E(Y_0-\hat{Y}_0)\\
      &amp;=E(\mathbf{X_0\beta}+u_0-\mathbf{X_0\hat{\beta}})\\
      &amp;=E\left(u_0-\mathbf{X_0 (\hat{\beta}- \beta)} \right)\\
      &amp;=E\left(u_0-\mathbf{X_0 (X&#39;X)^{-1}X&#39;u} \right)\\
      &amp;=0
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
var(e_0)&amp;=E(Y_0-\hat{Y}_0)^2\\
        &amp;=E(e_0^2)\\
        &amp;=E\left(u_0-\mathbf{X_0 (X&#39;X)^{-1}X&#39;u} \right)^2\\
        &amp;=\sigma^2\left( 1+ \mathbf{X_0(X&#39;X)^{-1}X_0&#39;}\right)
\end{align}
\]</span></p>
<p>and<br />
<span class="math display">\[
\begin{align}
e_0&amp; \sim N(\mu_{e_0},\sigma^2_{e_0})\\
e_0&amp; \sim N\left(0, \sigma^2\left(1+\mathbf{X_0(X&#39;X)^{-1}X_0&#39;}\right)\right)
\end{align}
\]</span></p>
<p><code>construct a t statistic</code>
<span class="math display">\[
\begin{align}
t_{e_0}&amp; =\frac{\hat{Y}_0-Y_0}{S_{e_0}}
\sim t(n-k)
\end{align}
\]</span></p>
<p>therefore
<span class="math display">\[
\begin{align}
\hat{Y}_0-t_{1-\alpha/2}(n-2) \cdot S_{Y_0-\hat{Y}_0} \leq (Y_0|X_0) \leq \hat{Y}_0+t_{1-\alpha/2}(n-2) \cdot S_{Y_0-\hat{Y}_0}
\end{align}
\]</span></p>
<p>where
<span class="math display">\[
\begin{align}
S_{Y_0-\hat{Y}_0}=S_{e_0}
&amp;=\sqrt{\hat{\sigma}^2 \left( 1+X_0(X&#39;X)^{-1}X_0&#39; \right) } \\
\hat{\sigma}^2&amp;=\frac{\mathbf{ee&#39;}}{(n-k)}
\end{align}
\]</span></p>

</div>
</div>
<div id="multiple-linear-regression-practice" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Multiple linear regression practice<a href="statistical-models.html#multiple-linear-regression-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="statistical-models.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb664-2"><a href="statistical-models.html#cb664-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb664-3"><a href="statistical-models.html#cb664-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code></pre></div>
<div id="loading-and-describing-data" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Loading and describing data<a href="statistical-models.html#loading-and-describing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="statistical-models.html#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Boston)</span>
<span id="cb665-2"><a href="statistical-models.html#cb665-2" aria-hidden="true" tabindex="-1"></a>data_ori <span class="ot">&lt;-</span> Boston</span>
<span id="cb665-3"><a href="statistical-models.html#cb665-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(data_ori)</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="3%" />
<col width="2%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">vars</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">median</th>
<th align="right">trimmed</th>
<th align="right">mad</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">range</th>
<th align="right">skew</th>
<th align="right">kurtosis</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">crim</td>
<td align="right">1</td>
<td align="right">506</td>
<td align="right">3.6135236</td>
<td align="right">8.6015451</td>
<td align="right">0.25651</td>
<td align="right">1.6816300</td>
<td align="right">0.3283218</td>
<td align="right">0.00632</td>
<td align="right">88.9762</td>
<td align="right">88.96988</td>
<td align="right">5.1922223</td>
<td align="right">36.5958159</td>
<td align="right">0.3823853</td>
</tr>
<tr class="even">
<td align="left">zn</td>
<td align="right">2</td>
<td align="right">506</td>
<td align="right">11.3636364</td>
<td align="right">23.3224530</td>
<td align="right">0.00000</td>
<td align="right">5.0800493</td>
<td align="right">0.0000000</td>
<td align="right">0.00000</td>
<td align="right">100.0000</td>
<td align="right">100.00000</td>
<td align="right">2.2124881</td>
<td align="right">3.9523873</td>
<td align="right">1.0368095</td>
</tr>
<tr class="odd">
<td align="left">indus</td>
<td align="right">3</td>
<td align="right">506</td>
<td align="right">11.1367787</td>
<td align="right">6.8603529</td>
<td align="right">9.69000</td>
<td align="right">10.9318719</td>
<td align="right">9.3700320</td>
<td align="right">0.46000</td>
<td align="right">27.7400</td>
<td align="right">27.28000</td>
<td align="right">0.2932747</td>
<td align="right">-1.2401949</td>
<td align="right">0.3049799</td>
</tr>
<tr class="even">
<td align="left">chas</td>
<td align="right">4</td>
<td align="right">506</td>
<td align="right">0.0691700</td>
<td align="right">0.2539940</td>
<td align="right">0.00000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.00000</td>
<td align="right">1.0000</td>
<td align="right">1.00000</td>
<td align="right">3.3857377</td>
<td align="right">9.4819703</td>
<td align="right">0.0112914</td>
</tr>
<tr class="odd">
<td align="left">nox</td>
<td align="right">5</td>
<td align="right">506</td>
<td align="right">0.5546951</td>
<td align="right">0.1158777</td>
<td align="right">0.53800</td>
<td align="right">0.5450601</td>
<td align="right">0.1297275</td>
<td align="right">0.38500</td>
<td align="right">0.8710</td>
<td align="right">0.48600</td>
<td align="right">0.7249897</td>
<td align="right">-0.0874106</td>
<td align="right">0.0051514</td>
</tr>
<tr class="even">
<td align="left">rm</td>
<td align="right">6</td>
<td align="right">506</td>
<td align="right">6.2846344</td>
<td align="right">0.7026171</td>
<td align="right">6.20850</td>
<td align="right">6.2528744</td>
<td align="right">0.5122383</td>
<td align="right">3.56100</td>
<td align="right">8.7800</td>
<td align="right">5.21900</td>
<td align="right">0.4012223</td>
<td align="right">1.8418324</td>
<td align="right">0.0312351</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">7</td>
<td align="right">506</td>
<td align="right">68.5749012</td>
<td align="right">28.1488614</td>
<td align="right">77.50000</td>
<td align="right">71.1960591</td>
<td align="right">28.9848300</td>
<td align="right">2.90000</td>
<td align="right">100.0000</td>
<td align="right">97.10000</td>
<td align="right">-0.5954162</td>
<td align="right">-0.9780297</td>
<td align="right">1.2513695</td>
</tr>
<tr class="even">
<td align="left">dis</td>
<td align="right">8</td>
<td align="right">506</td>
<td align="right">3.7950427</td>
<td align="right">2.1057101</td>
<td align="right">3.20745</td>
<td align="right">3.5393786</td>
<td align="right">1.9142590</td>
<td align="right">1.12960</td>
<td align="right">12.1265</td>
<td align="right">10.99690</td>
<td align="right">1.0057898</td>
<td align="right">0.4575916</td>
<td align="right">0.0936102</td>
</tr>
<tr class="odd">
<td align="left">rad</td>
<td align="right">9</td>
<td align="right">506</td>
<td align="right">9.5494071</td>
<td align="right">8.7072594</td>
<td align="right">5.00000</td>
<td align="right">8.7339901</td>
<td align="right">2.9652000</td>
<td align="right">1.00000</td>
<td align="right">24.0000</td>
<td align="right">23.00000</td>
<td align="right">0.9988651</td>
<td align="right">-0.8789291</td>
<td align="right">0.3870849</td>
</tr>
<tr class="even">
<td align="left">tax</td>
<td align="right">10</td>
<td align="right">506</td>
<td align="right">408.2371542</td>
<td align="right">168.5371161</td>
<td align="right">330.00000</td>
<td align="right">400.0443350</td>
<td align="right">108.2298000</td>
<td align="right">187.00000</td>
<td align="right">711.0000</td>
<td align="right">524.00000</td>
<td align="right">0.6659891</td>
<td align="right">-1.1503176</td>
<td align="right">7.4923887</td>
</tr>
<tr class="odd">
<td align="left">ptratio</td>
<td align="right">11</td>
<td align="right">506</td>
<td align="right">18.4555336</td>
<td align="right">2.1649455</td>
<td align="right">19.05000</td>
<td align="right">18.6625616</td>
<td align="right">1.7049900</td>
<td align="right">12.60000</td>
<td align="right">22.0000</td>
<td align="right">9.40000</td>
<td align="right">-0.7975743</td>
<td align="right">-0.3048010</td>
<td align="right">0.0962436</td>
</tr>
<tr class="even">
<td align="left">black</td>
<td align="right">12</td>
<td align="right">506</td>
<td align="right">356.6740316</td>
<td align="right">91.2948644</td>
<td align="right">391.44000</td>
<td align="right">383.1695074</td>
<td align="right">8.0949960</td>
<td align="right">0.32000</td>
<td align="right">396.9000</td>
<td align="right">396.58000</td>
<td align="right">-2.8732597</td>
<td align="right">7.1037150</td>
<td align="right">4.0585518</td>
</tr>
<tr class="odd">
<td align="left">lstat</td>
<td align="right">13</td>
<td align="right">506</td>
<td align="right">12.6530632</td>
<td align="right">7.1410615</td>
<td align="right">11.36000</td>
<td align="right">11.8990394</td>
<td align="right">7.1090670</td>
<td align="right">1.73000</td>
<td align="right">37.9700</td>
<td align="right">36.24000</td>
<td align="right">0.9010929</td>
<td align="right">0.4628171</td>
<td align="right">0.3174589</td>
</tr>
<tr class="even">
<td align="left">medv</td>
<td align="right">14</td>
<td align="right">506</td>
<td align="right">22.5328063</td>
<td align="right">9.1971041</td>
<td align="right">21.20000</td>
<td align="right">21.5623153</td>
<td align="right">5.9304000</td>
<td align="right">5.00000</td>
<td align="right">50.0000</td>
<td align="right">45.00000</td>
<td align="right">1.1015373</td>
<td align="right">1.4509837</td>
<td align="right">0.4088611</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="statistical-models.html#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_ori)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="1%" />
<col width="8%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="6%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">crim</th>
<th align="left">zn</th>
<th align="left">indus</th>
<th align="left">chas</th>
<th align="left">nox</th>
<th align="left">rm</th>
<th align="left">age</th>
<th align="left">dis</th>
<th align="left">rad</th>
<th align="left">tax</th>
<th align="left">ptratio</th>
<th align="left">black</th>
<th align="left">lstat</th>
<th align="left">medv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Min. : 0.00632</td>
<td align="left">Min. : 0.00</td>
<td align="left">Min. : 0.46</td>
<td align="left">Min. :0.00000</td>
<td align="left">Min. :0.3850</td>
<td align="left">Min. :3.561</td>
<td align="left">Min. : 2.90</td>
<td align="left">Min. : 1.130</td>
<td align="left">Min. : 1.000</td>
<td align="left">Min. :187.0</td>
<td align="left">Min. :12.60</td>
<td align="left">Min. : 0.32</td>
<td align="left">Min. : 1.73</td>
<td align="left">Min. : 5.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">1st Qu.: 0.08205</td>
<td align="left">1st Qu.: 0.00</td>
<td align="left">1st Qu.: 5.19</td>
<td align="left">1st Qu.:0.00000</td>
<td align="left">1st Qu.:0.4490</td>
<td align="left">1st Qu.:5.886</td>
<td align="left">1st Qu.: 45.02</td>
<td align="left">1st Qu.: 2.100</td>
<td align="left">1st Qu.: 4.000</td>
<td align="left">1st Qu.:279.0</td>
<td align="left">1st Qu.:17.40</td>
<td align="left">1st Qu.:375.38</td>
<td align="left">1st Qu.: 6.95</td>
<td align="left">1st Qu.:17.02</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Median : 0.25651</td>
<td align="left">Median : 0.00</td>
<td align="left">Median : 9.69</td>
<td align="left">Median :0.00000</td>
<td align="left">Median :0.5380</td>
<td align="left">Median :6.208</td>
<td align="left">Median : 77.50</td>
<td align="left">Median : 3.207</td>
<td align="left">Median : 5.000</td>
<td align="left">Median :330.0</td>
<td align="left">Median :19.05</td>
<td align="left">Median :391.44</td>
<td align="left">Median :11.36</td>
<td align="left">Median :21.20</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Mean : 3.61352</td>
<td align="left">Mean : 11.36</td>
<td align="left">Mean :11.14</td>
<td align="left">Mean :0.06917</td>
<td align="left">Mean :0.5547</td>
<td align="left">Mean :6.285</td>
<td align="left">Mean : 68.57</td>
<td align="left">Mean : 3.795</td>
<td align="left">Mean : 9.549</td>
<td align="left">Mean :408.2</td>
<td align="left">Mean :18.46</td>
<td align="left">Mean :356.67</td>
<td align="left">Mean :12.65</td>
<td align="left">Mean :22.53</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3rd Qu.: 3.67708</td>
<td align="left">3rd Qu.: 12.50</td>
<td align="left">3rd Qu.:18.10</td>
<td align="left">3rd Qu.:0.00000</td>
<td align="left">3rd Qu.:0.6240</td>
<td align="left">3rd Qu.:6.623</td>
<td align="left">3rd Qu.: 94.08</td>
<td align="left">3rd Qu.: 5.188</td>
<td align="left">3rd Qu.:24.000</td>
<td align="left">3rd Qu.:666.0</td>
<td align="left">3rd Qu.:20.20</td>
<td align="left">3rd Qu.:396.23</td>
<td align="left">3rd Qu.:16.95</td>
<td align="left">3rd Qu.:25.00</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Max. :88.97620</td>
<td align="left">Max. :100.00</td>
<td align="left">Max. :27.74</td>
<td align="left">Max. :1.00000</td>
<td align="left">Max. :0.8710</td>
<td align="left">Max. :8.780</td>
<td align="left">Max. :100.00</td>
<td align="left">Max. :12.127</td>
<td align="left">Max. :24.000</td>
<td align="left">Max. :711.0</td>
<td align="left">Max. :22.00</td>
<td align="left">Max. :396.90</td>
<td align="left">Max. :37.97</td>
<td align="left">Max. :50.00</td>
</tr>
</tbody>
</table>
</div>
<div id="create-table-1" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Create table 1<a href="statistical-models.html#create-table-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="statistical-models.html#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) </span>
<span id="cb667-2"><a href="statistical-models.html#cb667-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(table1)</span>
<span id="cb667-3"><a href="statistical-models.html#cb667-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table1</span>(<span class="sc">~</span> . , <span class="at">data=</span>data_ori)</span></code></pre></div>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=506)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'>crim</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>3.61 (8.60)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>0.257 [0.00632, 89.0]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>zn</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>11.4 (23.3)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>0 [0, 100]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>indus</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>11.1 (6.86)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>9.69 [0.460, 27.7]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>chas</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>0.0692 (0.254)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>0 [0, 1.00]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>nox</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>0.555 (0.116)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>0.538 [0.385, 0.871]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>rm</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>6.28 (0.703)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>6.21 [3.56, 8.78]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>age</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>68.6 (28.1)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>77.5 [2.90, 100]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>dis</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>3.80 (2.11)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>3.21 [1.13, 12.1]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>rad</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>9.55 (8.71)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>5.00 [1.00, 24.0]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>tax</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>408 (169)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>330 [187, 711]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>ptratio</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>18.5 (2.16)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>19.1 [12.6, 22.0]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>black</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>357 (91.3)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>391 [0.320, 397]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>lstat</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>12.7 (7.14)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>11.4 [1.73, 38.0]</td>
</tr>
<tr>
<td class='rowlabel firstrow'>medv</td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>22.5 (9.20)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>21.2 [5.00, 50.0]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="missingness-checking" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Missingness checking<a href="statistical-models.html#missingness-checking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="statistical-models.html#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb668-2"><a href="statistical-models.html#cb668-2" aria-hidden="true" tabindex="-1"></a><span class="fu">md.pattern</span>(data_ori)</span></code></pre></div>
<pre><code>##  /\     /\
## {  `---&#39;  }
## {  O   O  }
## ==&gt;  V &lt;==  No need for mice. This data set is completely observed.
##  \  \|/  /
##   `-----&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<table style="width:100%;">
<colgroup>
<col width="5%" />
<col width="6%" />
<col width="4%" />
<col width="8%" />
<col width="6%" />
<col width="5%" />
<col width="4%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="6%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">crim</th>
<th align="right">zn</th>
<th align="right">indus</th>
<th align="right">chas</th>
<th align="right">nox</th>
<th align="right">rm</th>
<th align="right">age</th>
<th align="right">dis</th>
<th align="right">rad</th>
<th align="right">tax</th>
<th align="right">ptratio</th>
<th align="right">black</th>
<th align="right">lstat</th>
<th align="right">medv</th>
<th align="right"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">506</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="exploratory-data-analysis" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Exploratory data analysis<a href="statistical-models.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>-correlation matrix</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="statistical-models.html#cb670-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb670-2"><a href="statistical-models.html#cb670-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(data_ori)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-345-1.png" width="672" /></p>
<ul>
<li>histogram</li>
</ul>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="statistical-models.html#cb671-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb671-2"><a href="statistical-models.html#cb671-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(data_ori)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-346-1.png" width="672" /></p>
</div>
<div id="transformations" class="section level3 hasAnchor" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Transformations<a href="statistical-models.html#transformations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>transformation (based on the following rule) then histogram</li>
</ul>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="statistical-models.html#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb672-2"><a href="statistical-models.html#cb672-2" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">=</span> data_ori <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">age=</span> <span class="fu">sqrt</span>(<span class="fu">max</span>(age)<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>age),</span>
<span id="cb672-3"><a href="statistical-models.html#cb672-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">black=</span> <span class="fu">log10</span>(<span class="fu">max</span>(black)<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>black),</span>
<span id="cb672-4"><a href="statistical-models.html#cb672-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crim=</span> <span class="fu">log10</span>(crim),</span>
<span id="cb672-5"><a href="statistical-models.html#cb672-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dis=</span> <span class="fu">sqrt</span>(dis)   )</span>
<span id="cb672-6"><a href="statistical-models.html#cb672-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(data_trans)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-347-1.png" width="672" /></p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="statistical-models.html#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs.panels(data2)</span></span></code></pre></div>
<p>! <a href="https://www.statisticssolutions.com/wp-content/uploads/2018/12/b2.png">How to transform data for normality.</a></p>
<ul>
<li>check linearity between <code>y and x</code></li>
</ul>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="statistical-models.html#cb674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data_trans)</span>
<span id="cb674-2"><a href="statistical-models.html#cb674-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv, rm)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-1.png" width="672" /></p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="statistical-models.html#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv,lstat)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-2.png" width="672" /></p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="statistical-models.html#cb676-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv,age)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-3.png" width="672" /></p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="statistical-models.html#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv, black)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-4.png" width="672" /></p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="statistical-models.html#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv,crim)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-348-5.png" width="672" /></p>
</div>
<div id="data-imputation-and-normalization" class="section level3 hasAnchor" number="6.3.6">
<h3><span class="header-section-number">6.3.6</span> Data imputation and normalization<a href="statistical-models.html#data-imputation-and-normalization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="for-originaldata" class="section level4 hasAnchor" number="6.3.6.1">
<h4><span class="header-section-number">6.3.6.1</span> For original”data”<a href="statistical-models.html#for-originaldata" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>compiling knnimpute model (see machine learning section)</li>
</ul>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="statistical-models.html#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb679-2"><a href="statistical-models.html#cb679-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the knn imputation model on the training data</span></span>
<span id="cb679-3"><a href="statistical-models.html#cb679-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>data_ori<span class="sc">$</span>medv</span>
<span id="cb679-4"><a href="statistical-models.html#cb679-4" aria-hidden="true" tabindex="-1"></a>preProcess_missingdata_model <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(data_ori , <span class="at">method=</span><span class="st">&#39;knnImpute&#39;</span>)</span>
<span id="cb679-5"><a href="statistical-models.html#cb679-5" aria-hidden="true" tabindex="-1"></a>preProcess_missingdata_model</span></code></pre></div>
<pre><code>## Created from 506 samples and 14 variables
## 
## Pre-processing:
##   - centered (14)
##   - ignored (0)
##   - 5 nearest neighbor imputation (14)
##   - scaled (14)</code></pre>
<ul>
<li>check missingness</li>
</ul>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="statistical-models.html#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the imputation model to predict the values of missing data points</span></span>
<span id="cb681-2"><a href="statistical-models.html#cb681-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)  <span class="co"># required for knnInpute</span></span>
<span id="cb681-3"><a href="statistical-models.html#cb681-3" aria-hidden="true" tabindex="-1"></a>data_ori  <span class="ot">&lt;-</span> <span class="fu">predict</span>(preProcess_missingdata_model, <span class="at">newdata =</span> data_ori )</span>
<span id="cb681-4"><a href="statistical-models.html#cb681-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(data_ori )</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="statistical-models.html#cb683-1" aria-hidden="true" tabindex="-1"></a>data_ori<span class="sc">$</span>medv <span class="ot">&lt;-</span> y</span></code></pre></div>
</div>
<div id="for-transformed-data2" class="section level4 hasAnchor" number="6.3.6.2">
<h4><span class="header-section-number">6.3.6.2</span> For transformed “data2”<a href="statistical-models.html#for-transformed-data2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>compiling knnimpute model (see machine learning section)</li>
</ul>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="statistical-models.html#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb684-2"><a href="statistical-models.html#cb684-2" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">=</span>data_trans<span class="sc">$</span>medv</span>
<span id="cb684-3"><a href="statistical-models.html#cb684-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the knn imputation model on the training data</span></span>
<span id="cb684-4"><a href="statistical-models.html#cb684-4" aria-hidden="true" tabindex="-1"></a>preProcess_missingdata_model2 <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(data_trans , <span class="at">method=</span><span class="st">&#39;knnImpute&#39;</span>)</span>
<span id="cb684-5"><a href="statistical-models.html#cb684-5" aria-hidden="true" tabindex="-1"></a>preProcess_missingdata_model2</span></code></pre></div>
<pre><code>## Created from 506 samples and 14 variables
## 
## Pre-processing:
##   - centered (14)
##   - ignored (0)
##   - 5 nearest neighbor imputation (14)
##   - scaled (14)</code></pre>
<ul>
<li>check missingness</li>
</ul>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="statistical-models.html#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the imputation model to predict the values of missing data points</span></span>
<span id="cb686-2"><a href="statistical-models.html#cb686-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)  <span class="co"># required for knnInpute</span></span>
<span id="cb686-3"><a href="statistical-models.html#cb686-3" aria-hidden="true" tabindex="-1"></a>data_trans  <span class="ot">&lt;-</span> <span class="fu">predict</span>(preProcess_missingdata_model2, <span class="at">newdata =</span> data_trans )</span>
<span id="cb686-4"><a href="statistical-models.html#cb686-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(data_trans )</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="statistical-models.html#cb688-1" aria-hidden="true" tabindex="-1"></a>data_trans<span class="sc">$</span>medv <span class="ot">&lt;-</span> y2</span></code></pre></div>
</div>
</div>
<div id="generate-dummy-variables" class="section level3 hasAnchor" number="6.3.7">
<h3><span class="header-section-number">6.3.7</span> Generate dummy variables<a href="statistical-models.html#generate-dummy-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>also can do using <code>as.factor</code> function for predictors <code>x</code></li>
</ul>
</div>
<div id="spliting-data-into-trainning-data-and-test-data" class="section level3 hasAnchor" number="6.3.8">
<h3><span class="header-section-number">6.3.8</span> Spliting data into trainning data and test data<a href="statistical-models.html#spliting-data-into-trainning-data-and-test-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>by using <code>caret</code> package (test data for external validation)</li>
</ul>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="statistical-models.html#cb689-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the training and test datasets</span></span>
<span id="cb689-2"><a href="statistical-models.html#cb689-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb689-3"><a href="statistical-models.html#cb689-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for original data </span></span>
<span id="cb689-4"><a href="statistical-models.html#cb689-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get row numbers for the training data</span></span>
<span id="cb689-5"><a href="statistical-models.html#cb689-5" aria-hidden="true" tabindex="-1"></a>trainRowNumbers <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(data_ori<span class="sc">$</span>medv, <span class="at">p=</span><span class="fl">0.8</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb689-6"><a href="statistical-models.html#cb689-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-7"><a href="statistical-models.html#cb689-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create the training  dataset</span></span>
<span id="cb689-8"><a href="statistical-models.html#cb689-8" aria-hidden="true" tabindex="-1"></a>data  <span class="ot">&lt;-</span> data_ori[trainRowNumbers,]</span>
<span id="cb689-9"><a href="statistical-models.html#cb689-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-10"><a href="statistical-models.html#cb689-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the test dataset</span></span>
<span id="cb689-11"><a href="statistical-models.html#cb689-11" aria-hidden="true" tabindex="-1"></a>testdata  <span class="ot">&lt;-</span> data_ori[<span class="sc">-</span>trainRowNumbers,]</span>
<span id="cb689-12"><a href="statistical-models.html#cb689-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-13"><a href="statistical-models.html#cb689-13" aria-hidden="true" tabindex="-1"></a><span class="co"># for transformed data</span></span>
<span id="cb689-14"><a href="statistical-models.html#cb689-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get row numbers for the training data</span></span>
<span id="cb689-15"><a href="statistical-models.html#cb689-15" aria-hidden="true" tabindex="-1"></a>trainRowNumbers2 <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(data_trans<span class="sc">$</span>medv, <span class="at">p=</span><span class="fl">0.8</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb689-16"><a href="statistical-models.html#cb689-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-17"><a href="statistical-models.html#cb689-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create the training  dataset</span></span>
<span id="cb689-18"><a href="statistical-models.html#cb689-18" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data_trans[trainRowNumbers2,]</span>
<span id="cb689-19"><a href="statistical-models.html#cb689-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-20"><a href="statistical-models.html#cb689-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Create the test dataset</span></span>
<span id="cb689-21"><a href="statistical-models.html#cb689-21" aria-hidden="true" tabindex="-1"></a>testdata2 <span class="ot">&lt;-</span> data_trans[<span class="sc">-</span>trainRowNumbers2,]</span></code></pre></div>
</div>
<div id="step-regression" class="section level3 hasAnchor" number="6.3.9">
<h3><span class="header-section-number">6.3.9</span> Step regression<a href="statistical-models.html#step-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="statistical-models.html#cb690-1" aria-hidden="true" tabindex="-1"></a>model_o <span class="ot">=</span> <span class="fu">lm</span>(  medv <span class="sc">~</span>.  , <span class="at">data=</span>data2)</span>
<span id="cb690-2"><a href="statistical-models.html#cb690-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(model_o,<span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1281.15
## medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + 
##     tax + ptratio + black + lstat
## 
##           Df Sum of Sq     RSS    AIC
## - black    1      0.17  8847.0 1279.2
## - age      1      7.07  8853.9 1279.5
## - crim     1     14.36  8861.2 1279.8
## - indus    1     24.08  8870.9 1280.3
## &lt;none&gt;                  8846.8 1281.2
## - rad      1    103.22  8950.0 1283.9
## - tax      1    156.33  9003.1 1286.3
## - zn       1    198.34  9045.2 1288.2
## - chas     1    251.31  9098.1 1290.5
## - nox      1    692.00  9538.8 1309.8
## - ptratio  1    840.04  9686.9 1316.1
## - rm       1    965.90  9812.7 1321.3
## - dis      1   1349.41 10196.2 1336.9
## - lstat    1   2766.14 11613.0 1389.9
## 
## Step:  AIC=1279.16
## medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + 
##     tax + ptratio + lstat
## 
##           Df Sum of Sq     RSS    AIC
## - age      1      7.15  8854.1 1277.5
## - crim     1     14.32  8861.3 1277.8
## - indus    1     24.52  8871.5 1278.3
## &lt;none&gt;                  8847.0 1279.2
## + black    1      0.17  8846.8 1281.2
## - rad      1    103.72  8950.7 1281.9
## - tax      1    157.40  9004.4 1284.3
## - zn       1    198.20  9045.2 1286.2
## - chas     1    251.25  9098.2 1288.6
## - nox      1    695.37  9542.4 1308.0
## - ptratio  1    850.76  9697.7 1314.5
## - rm       1    966.99  9814.0 1319.4
## - dis      1   1375.04 10222.0 1336.0
## - lstat    1   2770.28 11617.3 1388.0
## 
## Step:  AIC=1277.49
## medv ~ crim + zn + indus + chas + nox + rm + dis + rad + tax + 
##     ptratio + lstat
## 
##           Df Sum of Sq     RSS    AIC
## - crim     1     18.36  8872.5 1276.3
## - indus    1     25.56  8879.7 1276.7
## &lt;none&gt;                  8854.1 1277.5
## + age      1      7.15  8847.0 1279.2
## + black    1      0.26  8853.9 1279.5
## - rad      1     97.20  8951.3 1279.9
## - tax      1    152.93  9007.1 1282.5
## - zn       1    196.76  9050.9 1284.4
## - chas     1    255.17  9109.3 1287.0
## - nox      1    694.68  9548.8 1306.2
## - ptratio  1    843.66  9697.8 1312.5
## - rm       1   1023.40  9877.5 1320.0
## - dis      1   1633.60 10487.7 1344.4
## - lstat    1   2978.57 11832.7 1393.5
## 
## Step:  AIC=1276.33
## medv ~ zn + indus + chas + nox + rm + dis + rad + tax + ptratio + 
##     lstat
## 
##           Df Sum of Sq     RSS    AIC
## - indus    1     21.92  8894.4 1275.3
## &lt;none&gt;                  8872.5 1276.3
## + crim     1     18.36  8854.1 1277.5
## + age      1     11.19  8861.3 1277.8
## + black    1      0.13  8872.4 1278.3
## - tax      1    158.39  9030.9 1281.5
## - zn       1    180.19  9052.7 1282.5
## - rad      1    212.19  9084.7 1284.0
## - chas     1    249.50  9122.0 1285.6
## - nox      1    689.33  9561.8 1304.8
## - ptratio  1    873.78  9746.3 1312.6
## - rm       1   1025.43  9897.9 1318.8
## - dis      1   1701.37 10573.9 1345.7
## - lstat    1   2996.77 11869.3 1392.8
## 
## Step:  AIC=1275.34
## medv ~ zn + chas + nox + rm + dis + rad + tax + ptratio + lstat
## 
##           Df Sum of Sq     RSS    AIC
## &lt;none&gt;                  8894.4 1275.3
## + indus    1     21.92  8872.5 1276.3
## + crim     1     14.72  8879.7 1276.7
## + age      1     11.89  8882.5 1276.8
## + black    1      0.00  8894.4 1277.3
## - zn       1    206.52  9100.9 1282.7
## - chas     1    237.50  9131.9 1284.1
## - tax      1    281.42  9175.8 1286.0
## - rad      1    293.27  9187.7 1286.5
## - nox      1    800.54  9695.0 1308.4
## - ptratio  1    929.05  9823.5 1313.8
## - rm       1   1083.34  9977.8 1320.1
## - dis      1   1706.94 10601.4 1344.8
## - lstat    1   3024.07 11918.5 1392.5</code></pre>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + nox + rm + dis + rad + tax + 
##     ptratio + lstat, data = data2)
## 
## Coefficients:
## (Intercept)           zn         chas          nox           rm          dis  
##      22.509        1.016        0.759       -2.764        2.176       -3.970  
##         rad          tax      ptratio        lstat  
##       2.119       -2.317       -1.991       -4.224</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="statistical-models.html#cb693-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(step(model_o,direction = &quot;both&quot;))</span></span></code></pre></div>
</div>
<div id="create-a-model-after-selecting-variables" class="section level3 hasAnchor" number="6.3.10">
<h3><span class="header-section-number">6.3.10</span> Create a model after selecting variables<a href="statistical-models.html#create-a-model-after-selecting-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="statistical-models.html#cb694-1" aria-hidden="true" tabindex="-1"></a>model_trasf <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span> rm <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb694-2"><a href="statistical-models.html#cb694-2" aria-hidden="true" tabindex="-1"></a>    ptratio <span class="sc">+</span> lstat, <span class="at">data =</span> data2)</span>
<span id="cb694-3"><a href="statistical-models.html#cb694-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_trasf)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + nox + rm + dis + rad + tax + 
##     ptratio + lstat, data = data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.2923  -2.4690  -0.5086   1.6269  24.5813 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  22.5090     0.2352  95.718  &lt; 2e-16 ***
## zn            1.0161     0.3347   3.036 0.002554 ** 
## chas          0.7590     0.2331   3.256 0.001227 ** 
## nox          -2.7640     0.4624  -5.978 5.05e-09 ***
## rm            2.1760     0.3129   6.954 1.47e-11 ***
## dis          -3.9697     0.4548  -8.729  &lt; 2e-16 ***
## rad           2.1194     0.5858   3.618 0.000335 ***
## tax          -2.3171     0.6538  -3.544 0.000441 ***
## ptratio      -1.9909     0.3092  -6.440 3.47e-10 ***
## lstat        -4.2244     0.3636 -11.618  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.733 on 397 degrees of freedom
## Multiple R-squared:  0.7187, Adjusted R-squared:  0.7123 
## F-statistic: 112.7 on 9 and 397 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="multicollinearity-checking" class="section level3 hasAnchor" number="6.3.11">
<h3><span class="header-section-number">6.3.11</span> Multicollinearity checking<a href="statistical-models.html#multicollinearity-checking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="statistical-models.html#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model_trasf)</span></code></pre></div>
<pre><code>##       zn     chas      nox       rm      dis      rad      tax  ptratio 
## 2.024269 1.044796 4.074241 1.721080 3.759267 6.008751 7.469414 1.743359 
##    lstat 
## 2.372125</code></pre>
</div>
<div id="plot-model-to-check-assumptions" class="section level3 hasAnchor" number="6.3.12">
<h3><span class="header-section-number">6.3.12</span> Plot model to check assumptions<a href="statistical-models.html#plot-model-to-check-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="statistical-models.html#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_trasf)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-357-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-357-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-357-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-357-4.png" width="672" /></p>
<ul>
<li>histogram of residuals</li>
</ul>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="statistical-models.html#cb699-1" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span> model_trasf<span class="sc">$</span>residuals</span>
<span id="cb699-2"><a href="statistical-models.html#cb699-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(resid)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-358-1.png" width="672" /></p>
<ul>
<li>F test of model</li>
</ul>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="statistical-models.html#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_trasf)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">zn</td>
<td align="right">1</td>
<td align="right">4019.0308</td>
<td align="right">4019.03076</td>
<td align="right">179.38831</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">chas</td>
<td align="right">1</td>
<td align="right">1011.5766</td>
<td align="right">1011.57663</td>
<td align="right">45.15144</td>
<td align="right">0e+00</td>
</tr>
<tr class="odd">
<td align="left">nox</td>
<td align="right">1</td>
<td align="right">2785.8086</td>
<td align="right">2785.80857</td>
<td align="right">124.34378</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">rm</td>
<td align="right">1</td>
<td align="right">8487.0727</td>
<td align="right">8487.07268</td>
<td align="right">378.81810</td>
<td align="right">0e+00</td>
</tr>
<tr class="odd">
<td align="left">dis</td>
<td align="right">1</td>
<td align="right">951.7774</td>
<td align="right">951.77743</td>
<td align="right">42.48232</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">rad</td>
<td align="right">1</td>
<td align="right">558.8550</td>
<td align="right">558.85503</td>
<td align="right">24.94434</td>
<td align="right">9e-07</td>
</tr>
<tr class="odd">
<td align="left">tax</td>
<td align="right">1</td>
<td align="right">767.8718</td>
<td align="right">767.87176</td>
<td align="right">34.27374</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">ptratio</td>
<td align="right">1</td>
<td align="right">1119.3945</td>
<td align="right">1119.39453</td>
<td align="right">49.96386</td>
<td align="right">0e+00</td>
</tr>
<tr class="odd">
<td align="left">lstat</td>
<td align="right">1</td>
<td align="right">3024.0665</td>
<td align="right">3024.06652</td>
<td align="right">134.97836</td>
<td align="right">0e+00</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">397</td>
<td align="right">8894.4215</td>
<td align="right">22.40408</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<ul>
<li>coefficients</li>
</ul>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="statistical-models.html#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(model_trasf))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">22.5089571</td>
<td align="right">0.2351584</td>
<td align="right">95.718273</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">zn</td>
<td align="right">1.0160975</td>
<td align="right">0.3346703</td>
<td align="right">3.036115</td>
<td align="right">0.0025545</td>
</tr>
<tr class="odd">
<td align="left">chas</td>
<td align="right">0.7589909</td>
<td align="right">0.2331142</td>
<td align="right">3.255876</td>
<td align="right">0.0012275</td>
</tr>
<tr class="even">
<td align="left">nox</td>
<td align="right">-2.7639762</td>
<td align="right">0.4623875</td>
<td align="right">-5.977619</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">rm</td>
<td align="right">2.1760130</td>
<td align="right">0.3129267</td>
<td align="right">6.953747</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">dis</td>
<td align="right">-3.9697228</td>
<td align="right">0.4547944</td>
<td align="right">-8.728609</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">rad</td>
<td align="right">2.1193795</td>
<td align="right">0.5857829</td>
<td align="right">3.618029</td>
<td align="right">0.0003352</td>
</tr>
<tr class="even">
<td align="left">tax</td>
<td align="right">-2.3171470</td>
<td align="right">0.6537962</td>
<td align="right">-3.544143</td>
<td align="right">0.0004408</td>
</tr>
<tr class="odd">
<td align="left">ptratio</td>
<td align="right">-1.9908948</td>
<td align="right">0.3091666</td>
<td align="right">-6.439552</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">lstat</td>
<td align="right">-4.2244121</td>
<td align="right">0.3636086</td>
<td align="right">-11.618019</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<ul>
<li>confidence interval</li>
</ul>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="statistical-models.html#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_trasf)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">22.0466457</td>
<td align="right">22.971269</td>
</tr>
<tr class="even">
<td align="left">zn</td>
<td align="right">0.3581500</td>
<td align="right">1.674045</td>
</tr>
<tr class="odd">
<td align="left">chas</td>
<td align="right">0.3006983</td>
<td align="right">1.217283</td>
</tr>
<tr class="even">
<td align="left">nox</td>
<td align="right">-3.6730103</td>
<td align="right">-1.854942</td>
</tr>
<tr class="odd">
<td align="left">rm</td>
<td align="right">1.5608125</td>
<td align="right">2.791214</td>
</tr>
<tr class="even">
<td align="left">dis</td>
<td align="right">-4.8638292</td>
<td align="right">-3.075616</td>
</tr>
<tr class="odd">
<td align="left">rad</td>
<td align="right">0.9677553</td>
<td align="right">3.271004</td>
</tr>
<tr class="even">
<td align="left">tax</td>
<td align="right">-3.6024824</td>
<td align="right">-1.031812</td>
</tr>
<tr class="odd">
<td align="left">ptratio</td>
<td align="right">-2.5987032</td>
<td align="right">-1.383086</td>
</tr>
<tr class="even">
<td align="left">lstat</td>
<td align="right">-4.9392512</td>
<td align="right">-3.509573</td>
</tr>
</tbody>
</table>
</div>
<div id="add-polynomial-of-quadratic-term" class="section level3 hasAnchor" number="6.3.13">
<h3><span class="header-section-number">6.3.13</span> Add polynomial of quadratic term<a href="statistical-models.html#add-polynomial-of-quadratic-term" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>rm and lstat</code></li>
</ul>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="statistical-models.html#cb703-1" aria-hidden="true" tabindex="-1"></a>model_trasf_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span>  <span class="fu">I</span>(rm<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb703-2"><a href="statistical-models.html#cb703-2" aria-hidden="true" tabindex="-1"></a>    ptratio <span class="sc">+</span>   <span class="fu">I</span>(lstat<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data2)</span>
<span id="cb703-3"><a href="statistical-models.html#cb703-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_trasf_poly)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + nox + I(rm^2) + dis + rad + tax + 
##     ptratio + I(lstat^2), data = data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.0736  -3.4029  -0.6212   2.8340  29.4942 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  22.2859     0.3526  63.212  &lt; 2e-16 ***
## zn            1.5524     0.4096   3.790 0.000174 ***
## chas          0.9570     0.2834   3.377 0.000805 ***
## nox          -4.4962     0.5455  -8.242 2.50e-15 ***
## I(rm^2)       1.5313     0.1589   9.637  &lt; 2e-16 ***
## dis          -3.3186     0.5644  -5.880 8.69e-09 ***
## rad           3.0529     0.7024   4.346 1.76e-05 ***
## tax          -3.6647     0.7861  -4.662 4.28e-06 ***
## ptratio      -2.6800     0.3706  -7.232 2.47e-12 ***
## I(lstat^2)   -1.3170     0.1918  -6.865 2.56e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.763 on 397 degrees of freedom
## Multiple R-squared:  0.583,  Adjusted R-squared:  0.5735 
## F-statistic: 61.67 on 9 and 397 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="add-interaction-terms" class="section level3 hasAnchor" number="6.3.14">
<h3><span class="header-section-number">6.3.14</span> Add interaction terms<a href="statistical-models.html#add-interaction-terms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>rm and lstat</code></li>
<li>R2 &gt;0.7 indicates a good fit of the model</li>
</ul>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="statistical-models.html#cb705-1" aria-hidden="true" tabindex="-1"></a>model_trasf_term <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span>  (rm<span class="sc">*</span>  lstat) <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb705-2"><a href="statistical-models.html#cb705-2" aria-hidden="true" tabindex="-1"></a>    ptratio  , <span class="at">data =</span> data2)</span>
<span id="cb705-3"><a href="statistical-models.html#cb705-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_trasf_term)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + nox + (rm * lstat) + dis + rad + 
##     tax + ptratio, data = data2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.4595  -2.3458  -0.2389   1.7950  26.6992 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  21.4297     0.2379  90.060  &lt; 2e-16 ***
## zn            0.5221     0.3046   1.714 0.087296 .  
## chas          0.6538     0.2095   3.120 0.001941 ** 
## nox          -2.0295     0.4218  -4.812 2.13e-06 ***
## rm            1.6459     0.2860   5.754 1.75e-08 ***
## lstat        -5.8715     0.3669 -16.002  &lt; 2e-16 ***
## dis          -3.1810     0.4161  -7.645 1.60e-13 ***
## rad           1.9251     0.5262   3.658 0.000288 ***
## tax          -1.9187     0.5883  -3.261 0.001205 ** 
## ptratio      -1.5554     0.2811  -5.534 5.70e-08 ***
## rm:lstat     -1.8202     0.1852  -9.830  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.249 on 396 degrees of freedom
## Multiple R-squared:  0.7739, Adjusted R-squared:  0.7682 
## F-statistic: 135.5 on 10 and 396 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="statistical-models.html#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_trasf_term)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-364-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-364-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-364-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-364-4.png" width="672" /></p>
</div>
<div id="robust-regression" class="section level3 hasAnchor" number="6.3.15">
<h3><span class="header-section-number">6.3.15</span> Robust regression<a href="statistical-models.html#robust-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="statistical-models.html#cb708-1" aria-hidden="true" tabindex="-1"></a>robust_model_term <span class="ot">&lt;-</span> <span class="fu">rlm</span>(medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span>  (rm<span class="sc">*</span>  lstat) <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb708-2"><a href="statistical-models.html#cb708-2" aria-hidden="true" tabindex="-1"></a>    ptratio  , <span class="at">data =</span> data2)</span>
<span id="cb708-3"><a href="statistical-models.html#cb708-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(robust_model_term)</span></code></pre></div>
<pre><code>## 
## Call: rlm(formula = medv ~ zn + chas + nox + (rm * lstat) + dis + rad + 
##     tax + ptratio, data = data2)
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -20.90999  -1.74873  -0.09845   1.92931  33.87244 
## 
## Coefficients:
##             Value    Std. Error t value 
## (Intercept)  20.9624   0.1656   126.5763
## zn            0.1998   0.2120     0.9424
## chas          0.5198   0.1458     3.5643
## nox          -1.3458   0.2935    -4.5846
## rm            2.8773   0.1991    14.4524
## lstat        -4.5706   0.2554   -17.8979
## dis          -1.9208   0.2896    -6.6326
## rad           0.9005   0.3663     2.4586
## tax          -1.7199   0.4095    -4.2004
## ptratio      -1.2451   0.1956    -6.3652
## rm:lstat     -1.9899   0.1289   -15.4398
## 
## Residual standard error: 2.698 on 396 degrees of freedom</code></pre>
</div>
<div id="create-a-model-before-transforming-data" class="section level3 hasAnchor" number="6.3.16">
<h3><span class="header-section-number">6.3.16</span> Create a model before transforming data<a href="statistical-models.html#create-a-model-before-transforming-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="statistical-models.html#cb710-1" aria-hidden="true" tabindex="-1"></a>model_trasf_orig <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span> rm <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb710-2"><a href="statistical-models.html#cb710-2" aria-hidden="true" tabindex="-1"></a>    ptratio <span class="sc">+</span> lstat, <span class="at">data =</span> data)</span>
<span id="cb710-3"><a href="statistical-models.html#cb710-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_trasf_orig)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + nox + rm + dis + rad + tax + 
##     ptratio + lstat, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.219  -2.729  -0.463   1.920  25.992 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  22.5094     0.2430  92.619  &lt; 2e-16 ***
## zn            0.8232     0.3754   2.193 0.028904 *  
## chas          0.6582     0.2412   2.728 0.006652 ** 
## nox          -1.9351     0.4727  -4.093 5.15e-05 ***
## rm            2.3985     0.3128   7.668 1.36e-13 ***
## dis          -2.9289     0.4565  -6.416 3.99e-10 ***
## rad           2.2109     0.6348   3.483 0.000551 ***
## tax          -2.1880     0.6896  -3.173 0.001627 ** 
## ptratio      -2.0274     0.3254  -6.230 1.19e-09 ***
## lstat        -4.3534     0.3844 -11.325  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.895 on 397 degrees of freedom
## Multiple R-squared:  0.7212, Adjusted R-squared:  0.7149 
## F-statistic: 114.1 on 9 and 397 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>non nest models comparisons</li>
</ul>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="statistical-models.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_trasf,model_trasf_orig)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">df</th>
<th align="right">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">model_trasf</td>
<td align="right">11</td>
<td align="right">2432.353</td>
</tr>
<tr class="even">
<td align="left">model_trasf_orig</td>
<td align="right">11</td>
<td align="right">2459.780</td>
</tr>
</tbody>
</table>
</div>
<div id="k-fold-cross-validation" class="section level3 hasAnchor" number="6.3.17">
<h3><span class="header-section-number">6.3.17</span> K-fold cross validation<a href="statistical-models.html#k-fold-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>to make sure which model is better</li>
</ul>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="statistical-models.html#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;DAAG&quot;)</span></span>
<span id="cb713-2"><a href="statistical-models.html#cb713-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb713-3"><a href="statistical-models.html#cb713-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb713-4"><a href="statistical-models.html#cb713-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb713-5"><a href="statistical-models.html#cb713-5" aria-hidden="true" tabindex="-1"></a>model_trasf_term_cv <span class="ot">&lt;-</span> <span class="fu">glm</span>( medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span> nox <span class="sc">+</span>  (rm<span class="sc">*</span>  lstat) <span class="sc">+</span> dis <span class="sc">+</span> rad <span class="sc">+</span> tax <span class="sc">+</span> </span>
<span id="cb713-6"><a href="statistical-models.html#cb713-6" aria-hidden="true" tabindex="-1"></a>    ptratio  , <span class="at">data =</span> data2)</span>
<span id="cb713-7"><a href="statistical-models.html#cb713-7" aria-hidden="true" tabindex="-1"></a>cv.err  <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(data2, model_trasf_term_cv, <span class="at">K =</span> <span class="dv">10</span>)<span class="sc">$</span>delta</span>
<span id="cb713-8"><a href="statistical-models.html#cb713-8" aria-hidden="true" tabindex="-1"></a>cv.err </span></code></pre></div>
<pre><code>## [1] 19.24588 19.15400</code></pre>
</div>
<div id="nonnest-models-comparisons" class="section level3 hasAnchor" number="6.3.18">
<h3><span class="header-section-number">6.3.18</span> Nonnest models comparisons<a href="statistical-models.html#nonnest-models-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="statistical-models.html#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model_trasf_term,model_trasf,model_trasf_orig,model_trasf_poly)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">df</th>
<th align="right">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">model_trasf_term</td>
<td align="right">12</td>
<td align="right">2345.492</td>
</tr>
<tr class="even">
<td align="left">model_trasf</td>
<td align="right">11</td>
<td align="right">2432.353</td>
</tr>
<tr class="odd">
<td align="left">model_trasf_orig</td>
<td align="right">11</td>
<td align="right">2459.780</td>
</tr>
<tr class="even">
<td align="left">model_trasf_poly</td>
<td align="right">11</td>
<td align="right">2592.584</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="statistical-models.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction, transformation, original, polynomial by order (`data` has been normalized but not `data2`)</span></span></code></pre></div>
<ul>
<li>plot the final model and check the model assumption</li>
</ul>
<p><code>posterior predictive check,  linearity,  homogeneity of variance,  influential points,  colinearity, and  normality of residuals</code></p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="statistical-models.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;performance&quot;)</span></span>
<span id="cb717-2"><a href="statistical-models.html#cb717-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb717-3"><a href="statistical-models.html#cb717-3" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model_trasf_term)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-370-1.png" width="672" /></p>
</div>
<div id="create-forest-plot-for-coefficients" class="section level3 hasAnchor" number="6.3.19">
<h3><span class="header-section-number">6.3.19</span> Create forest plot for coefficients<a href="statistical-models.html#create-forest-plot-for-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="statistical-models.html#cb718-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot) </span>
<span id="cb718-2"><a href="statistical-models.html#cb718-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(model_trasf_term, <span class="at">show.values =</span> <span class="cn">TRUE</span>, <span class="at">value.offset =</span> <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-371-1.png" width="672" /></p>
</div>
<div id="relative-importance" class="section level3 hasAnchor" number="6.3.20">
<h3><span class="header-section-number">6.3.20</span> Relative Importance<a href="statistical-models.html#relative-importance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>provides measures of relative importance</li>
</ul>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="statistical-models.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(relaimpo)</span>
<span id="cb719-2"><a href="statistical-models.html#cb719-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calc.relimp(fit,type=c(&quot;lmg&quot;,&quot;last&quot;,&quot;first&quot;,&quot;pratt&quot;),</span></span>
<span id="cb719-3"><a href="statistical-models.html#cb719-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    rela=TRUE)</span></span>
<span id="cb719-4"><a href="statistical-models.html#cb719-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap Measures of Relative Importance (1000 samples)</span></span>
<span id="cb719-5"><a href="statistical-models.html#cb719-5" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">boot.relimp</span>(model_trasf_term, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">type =</span><span class="fu">c</span>(<span class="st">&quot;lmg&quot;</span> ), <span class="at">rank =</span> <span class="cn">TRUE</span>,</span>
<span id="cb719-6"><a href="statistical-models.html#cb719-6" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># type =c(&quot;lmg&quot;,&quot;last&quot;,&quot;first&quot;,&quot;pratt&quot;)</span></span>
<span id="cb719-7"><a href="statistical-models.html#cb719-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">diff =</span> <span class="cn">TRUE</span>, <span class="at">rela =</span> <span class="cn">TRUE</span>)</span>
<span id="cb719-8"><a href="statistical-models.html#cb719-8" aria-hidden="true" tabindex="-1"></a><span class="fu">booteval.relimp</span>(boot) <span class="co"># print result</span></span></code></pre></div>
<pre><code>## Response variable: medv 
## Total response variance: 77.88147 
## Analysis based on 407 observations 
## 
## 10 Regressors: 
## zn chas nox rm lstat dis rad tax ptratio rm:lstat 
## Proportion of variance explained by model: 77.39%
## Metrics are normalized to sum to 100% (rela=TRUE). 
## 
## Relative importance metrics: 
## 
##                 lmg
## zn       0.03220843
## chas     0.01925573
## nox      0.05753222
## rm       0.24841214
## lstat    0.32582422
## dis      0.04647715
## rad      0.03216196
## tax      0.05940953
## ptratio  0.09003437
## rm:lstat 0.08868423
## 
## Average coefficients for different model sizes: 
## 
##                  1X        2Xs        3Xs        4Xs        5Xs        6Xs
## zn        3.1505046  2.1309586  1.5419108  1.1885764  0.9622432  0.8066737
## chas      1.4317561  1.3828980  1.2922217  1.1827563  1.0710746  0.9666952
## nox      -3.6683140 -2.8590532 -2.3987148 -2.1635246 -2.0628637 -2.0336275
## rm        5.8715576  5.1812470  4.6686609  4.2214027  3.7902531  3.3584729
## lstat    -6.3961998 -6.2413211 -6.1543204 -6.0962610 -6.0505503 -6.0111059
## dis       2.3495853  0.6106749 -0.5986185 -1.4554886 -2.0655023 -2.4944977
## rad      -3.2090101 -1.5469225 -0.4505596  0.2850626  0.7884232  1.1408255
## tax      -4.1727995 -3.6061521 -3.1776467 -2.8413999 -2.5683300 -2.3434564
## ptratio  -4.2048171 -3.4233285 -2.9476391 -2.6199136 -2.3633992 -2.1469790
## rm:lstat -0.7386853 -1.0072327 -1.1975350 -1.3430505 -1.4610987 -1.5602846
##                 7Xs        8Xs        9Xs       10Xs
## zn        0.6942682  0.6122971  0.5558327  0.5221292
## chas      0.8734919  0.7916003  0.7191770  0.6537613
## nox      -2.0351844 -2.0434312 -2.0444974 -2.0294702
## rm        2.9235837  2.4886854  2.0599352  1.6458985
## lstat    -5.9756419 -5.9424093 -5.9088868 -5.8714971
## dis      -2.7882468 -2.9825750 -3.1064663 -3.1809633
## rad       1.3969994  1.5963587  1.7666711  1.9250667
## tax      -2.1625306 -2.0281734 -1.9455332 -1.9186629
## ptratio  -1.9610124 -1.8027959 -1.6694147 -1.5553973
## rm:lstat -1.6447082 -1.7160362 -1.7745576 -1.8202278
## 
##  
##  Confidence interval information ( 10 bootstrap replicates, bty= perc ): 
## Relative Contributions with confidence intervals: 
##  
##                                    Lower  Upper
##              percentage 0.95       0.95   0.95  
## zn.lmg       0.0322     _______HIJ 0.0204 0.0357
## chas.lmg     0.0193     ______GHIJ 0.0016 0.0501
## nox.lmg      0.0575     ____EFG___ 0.0430 0.0708
## rm.lmg       0.2484     AB________ 0.1916 0.3284
## lstat.lmg    0.3258     AB________ 0.2617 0.3836
## dis.lmg      0.0465     _____FGHIJ 0.0286 0.0548
## rad.lmg      0.0322     ______GHIJ 0.0215 0.0465
## tax.lmg      0.0594     ___DEF____ 0.0479 0.0796
## ptratio.lmg  0.0900     __CD______ 0.0711 0.1202
## rm:lstat.lmg 0.0887     __CDE_____ 0.0606 0.1037
## 
## Letters indicate the ranks covered by bootstrap CIs. 
## (Rank bootstrap confidence intervals always obtained by percentile method) 
## CAUTION: Bootstrap confidence intervals can be somewhat liberal. 
## 
##  
##  Differences between Relative Contributions: 
##  
##                                      Lower   Upper
##                      difference 0.95 0.95    0.95   
## zn-chas.lmg           0.0130         -0.0192  0.0276
## zn-nox.lmg           -0.0253     *   -0.0504 -0.0137
## zn-rm.lmg            -0.2162     *   -0.3028 -0.1559
## zn-lstat.lmg         -0.2936     *   -0.3478 -0.2274
## zn-dis.lmg           -0.0143         -0.0235  0.0019
## zn-rad.lmg            0.0000         -0.0221  0.0084
## zn-tax.lmg           -0.0272     *   -0.0532 -0.0166
## zn-ptratio.lmg       -0.0578     *   -0.0911 -0.0377
## zn-rm:lstat.lmg      -0.0565     *   -0.0746 -0.0305
## chas-nox.lmg         -0.0383     *   -0.0584 -0.0033
## chas-rm.lmg          -0.2292     *   -0.3144 -0.1753
## chas-lstat.lmg       -0.3066     *   -0.3672 -0.2117
## chas-dis.lmg         -0.0272         -0.0385  0.0137
## chas-rad.lmg         -0.0129         -0.0449  0.0201
## chas-tax.lmg         -0.0402     *   -0.0781 -0.0008
## chas-ptratio.lmg     -0.0708     *   -0.1187 -0.0260
## chas-rm:lstat.lmg    -0.0694     *   -0.1021 -0.0338
## nox-rm.lmg           -0.1909     *   -0.2781 -0.1378
## nox-lstat.lmg        -0.2683     *   -0.3298 -0.2047
## nox-dis.lmg           0.0111         -0.0010  0.0275
## nox-rad.lmg           0.0254     *    0.0048  0.0288
## nox-tax.lmg          -0.0019         -0.0283  0.0061
## nox-ptratio.lmg      -0.0325     *   -0.0689 -0.0130
## nox-rm:lstat.lmg     -0.0312     *   -0.0525 -0.0008
## rm-lstat.lmg         -0.0774         -0.1920  0.0488
## rm-dis.lmg            0.2019     *    0.1368  0.2922
## rm-rad.lmg            0.2163     *    0.1599  0.3069
## rm-tax.lmg            0.1890     *    0.1310  0.2806
## rm-ptratio.lmg        0.1584     *    0.1065  0.2525
## rm-rm:lstat.lmg       0.1597     *    0.1047  0.2605
## lstat-dis.lmg         0.2793     *    0.2253  0.3288
## lstat-rad.lmg         0.2937     *    0.2231  0.3519
## lstat-tax.lmg         0.2664     *    0.1899  0.3229
## lstat-ptratio.lmg     0.2358     *    0.1493  0.2985
## lstat-rm:lstat.lmg    0.2371     *    0.1658  0.3018
## dis-rad.lmg           0.0143         -0.0088  0.0231
## dis-tax.lmg          -0.0129     *   -0.0419 -0.0043
## dis-ptratio.lmg      -0.0436     *   -0.0825 -0.0303
## dis-rm:lstat.lmg     -0.0422     *   -0.0660 -0.0071
## rad-tax.lmg          -0.0272     *   -0.0331 -0.0205
## rad-ptratio.lmg      -0.0579     *   -0.0737 -0.0367
## rad-rm:lstat.lmg     -0.0565     *   -0.0714 -0.0240
## tax-ptratio.lmg      -0.0306     *   -0.0462 -0.0123
## tax-rm:lstat.lmg     -0.0293         -0.0453  0.0050
## ptratio-rm:lstat.lmg  0.0014         -0.0253  0.0346
## 
## * indicates that CI for difference does not include 0. 
## CAUTION: Bootstrap confidence intervals can be somewhat liberal.</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="statistical-models.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">booteval.relimp</span>(boot,<span class="at">sort=</span><span class="cn">TRUE</span>)) <span class="co"># plot result</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
</div>
<div id="model-prediction" class="section level3 hasAnchor" number="6.3.21">
<h3><span class="header-section-number">6.3.21</span> Model prediction<a href="statistical-models.html#model-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>prediction <code>ci</code> and mean <code>ci</code></li>
</ul>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="statistical-models.html#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb722-2"><a href="statistical-models.html#cb722-2" aria-hidden="true" tabindex="-1"></a>data_pred <span class="ot">&lt;-</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(data2 , zn , chas , nox , rm , dis , rad , tax , </span>
<span id="cb722-3"><a href="statistical-models.html#cb722-3" aria-hidden="true" tabindex="-1"></a>    ptratio , lstat)</span>
<span id="cb722-4"><a href="statistical-models.html#cb722-4" aria-hidden="true" tabindex="-1"></a>data_pred[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">zn</th>
<th align="right">chas</th>
<th align="right">nox</th>
<th align="right">rm</th>
<th align="right">dis</th>
<th align="right">rad</th>
<th align="right">tax</th>
<th align="right">ptratio</th>
<th align="right">lstat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.2845483</td>
<td align="right">-0.2723291</td>
<td align="right">-0.1440749</td>
<td align="right">0.4132629</td>
<td align="right">0.2785465</td>
<td align="right">-0.9818712</td>
<td align="right">-0.6659492</td>
<td align="right">-1.4575580</td>
<td align="right">-1.0744990</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">-0.4872402</td>
<td align="right">-0.2723291</td>
<td align="right">-0.7395304</td>
<td align="right">0.1940824</td>
<td align="right">0.6786919</td>
<td align="right">-0.8670245</td>
<td align="right">-0.9863534</td>
<td align="right">-0.3027945</td>
<td align="right">-0.4919525</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">-0.4872402</td>
<td align="right">-0.2723291</td>
<td align="right">-0.8344581</td>
<td align="right">1.0152978</td>
<td align="right">1.1314532</td>
<td align="right">-0.7521778</td>
<td align="right">-1.1050216</td>
<td align="right">0.1129203</td>
<td align="right">-1.3601708</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">-0.4872402</td>
<td align="right">-0.2723291</td>
<td align="right">-0.8344581</td>
<td align="right">1.2273620</td>
<td align="right">1.1314532</td>
<td align="right">-0.7521778</td>
<td align="right">-1.1050216</td>
<td align="right">0.1129203</td>
<td align="right">-1.0254866</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">-0.4872402</td>
<td align="right">-0.2723291</td>
<td align="right">-0.8344581</td>
<td align="right">0.2068916</td>
<td align="right">1.1314532</td>
<td align="right">-0.7521778</td>
<td align="right">-1.1050216</td>
<td align="right">0.1129203</td>
<td align="right">-1.0422909</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">0.0487240</td>
<td align="right">-0.2723291</td>
<td align="right">-0.2648919</td>
<td align="right">-0.3880270</td>
<td align="right">0.9295961</td>
<td align="right">-0.5224844</td>
<td align="right">-0.5769480</td>
<td align="right">-1.5037485</td>
<td align="right">-0.0312367</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">0.0487240</td>
<td align="right">-0.2723291</td>
<td align="right">-0.2648919</td>
<td align="right">-0.1603069</td>
<td align="right">1.0872565</td>
<td align="right">-0.5224844</td>
<td align="right">-0.5769480</td>
<td align="right">-1.5037485</td>
<td align="right">0.9097999</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">0.0487240</td>
<td align="right">-0.2723291</td>
<td align="right">-0.2648919</td>
<td align="right">-0.9302853</td>
<td align="right">1.1392843</td>
<td align="right">-0.5224844</td>
<td align="right">-0.5769480</td>
<td align="right">-1.5037485</td>
<td align="right">2.4193794</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">0.0487240</td>
<td align="right">-0.2723291</td>
<td align="right">-0.2648919</td>
<td align="right">-0.3994130</td>
<td align="right">1.3357787</td>
<td align="right">-0.5224844</td>
<td align="right">-0.5769480</td>
<td align="right">-1.5037485</td>
<td align="right">0.6227277</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">0.0487240</td>
<td align="right">-0.2723291</td>
<td align="right">-0.2648919</td>
<td align="right">0.1314594</td>
<td align="right">1.2422167</td>
<td align="right">-0.5224844</td>
<td align="right">-0.5769480</td>
<td align="right">-1.5037485</td>
<td align="right">1.0918456</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="statistical-models.html#cb723-1" aria-hidden="true" tabindex="-1"></a>predy <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_trasf_term, data_pred[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,], <span class="at">interval=</span><span class="st">&quot;predict&quot;</span>)</span>
<span id="cb723-2"><a href="statistical-models.html#cb723-2" aria-hidden="true" tabindex="-1"></a>predy</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">fit</th>
<th align="right">lwr</th>
<th align="right">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">30.258620</td>
<td align="right">21.8534712</td>
<td align="right">38.66377</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">24.415330</td>
<td align="right">16.0263022</td>
<td align="right">32.80436</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">31.759215</td>
<td align="right">23.3073401</td>
<td align="right">40.21109</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">29.920476</td>
<td align="right">21.4789966</td>
<td align="right">38.36196</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">26.441050</td>
<td align="right">18.0254500</td>
<td align="right">34.85665</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">20.820462</td>
<td align="right">12.3963513</td>
<td align="right">29.24457</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">15.455998</td>
<td align="right">6.9807773</td>
<td align="right">23.93122</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">8.991037</td>
<td align="right">0.4048231</td>
<td align="right">17.57725</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">16.144719</td>
<td align="right">7.6745761</td>
<td align="right">24.61486</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">13.847673</td>
<td align="right">5.3305253</td>
<td align="right">22.36482</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="statistical-models.html#cb724-1" aria-hidden="true" tabindex="-1"></a>confy <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_trasf_term, data_pred[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,], <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb724-2"><a href="statistical-models.html#cb724-2" aria-hidden="true" tabindex="-1"></a>confy</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">fit</th>
<th align="right">lwr</th>
<th align="right">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">30.258620</td>
<td align="right">29.329961</td>
<td align="right">31.18728</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">24.415330</td>
<td align="right">23.646134</td>
<td align="right">25.18452</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">31.759215</td>
<td align="right">30.474666</td>
<td align="right">33.04376</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">29.920476</td>
<td align="right">28.706202</td>
<td align="right">31.13475</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">26.441050</td>
<td align="right">25.422125</td>
<td align="right">27.45998</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">20.820462</td>
<td align="right">19.733484</td>
<td align="right">21.90744</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">15.455998</td>
<td align="right">14.025877</td>
<td align="right">16.88612</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">8.991037</td>
<td align="right">7.006358</td>
<td align="right">10.97572</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">16.144719</td>
<td align="right">14.745003</td>
<td align="right">17.54443</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">13.847673</td>
<td align="right">12.187044</td>
<td align="right">15.50830</td>
</tr>
</tbody>
</table>
<ul>
<li><code>ci</code> width (the lower and upper bonds)</li>
</ul>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="statistical-models.html#cb725-1" aria-hidden="true" tabindex="-1"></a>confy <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1.857318</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">1.538391</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">2.569097</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">2.428550</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">2.037850</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">2.173956</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">2.860241</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">3.969358</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">2.799431</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">3.321259</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="statistical-models.html#cb726-1" aria-hidden="true" tabindex="-1"></a>predy <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">16.81030</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">16.77805</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">16.90375</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">16.88296</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">16.83120</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">16.84822</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">16.95044</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="right">17.17243</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">16.94029</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">17.03430</td>
</tr>
</tbody>
</table>
<ul>
<li>plot the differences of predictions and actual values</li>
</ul>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="statistical-models.html#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data2<span class="sc">$</span>medv,<span class="fu">predict</span>(model_trasf_term) )</span>
<span id="cb727-2"><a href="statistical-models.html#cb727-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">predict</span>(model_trasf_term)<span class="sc">~</span>data2<span class="sc">$</span>medv)</span>
<span id="cb727-3"><a href="statistical-models.html#cb727-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-377-1.png" width="672" /></p>
<ul>
<li>compute y hat and confidence interval</li>
</ul>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="statistical-models.html#cb728-1" aria-hidden="true" tabindex="-1"></a>data_ci <span class="ot">&lt;-</span>  dplyr<span class="sc">::</span><span class="fu">select</span>(data2, zn ,chas ,tax , medv)</span>
<span id="cb728-2"><a href="statistical-models.html#cb728-2" aria-hidden="true" tabindex="-1"></a>model_ci <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> medv <span class="sc">~</span> zn <span class="sc">+</span> chas <span class="sc">+</span>tax , <span class="at">data =</span> data_ci)</span>
<span id="cb728-3"><a href="statistical-models.html#cb728-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ci)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ zn + chas + tax, data = data_ci)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.182  -4.715  -1.305   2.345  34.377 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  22.3073     0.3699  60.307  &lt; 2e-16 ***
## zn            2.1080     0.3919   5.379 1.27e-07 ***
## chas          1.4174     0.3599   3.939 9.66e-05 ***
## tax          -3.4463     0.3985  -8.649  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.46 on 403 degrees of freedom
## Multiple R-squared:  0.2907, Adjusted R-squared:  0.2855 
## F-statistic: 55.07 on 3 and 403 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><code>compute y hat and compare with y predict and actual y</code></p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="statistical-models.html#cb730-1" aria-hidden="true" tabindex="-1"></a>XCI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">intercept=</span><span class="dv">1</span>, data_ci[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb730-2"><a href="statistical-models.html#cb730-2" aria-hidden="true" tabindex="-1"></a>comp_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(XCI)<span class="sc">%*%</span><span class="fu">as.numeric</span>(model_ci<span class="sc">$</span>coefficients)</span>
<span id="cb730-3"><a href="statistical-models.html#cb730-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-4"><a href="statistical-models.html#cb730-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span>(comp_y,<span class="fu">predict</span>(model_ci, XCI), data_ci[,<span class="dv">4</span>]))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">24.81617</td>
<td align="right">24.81617</td>
<td align="right">24.0</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">24.29345</td>
<td align="right">24.29345</td>
<td align="right">21.6</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">24.70242</td>
<td align="right">24.70242</td>
<td align="right">33.4</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="right">24.70242</td>
<td align="right">24.70242</td>
<td align="right">36.2</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">24.70242</td>
<td align="right">24.70242</td>
<td align="right">28.7</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">24.01233</td>
<td align="right">24.01233</td>
<td align="right">22.9</td>
</tr>
</tbody>
</table>
<p><code>compute ci</code></p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="statistical-models.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;matlib&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     tr</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="statistical-models.html#cb734-1" aria-hidden="true" tabindex="-1"></a>var.yhat <span class="ot">&lt;-</span> <span class="fu">sigma</span>(model_ci)<span class="sc">**</span><span class="dv">2</span><span class="sc">*</span> <span class="fu">as.matrix</span>(XCI[<span class="dv">1</span> ,]) <span class="sc">%*%</span> <span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(XCI)) <span class="sc">%*%</span> <span class="fu">as.matrix</span> (XCI))<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(XCI[<span class="dv">1</span> ,]))</span>
<span id="cb734-2"><a href="statistical-models.html#cb734-2" aria-hidden="true" tabindex="-1"></a><span class="co"># var.yhat</span></span>
<span id="cb734-3"><a href="statistical-models.html#cb734-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb734-4"><a href="statistical-models.html#cb734-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">predict</span>(model_ci, XCI[<span class="dv">1</span> ,])<span class="sc">-</span><span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(var.yhat)),</span>
<span id="cb734-5"><a href="statistical-models.html#cb734-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">predict</span>(model_ci, XCI[<span class="dv">1</span> ,]) ),</span>
<span id="cb734-6"><a href="statistical-models.html#cb734-6" aria-hidden="true" tabindex="-1"></a>(<span class="fu">predict</span>(model_ci, XCI[<span class="dv">1</span> ,])<span class="sc">+</span><span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(var.yhat))</span>
<span id="cb734-7"><a href="statistical-models.html#cb734-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">1</th>
<th align="right"></th>
<th align="right">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">23.91998</td>
<td align="right">24.81617</td>
<td align="right">25.71237</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="statistical-models.html#cb735-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model_ci, XCI[<span class="dv">1</span> ,], <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">fit</th>
<th align="right">lwr</th>
<th align="right">upr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">24.81617</td>
<td align="right">23.9173</td>
<td align="right">25.71505</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
E(\hat{Y}_0)=\sigma^2\mathbf{X_0\left( X&#39;X\right)^{-1}X_0&#39;}
\]</span></p>
</div>
<div id="external-data-validation" class="section level3 hasAnchor" number="6.3.22">
<h3><span class="header-section-number">6.3.22</span> External data validation<a href="statistical-models.html#external-data-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>this is not ture external validation (just for demonstration)</li>
<li>Split the data randomly into a training set and a test set by using <code>caret</code> package.</li>
</ul>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="statistical-models.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb736-2"><a href="statistical-models.html#cb736-2" aria-hidden="true" tabindex="-1"></a>testdata2_pred <span class="ot">&lt;-</span>   dplyr<span class="sc">::</span><span class="fu">select</span>(testdata2, zn , chas , nox , rm , dis , rad , tax , </span>
<span id="cb736-3"><a href="statistical-models.html#cb736-3" aria-hidden="true" tabindex="-1"></a>    ptratio , lstat)</span>
<span id="cb736-4"><a href="statistical-models.html#cb736-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-5"><a href="statistical-models.html#cb736-5" aria-hidden="true" tabindex="-1"></a>R_sq <span class="ot">&lt;-</span> <span class="fu">R2</span>(testdata2<span class="sc">$</span>medv,<span class="fu">predict</span>(model_trasf_term,testdata2_pred))</span>
<span id="cb736-6"><a href="statistical-models.html#cb736-6" aria-hidden="true" tabindex="-1"></a>RMSE <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(testdata2<span class="sc">$</span>medv,<span class="fu">predict</span>(model_trasf_term,testdata2_pred))</span>
<span id="cb736-7"><a href="statistical-models.html#cb736-7" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> <span class="fu">MAE</span>(testdata2<span class="sc">$</span>medv,<span class="fu">predict</span>(model_trasf_term,testdata2_pred))</span>
<span id="cb736-8"><a href="statistical-models.html#cb736-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(R_sq, RMSE, MAE))</span></code></pre></div>
<pre><code>## [1] 0.8465718 4.1960036 3.4352611</code></pre>
</div>
</div>
<div id="variable-selection" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Variable selection<a href="statistical-models.html#variable-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://rpubs.com/Daniel_He/1044963">see here</a></p>

</div>
<div id="linear-mixed-model-theory" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Linear mixed model theory<a href="statistical-models.html#linear-mixed-model-theory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="matrix-format-1" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Matrix format<a href="statistical-models.html#matrix-format-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear mixed models is to analyze data that are independent, longitudinal, repeated, multilevel. LMMs allows both fixed and random effects.</p>
<p><span class="math display">\[
\mathbf{y} = \boldsymbol{X\beta} + \boldsymbol{Zu} + \boldsymbol{\varepsilon}
\]</span></p>
<p>Where y is a Nx1 column vector for the dependent variable; x is a Nxr design matrix of independent variables ;<span class="math inline">\(\beta\)</span> is a rx1 column vector of the fixed-effects regression coefficients ; z is the Nxm design matrix for the random effects ; u is a mx1 vector of random effects ; and e is a Nx1 column vector of the residuals. <span class="math inline">\(xb\)</span> is the fixed effect and <span class="math inline">\(zu\)</span> is the random effect.</p>
<p><span class="math display">\[
\overbrace{\mathbf{y}}^{\mbox{N x 1}} \quad = \quad
\overbrace{\underbrace{\mathbf{X}}_{\mbox{N x r}} \quad \underbrace{\boldsymbol{\beta}}_{\mbox{r x 1}}}^{\mbox{N x 1}} \quad + \quad
\overbrace{\underbrace{\mathbf{Z}}_{\mbox{N x m}} \quad \underbrace{\boldsymbol{u}}_{\mbox{m x 1}}}^{\mbox{N x 1}} \quad + \quad
\overbrace{\boldsymbol{\varepsilon}}^{\mbox{N x 1}}
\]</span></p>
</div>
<div id="exmaple-reducing-the-work-stress-of-nurses" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Exmaple: reducing the work stress of nurses<a href="statistical-models.html#exmaple-reducing-the-work-stress-of-nurses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a study, it is to evaluate whether an intervention reduces the work stress for nurses, 1000 nurses were investigated from 25 hospitals. y is the work stress score, and independent variables are age, gender, age of experience, ward type, and intervention. there, <code>only random intercepts (hospital) is considered</code>.</p>
<p><span class="math display">\[
\overbrace{\mathbf{y}}^{ 1000 \times 1} \quad = \quad
\overbrace{\underbrace{\mathbf{X}}_{ 1000 \times 5} \quad \underbrace{\boldsymbol{\beta}}_{5 \times 1}}^{ 1000 \times 1} \quad + \quad
\overbrace{\underbrace{\mathbf{Z}}_{ 1000 \times 25} \quad \underbrace{\boldsymbol{u}}_{ 25 \times 1}}^{ 1000 \times 1} \quad + \quad
\overbrace{\boldsymbol{\varepsilon}}^{ 1000 \times 1}
\]</span></p>
</div>
<div id="dependent-variable-y" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Dependent variable, <span class="math inline">\(y\)</span><a href="statistical-models.html#dependent-variable-y" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\mathbf{y} = \left[ \begin{array}{l} \text{stress} \\ 7 \\ 7 \\ \ldots \\ 6 \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ \ldots \\ 1000 \end{array}
\]</span></p>
</div>
<div id="independent-variables-fixed-effects-xs" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Independent variables (fixed effects), <span class="math inline">\(Xs\)</span><a href="statistical-models.html#independent-variables-fixed-effects-xs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\quad \mathbf{X} = \left[ \begin{array}{llllll} \text{Intercept} &amp; \text{Age} &amp; \text{Gender} &amp; \text{Ward type} &amp; \text{Age of exper} &amp; \text{Intervention} \\ 1 &amp; 34.97 &amp; 0 &amp; 1 &amp; 60 &amp; 1 \\ 1 &amp; 33.92 &amp; 0 &amp; 0 &amp; 67 &amp; 1 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 1 &amp; 26.07 &amp; 0 &amp; 1 &amp; 64 &amp; 0 \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ \ldots \\ 1000 \end{array}
\]</span></p>
</div>
<div id="fixed-effect-coefficients-hatbeta" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Fixed effect coefficients, <span class="math inline">\(\hat{\beta}\)</span><a href="statistical-models.html#fixed-effect-coefficients-hatbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\boldsymbol{\hat{\beta}} = \left[ \begin{array}{l} \text{beta} \\ 72.1 \\ 135.6 \\ \ldots \\ 37.8 \end{array} \right] \begin{array}{l} n_{} \\ intercept \\ 1 \\ \ldots \\ 5 \end{array}
\]</span></p>
<div id="how-to-solve-hatbeta" class="section level4 hasAnchor" number="6.5.5.1">
<h4><span class="header-section-number">6.5.5.1</span> How to solve <span class="math inline">\(\hat{\beta}\)</span><a href="statistical-models.html#how-to-solve-hatbeta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>minimize <span class="math inline">\(\ell\)</span> the likelihood function by letting the derivation = 0
<span class="math display">\[\ell=-\log L\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\ell(\mathbf{y}, \beta, \gamma) &amp;=\frac{1}{2}\left\{n \log (2 \pi)+\log |\mathbf{V}(\gamma)|+(\mathbf{y}-\mathbf{X} \beta)^{\prime}(\mathbf{V}(\gamma))^{-1}(\mathbf{y}-\mathbf{X} \beta)\right\} \\
&amp; \propto \frac{1}{2}\left\{\log |\mathbf{V}(\gamma)|+(\mathbf{y}-\mathbf{X} \beta)^{\prime}(\mathbf{V}(\gamma))^{-1}(\mathbf{y}-\mathbf{X} \beta)\right\}
\end{aligned}
\]</span>
or (using restricted likelihood for <strong>adjust</strong>)</p>
<p><span class="math display">\[
\frac{1}{2}\left\{\log |\mathbf{V}(\gamma)|+(\mathbf{y}-\mathbf{X} \beta)^{\prime}(\mathbf{V}(\gamma))^{-1}(\mathbf{y}-\mathbf{X} \beta)+\log \left|\mathbf{X}^{\prime}(\mathbf{V}(\gamma))^{-1} \mathbf{X}\right|\right\}
\]</span></p>
<p>where <span class="math inline">\(\gamma\)</span> derived from <span class="math inline">\(R=\sigma^{2} \mathbf{I}\)</span>.</p>
<p><span class="math display">\[
(\hat{\beta}, \hat{\gamma})=\underset{(\beta, \gamma)}{\operatorname{argmin}} \ell(\mathbf{y}, \beta, \gamma)
\]</span></p>
<p><code>minimization by three steps</code></p>
<ul>
<li><ol style="list-style-type: decimal">
<li>The estimate of the fixed effect parameters <span class="math inline">\(\beta\)</span> is expressed as a function of the random effect parameters <span class="math inline">\(\gamma\)</span>,
<span class="math display">\[
\hat{\beta}(\gamma) =  \left(\mathbf{X}^{\prime}(\mathbf{V}(\gamma))^{-1} \mathbf{X}\right)^{-1}\mathbf{X}^{\prime}(\mathbf{V}(\gamma))^{-1} \mathbf{y}
\]</span></li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Minimizing <span class="math inline">\(\ell(\mathbf{y}, \hat{\beta}(\gamma), \gamma)\)</span> as a function of <span class="math inline">\(\gamma\)</span> to calculate the random effect parameters.
<span class="math display">\[\ell(\mathbf{y}, \hat{\beta}(\gamma), \gamma)\]</span></li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Go back to solve the fixed effect parameters <span class="math inline">\(\hat{\beta}=\hat{\beta}(\hat{\gamma})\)</span>.</li>
</ol></li>
</ul>
</div>
</div>
<div id="variance--covariance-matrix-of-hatbeta" class="section level3 hasAnchor" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Variance- covariance matrix of <span class="math inline">\(\hat{\beta}\)</span><a href="statistical-models.html#variance--covariance-matrix-of-hatbeta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\boldsymbol{\hat{\beta}} \sim \mathcal{N}(\mathbf{\beta}, \mathbf{\sigma^2_{\beta}})
\]</span></p>
<p>where <span class="math inline">\(\sigma^2_{\hat{\beta}}\)</span> is a rxr (6x6) variance-covariance matrix of the fixed effects <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span>.</p>
<p>therefore</p>
<p><span class="math display">\[
\quad \mathbf{\sigma^2_{\hat{\beta}}} = \left[ \begin{array}{llllll} \text{_1} &amp; \text{_2} &amp; \text{_3} &amp; \text{... } &amp; \text{_5}   \\ \sigma^2_{1,1} &amp; \sigma^2_{1,2} &amp; ... &amp; ... &amp; ...  \\ \sigma^2_{2,1} &amp; \sigma^2_{2,2} &amp; ... &amp; ... &amp; ...   \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots   \\ ... &amp; ... &amp; \sigma^2_{3,3} &amp; ... &amp; ...   \\ \\ ... &amp; ... &amp; ... &amp; \sigma^2_{...} &amp; ...   \\ ... &amp; ... &amp; ... &amp; ... &amp; \sigma^2_{5,5}  \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ ... \\ 4  \\ 5 \end{array}
\]</span></p>
</div>
<div id="random-effects-z" class="section level3 hasAnchor" number="6.5.7">
<h3><span class="header-section-number">6.5.7</span> Random effects, <span class="math inline">\(Z\)</span><a href="statistical-models.html#random-effects-z" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\quad \mathbf{Z} = \left[ \begin{array}{llllll} \text{h_1} &amp; \text{h_2} &amp; \text{h_3} &amp; \text{... } &amp; \text{h_24} &amp; \text{h_25} \\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ ... \\ 4 \\ 5 \\ 6 \\ 7 \\ \ldots \\ 1000 \end{array}
\]</span>
<code>h_ represents hospital</code></p>
</div>
<div id="random-effects-coefficients-u" class="section level3 hasAnchor" number="6.5.8">
<h3><span class="header-section-number">6.5.8</span> Random effects coefficients, <span class="math inline">\(u\)</span><a href="statistical-models.html#random-effects-coefficients-u" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\boldsymbol{u} = \left[ \begin{array}{l} \boldsymbol{u} \\ 7.1 \\ 15.6 \\ \ldots \\ 33.8 \end{array} \right] \begin{array}{l} n_{} \\ 1 \\ 2 \\ \ldots \\ 25 \end{array}
\]</span>
<code>if there are two random effect variables, a intercept and a slope</code>
<span class="math display">\[
\boldsymbol{u} = \left[ \begin{array}{l} \boldsymbol{u} \\ 7.1 \\ 15.6 \\ \ldots \\ 33.8 \\ slope \end{array} \right] \begin{array}{l} n_{} \\ 1 \\ 2 \\ \ldots \\ 25\\ ... \end{array}
\]</span></p>
<ul>
<li>How to calculate <span class="math inline">\(\hat{\mathbf{u}}\)</span></li>
</ul>
<p><span class="math display">\[
\hat{\mathbf{u}}=\mathrm{G}\mathrm{Z}^{\prime} \mathbf{V}^{-1}(\mathbf{y}-\mathbf{X} \hat{\beta})
\]</span></p>
<p>e.g. (with one random intercept)
<span class="math display">\[
\begin{aligned}
\hat{\mathbf{u}}_{i} &amp;=\left(\sigma_{B}^{2}, \sigma_{B}^{2}\right) U^{-1}\left(\begin{array}{l}
y_{i 1}-\bar{y} \\
y_{i 2}-\bar{y}
\end{array}\right) \\
&amp;=\left(\sigma^{2} \sigma_{B}^{2}, \sigma^{2} \sigma_{B}^{2}\right)\left(\begin{array}{l}
y_{i 1}-\bar{y} \\
y_{i 2}-\bar{y}
\end{array}\right) / \sigma^{2}\left(\sigma^{2}+2 \sigma_{B}^{2}\right) \\
&amp;=\frac{\overline{y_{i}}-\bar{y}}{\frac{\sigma^{2}}{2 \sigma_{B}^{2}}+1}
\end{aligned}
\]</span></p>
</div>
<div id="variance-covariance-matrix-of-the-random-effects-boldsymbolu" class="section level3 hasAnchor" number="6.5.9">
<h3><span class="header-section-number">6.5.9</span> Variance-covariance matrix of the random effects, <span class="math inline">\(\boldsymbol{u}\)</span><a href="statistical-models.html#variance-covariance-matrix-of-the-random-effects-boldsymbolu" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since
<span class="math display">\[
\boldsymbol{u} \sim \mathcal{N}(\mathbf{0}, \mathbf{G})
\]</span></p>
<p>where G is a mxm (25x25) diagonal variance-covariance matrix of the random effects <span class="math inline">\(\boldsymbol{u}\)</span>.</p>
<p>therefore
<span class="math display">\[
\quad \mathbf{G} = \left[ \begin{array}{llllll} \text{_1} &amp; \text{_2} &amp; \text{_3} &amp; \text{... } &amp; \text{_25} &amp; \text{_25} \\ \sigma^2_{1,1} &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... \\ ... &amp; \sigma^2_{2,2} &amp; ... &amp; ... &amp; ... &amp; ... \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ ... &amp; ... &amp; \sigma^2_{3,3} &amp; ... &amp; ... &amp; ... \\ \\ ... &amp; ... &amp; ... &amp; \sigma^2_{...} &amp; ... &amp; ... \\ ... &amp; ... &amp; ... &amp; ... &amp; \sigma^2_{24,24} &amp; ... \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \sigma^2_{25,25} \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ ... \\ 4 \\ 5 \\ 6 \\ 7 \\ \ldots \\ 25 \end{array}
\]</span>
<code>Typically G has a very simple diagonal structure. (random intercept)</code></p>
<p><span class="math display">\[
\begin{bmatrix}
\sigma^{2}_{u}  
\end{bmatrix}=\mathbf{\boldsymbol{I\sigma^2_{u}}} = \left[ \begin{array}{llllll} \text{_1} &amp; \text{_2} &amp; \text{_3} &amp; \text{... } &amp; \text{_24} &amp; \text{_25} \\ \sigma^2_{u} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma^2_{u} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; \sigma^2_{u} &amp; 0 &amp; 0 &amp; 0 \\ \\ 0 &amp; 0 &amp; 0 &amp; \sigma^2_{u} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2_{u} &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2_{u} \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ ... \\ 4 \\ 5 \\ 6 \\ 7 \\ \ldots \\ 25 \end{array}
\]</span></p>
<p>we know
<span class="math display">\[
\mathbf{G} =
\begin{bmatrix}
\sigma^{2}_{int}  
\end{bmatrix}=
\begin{bmatrix}
\sigma^{2}_{u}  
\end{bmatrix}
\]</span></p>
<p><strong><code>if there are two random effect variables, a intercept and a slope</code></strong></p>
<p><span class="math display">\[
\mathbf{G} =
\begin{bmatrix}
\sigma^{2}_{int} &amp; \sigma^{2}_{int,slope} \\
\sigma^{2}_{int,slope} &amp; \sigma^{2}_{slope}
\end{bmatrix}
\]</span></p>
</div>
<div id="how-to-solve-sigma2-and-sigma_ub2" class="section level3 hasAnchor" number="6.5.10">
<h3><span class="header-section-number">6.5.10</span> How to solve <span class="math inline">\(\sigma^{2}\)</span> and <span class="math inline">\(\sigma_{u(B)}^{2}\)</span><a href="statistical-models.html#how-to-solve-sigma2-and-sigma_ub2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>we know
<span class="math display">\[
\mathbf{\mu} = E(\boldsymbol{X\beta} + \boldsymbol{Zu} + \boldsymbol{\varepsilon}) =\boldsymbol{X\beta} \quad \text{other terms have mean zero} \
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{V} &amp;=\operatorname{var}(\mathbf{y})=\operatorname{var}(\mathbf{X} \beta+\mathbf{Z} \mathbf{u}+\varepsilon) \quad \text{[from model ]}\\
&amp;=\operatorname{var}(\mathbf{X} \beta)+\operatorname{var}(\mathbf{Z u})+\operatorname{var}(\varepsilon) \quad \text{[all terms are independent]}\\
&amp;=\operatorname{var}(\mathbf{Z u})+\operatorname{var}(\varepsilon) \quad \text{[variance of fixed effects is zero]}\\
&amp;=Z \operatorname{var}(\mathbf{u}) Z^{\prime}+\operatorname{var}(\varepsilon) \quad \text{[ Z  is constant ]}\\
&amp;=\mathrm{ZGZ}^{\prime}+\mathrm{R} \quad \text{[from model ]}\\
\end{aligned}
\]</span></p>
<p>e.g. the covariance matrix <span class="math inline">\(\mathbf{V}\)</span> can be calculated in some conditions (with 3 random coefficients).</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{V}=&amp; \operatorname{var}(\mathbf{y})=\mathbf{Z G Z}^{\prime}+\sigma^{2} \mathbf{I} \\
=&amp;\left(\begin{array}{llllll}
\sigma^{2}+\sigma_{B}^{2} &amp; \sigma_{B}^{2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\sigma_{B}^{2} &amp; \sigma^{2}+\sigma_{B}^{2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sigma^{2}+\sigma_{B}^{2} &amp; \sigma_{B}^{2} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sigma_{B}^{2} &amp; \sigma^{2}+\sigma_{B}^{2} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^{2}+\sigma_{B}^{2} &amp; \sigma_{B}^{2} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma_{B}^{2} &amp; \sigma^{2}+\sigma_{B}^{2}
\end{array}\right)
\end{aligned}
\]</span></p>
<p><em>Remark,</em><br />
<span class="math display">\[
\operatorname{var}(\mathbf{A x})=\operatorname{Avar}(\mathbf{x}) \mathbf{A}^{\prime}
\]</span></p>
<p><em>Remark,</em></p>
<p><span class="math display">\[
\operatorname{var}(\mathbf{x}+\mathbf{y})=\operatorname{var}(\mathbf{x})+\operatorname{var}(\mathbf{y})
\]</span>
generally
<span class="math display">\[
\begin{align}
Var(X+Y) &amp;= Cov(X+Y,X+Y)  \\
&amp;= E((X+Y)^2)-E(X+Y)E(X+Y)   \\
&amp;\text{by expanding,}  \\
&amp;= E(X^2) - (E(X))^2 + E(Y^2) - (E(Y))^2 + 2(E(XY) - E(X)E(Y))  \\
&amp;= Var(X) + Var(Y) + 2(E(XY)) - E(X)E(Y))  \\
&amp;= Var(X) + Var(Y) + 2Cov(X,Y)
\end{align}
\]</span></p>
<p>therefore,</p>
<p><span class="math display">\[
\begin{aligned}
\log |\mathbf{V}(\gamma)| &amp;=3 \log \left(\sigma^{2}\right)+3 \log \left(\sigma^{2}+2 \sigma_{B}^{2}\right) \\
\log \left|\mathbf{X}^{\prime}(\mathbf{V}(\gamma))^{-1} \mathbf{X}\right| &amp;=\log (n)-\log \left(\sigma^{2}+2 \sigma_{B}^{2}\right) \\
(\mathbf{y}-\mathbf{X} \beta)^{\prime}(\mathbf{V}(\gamma))^{-1}(\mathbf{y}-\mathbf{X} \beta)=&amp; \frac{1}{\sigma^{2}\left(\sigma^{2}+2 \sigma_{B}^{2}\right)} \times \\
&amp;\left(\left(\sigma^{2}+\sigma_{B}^{2}\right) \sum_{i=1}^{3} \sum_{j=1}^{2}\left(y_{i j}-\mu\right)^{2}-2 \sigma_{B}^{2} \sum_{i=1}^{3}\left(y_{i 1}-\mu\right)\left(y_{i 2}-\mu\right)\right)
\end{aligned}
\]</span>
Here, <span class="math inline">\(r\)</span> represents <span class="math inline">\(\sigma_{B}^{2}\)</span> and <span class="math inline">\(\sigma^{2}\)</span></p>
<p>Using profile likelihood
<span class="math display">\[
\begin{aligned}
\ell_{R E}\left(\mu, \sigma^{2}, \sigma_{B}^{2}\right) \propto &amp; 3 \log \left(\sigma^{2}\right)+3 \log \left(\sigma^{2}+2 \sigma_{B}^{2}\right)-\log \left(\sigma^{2}+2 \sigma_{B}^{2}\right) \\
&amp;+\frac{1}{\sigma^{2}\left(\sigma^{2}+2 \sigma_{B}^{2}\right)}\left(\left(\sigma^{2}+\sigma_{B}^{2}\right) \sum_{i=1}^{3} \sum_{j=1}^{2}\left(y_{i j}-\mu\right)^{2}-2 \sigma_{B}^{2} \sum_{i=1}^{3}\left(y_{i 1}-\mu\right)\left(y_{i 2}-\mu\right)\right)
\end{aligned}
\]</span>
then take the derivative with respect to the two variance parameters, equate with zero and solve.
<span class="math display">\[
\begin{aligned}
\hat{\sigma}^{2} &amp;=M S E \\
\hat{\sigma}_{B}^{2} &amp;=\frac{M S E-M S_{B}}{2}
\end{aligned}
\]</span>
<code>the REML approach gives the same results as the moments method</code></p>
<!-- $$ -->
<!-- \begin{aligned} -->
<!-- \sigma^{2} &=E(M S E) \\ -->
<!-- \sigma^{2}+2\sigma_{B}^{2} &=\ { E(M S_{B})}  -->
<!-- \end{aligned} -->
<!-- $$ -->
<p><em>variance of random effect (in level) &lt; mean square of errors &lt; mean square between levels</em></p>
</div>
<div id="residuals-errors-and-their-variance--covariance-matrix" class="section level3 hasAnchor" number="6.5.11">
<h3><span class="header-section-number">6.5.11</span> Residuals (errors) and their variance- covariance matrix<a href="statistical-models.html#residuals-errors-and-their-variance--covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\boldsymbol{\varepsilon} = \left[ \begin{array}{l} \boldsymbol{\varepsilon} \\ \varepsilon_{1} \\ \varepsilon_{2} \\ \ldots \\ \varepsilon_{1000} \end{array} \right] \begin{array}{l} n_{} \\ 1 \\ 2 \\ \ldots \\ 1000 \end{array}
\]</span>
<code>which is independent and identically distributed</code></p>
<p><span class="math display">\[
\boldsymbol{\varepsilon} \sim \mathcal{N}(\mathbf{0}, \mathbf{\boldsymbol{I\sigma^2_{\varepsilon}}})
\]</span>
where
<span class="math display">\[
\mathbf{R}=\mathbf{\boldsymbol{I\sigma^2_{\varepsilon}}} = \left[ \begin{array}{llllll} \text{_1} &amp; \text{_2} &amp; \text{_3} &amp; \text{... } &amp; \text{_999} &amp; \text{_1000} \\ \sigma^2_{\varepsilon} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \sigma^2_{\varepsilon} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; \sigma^2_{\varepsilon} &amp; 0 &amp; 0 &amp; 0 \\ \\ 0 &amp; 0 &amp; 0 &amp; \sigma^2_{\varepsilon} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2_{\varepsilon} &amp; 0 \\ \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2_{\varepsilon} \\ \end{array} \right] \begin{array}{l} n_{ij} \\ 1 \\ 2 \\ ... \\ 4 \\ 5 \\ 6 \\ 7 \\ \ldots \\ 1000 \end{array}
\]</span></p>
</div>
<div id="estimated-parameters" class="section level3 hasAnchor" number="6.5.12">
<h3><span class="header-section-number">6.5.12</span> Estimated parameters<a href="statistical-models.html#estimated-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So the final estimated elements are <span class="math inline">\(\beta\)</span>, <span class="math inline">\(u\)</span>, and <span class="math inline">\(R\)</span>. The final distribution of the model is:
<span class="math display">\[
(\mathbf{y} | \boldsymbol{\beta}; \boldsymbol{u} = u) \sim
\mathcal{N}(\boldsymbol{X\beta} + \boldsymbol{Z}u, \mathbf{R})
\]</span>
we can not estimate <span class="math inline">\(\varepsilon\)</span> but its variance <span class="math inline">\(\sigma^2_{\varepsilon}\quad or \quad R\)</span>.</p>
</div>
<div id="lmm-equation" class="section level3 hasAnchor" number="6.5.13">
<h3><span class="header-section-number">6.5.13</span> LMM equation<a href="statistical-models.html#lmm-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y_{ij} = (\gamma_{00} + u_{0j}) + \gamma_{10}Age_{ij} + \gamma_{20}Married_{ij} + \gamma_{30}SEX_{ij} + \gamma_{40}WBC_{ij} + \gamma_{50}RBC_{ij} + e_{ij}
\]</span></p>
<p>In this equation for the i-th patient for the j-th doctor, a specific intercept is given to a particular doctor.</p>
</div>
<div id="testing-of-models-also-suitable-for-fixed-effect-coefficients" class="section level3 hasAnchor" number="6.5.14">
<h3><span class="header-section-number">6.5.14</span> Testing of models (also suitable for fixed effect coefficients)<a href="statistical-models.html#testing-of-models-also-suitable-for-fixed-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>test <span class="math inline">\(A \rightarrow B\)</span> if <span class="math inline">\(B\)</span> is a sub-model of <span class="math inline">\(A\)</span>.
<span class="math display">\[
G_{A \rightarrow B}=2 \ell_{r e}^{(B)}-2 \ell_{r e}^{(A)}
\]</span></p>
<p>where <span class="math inline">\(G_{A \rightarrow B}\)</span> is asymptotically <span class="math inline">\(\chi_{f}^{2}\)</span> distributed, k=number of tested parameters.</p>
<p>Additionally, <code>can choose the smallest AIC or BIC when non nested models</code>
<span class="math display">\[
\begin{aligned}
&amp;\mathrm{AIC}=-2 \cdot \log L(\hat{\theta_i})+2 \cdot p \\
&amp;\mathrm{BIC}=-2 \cdot \log L(\hat{\theta_i})+\log (n) p
\end{aligned}
\]</span>
<code>p is the number of parameters</code></p>
</div>
<div id="testing-of-fixed-effect-coefficients-only-ml" class="section level3 hasAnchor" number="6.5.15">
<h3><span class="header-section-number">6.5.15</span> Testing of fixed effect coefficients (only ML)<a href="statistical-models.html#testing-of-fixed-effect-coefficients-only-ml" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A linear hypothesis</p>
<p><span class="math display">\[
\mathbf{L}^{\prime} \beta=c
\]</span></p>
<p>e.g. 
<span class="math display">\[
\underbrace{\left(\begin{array}{llll}
0 &amp; 1 &amp; 0 &amp; 0
\end{array}\right)}_{\mathbf{L}^{\prime}}\left(\begin{array}{c}
\mu \\
\alpha_{1} \\
\alpha_{2} \\
\alpha_{3}
\end{array}\right)=0
\]</span>
we know</p>
<p><span class="math display">\[
\mathbf{L}^{\prime} \hat{\beta}=\mathbf{L}^{\prime}\left(\mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{X}\right)^{-1} \mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{y}
\]</span></p>
<p><span class="math display">\[
\mathbf{L}^{\prime} \hat{\beta} \sim N\left(\mathbf{L}^{\prime} \beta, \mathbf{L}^{\prime}\left(\mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{X}\right)^{-1} \mathbf{L}\right)
\]</span>
<span class="math display">\[
\left(\mathbf{L}^{\prime} \hat{\beta}-c\right) \sim N\left(0, \mathbf{L}^{\prime}\left(\mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{X}\right)^{-1} \mathbf{L}\right)
\]</span>
therefore, using Wald test</p>
<p><span class="math display">\[
W=\left(\mathbf{L}^{\prime} \hat{\beta}-c\right)^{\prime}\left(\mathbf{L}^{\prime}\left(\mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{X}\right)^{-1} \mathbf{L}\right)^{-1}\left(\mathbf{L}^{\prime} \hat{\beta}-c\right)^{\prime}
\]</span>
<span class="math inline">\(W\)</span> is approximately <span class="math inline">\(\chi_{\operatorname{rank}(\mathrm{L})^{2}}\)</span> distributed.</p>
<p><strong>But, better approximation: Wald F–test (&amp; Satterthwaite’s)</strong></p>
</div>
<div id="the-95-confidence-interval-of-fixed-effect-coefficients" class="section level3 hasAnchor" number="6.5.16">
<h3><span class="header-section-number">6.5.16</span> The <span class="math inline">\(95 \%\)</span> confidence interval of fixed effect coefficients<a href="statistical-models.html#the-95-confidence-interval-of-fixed-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\mathbf{}^{} \hat{\beta} \pm t_{0.975, d f} \sqrt{\mathbf{}\left(\mathbf{X}^{\prime} \mathbf{V}^{-1} \mathbf{X}\right)^{-1} \mathbf{}}
\]</span></p>
</div>
<div id="testing-of-random-effect-coefficients-typically-variances-reml" class="section level3 hasAnchor" number="6.5.17">
<h3><span class="header-section-number">6.5.17</span> Testing of random effect coefficients (typically variances, REML)<a href="statistical-models.html#testing-of-random-effect-coefficients-typically-variances-reml" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>test <span class="math inline">\(A \rightarrow B\)</span> if <span class="math inline">\(B\)</span> is a sub-model of <span class="math inline">\(A\)</span>.
<span class="math display">\[
G_{A \rightarrow B}=2 \ell_{r e}^{(B)}-2 \ell_{r e}^{(A)}
\]</span></p>
<p>where <span class="math inline">\(G_{A \rightarrow B}\)</span> is asymptotically <span class="math inline">\(\chi_{0}^{2}\)</span> and <span class="math inline">\(\chi_{1}^{2}\)</span> mixture distribution.</p>
<p>therefore, <strong>p value</strong> is</p>
<p><span class="math inline">\(P(\chi_{1}^{2}&gt;=G_{A \rightarrow B}) \quad /2\)</span></p>
</div>
<div id="confidence-intervals-for-random-effects-parameters-variances" class="section level3 hasAnchor" number="6.5.18">
<h3><span class="header-section-number">6.5.18</span> Confidence intervals for random effects parameters (variances)<a href="statistical-models.html#confidence-intervals-for-random-effects-parameters-variances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use a <span class="math inline">\(\chi^{2}\)</span>-based (Satterthwaite) approximation approach.</p>
<ul>
<li>assuming asymptotically<br />
<span class="math display">\[\quad \hat{\sigma}_{b}^{2} \sim \frac{\sigma^{2}}{d f} \chi_{d f}^{2}\]</span></li>
<li>The <span class="math inline">\(95 \%\)</span> confidence interval</li>
</ul>
<p><span class="math display">\[\frac{d f \hat{\sigma}_{b}^{2}}{\chi_{0.025 ; d f}^{2}}&lt;\sigma_{b}^{2}&lt;\frac{d f \hat{\sigma}_{b}^{2}}{\chi_{0.975 ; d f}^{2}}\]</span></p>
<ul>
<li><span class="math inline">\(d f\)</span></li>
</ul>
<p><span class="math display">\[
\hat{d f}=\frac{2 \hat{\sigma}_{b}^{4}}{\operatorname{var}\left(\hat{\sigma}_{b}^{2}\right)}
\]</span>
### Specified covariance structures, 12 lecture)</p>
<p>mixed model can be expressed as
<span class="math display">\[
\mathbf{y} \sim N\left(\mathbf{X} \beta, \mathbf{Z G Z}^{\prime}+\mathbf{R}\right),
\]</span></p>
<p>The total covariance of all observations
<span class="math display">\[
\mathbf{V}=\mathbf{Z G Z}{ }^{\prime}+\mathbf{R}
\]</span></p>
<p>The ZGZ’ part is specified through the random effects of the model.
for the <span class="math inline">\(\mathbf{R}\)</span> part, we will put some structure into <span class="math inline">\(\mathrm{R}\)</span></p>
<p><code>the structure known from the random effects model</code>
#### compound symmetry
<span class="math inline">\(\operatorname{cov}\left(y_{i_{1}}, y_{i_{2}}\right)= \begin{cases}0 &amp; , \text { if individual } i_{1} \neq \text { individual }_{i_{2}} \text { and } i_{1} \neq i_{2} \\ \sigma_{\text {individual }}^{2} &amp; , \text { if individual } i_{1}=\text { individual }_{i_{2}} \text { and } i_{1} \neq i_{2} \\ \sigma_{\text {individual }}^{2}+\sigma^{2} &amp; , \text { if } i_{1}=i_{2}\end{cases}\)</span></p>
<div id="guassian-model-of-spatial-correlation" class="section level4 hasAnchor" number="6.5.18.1">
<h4><span class="header-section-number">6.5.18.1</span> Guassian model of spatial correlation<a href="statistical-models.html#guassian-model-of-spatial-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>depending on “how far” observations are apart are known as spatial.</p>
<p><span class="math display">\[
V_{i_{1}, i_{2}}= \begin{cases}0 &amp; , \text { if individual } i_{1} \neq \text { individual } i_{2} \text { and } i_{1} \neq i_{2} \\ \nu^{2}+\tau^{2} \exp \left\{\frac{-\left(t_{i_{1}}-t_{i_{2}}\right)^{2}}{\rho^{2}}\right\} &amp; , \text { if individual } i_{1}=\text { individual } i_{2} \text { and } i_{1} \neq i_{2} \\ \nu^{2}+\tau^{2}+\sigma^{2} &amp; , \text { if } i_{1}=i_{2}\end{cases}
\]</span>
#### <span class="math inline">\(\mathrm{R}\)</span> has several build-in correlation structures:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\text { Write in R } &amp; \text { Name } &amp; \text { Correlation term } \\
\hline \text { corGaus } &amp; \text { Gaussian } &amp; \tau^{2} \exp \left\{\frac{-\left(t_{i_{1}}-t_{i_{2}}\right)^{2}}{\rho^{2}}\right\} \\
\text { corExp } &amp; \text { exponential } &amp; \tau^{2} \exp \left\{\frac{-\left|t_{i_{1}}-t_{i_{2}}\right|}{\rho \rho}\right\} \\
\text { corAR1 } &amp; \text { autoregressive(1) } &amp; \tau^{2} \rho^{\left|i_{1}-i_{2}\right|} \\
\text { corSymm } &amp; \text { unstructured } &amp; \tau_{i_{1}, i_{2}}^{2} \\
\hline
\end{array}
\]</span>
Notice:
- Keep it simple
- Graphical methods
- Information criteria: AIC or BIC<br />
- Try to cross-validate</p>
</div>
</div>
<div id="model-diagnostics" class="section level3 hasAnchor" number="6.5.19">
<h3><span class="header-section-number">6.5.19</span> Model diagnostics<a href="statistical-models.html#model-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>since
<span class="math display">\[
\hat{\epsilon}_{i}=y_{i}-\hat{y}_{i}
\]</span>
and
<span class="math display">\[
\operatorname{Var}\left(\hat{\epsilon}_{i}\right)=\sigma^{2}\left(1-h_{i}\right)^{2}
\]</span>
<code>where $h_{i}$ is the so-called leverage for observation $i$.</code></p>
<p>therefore,</p>
<p>Standardized residuals
<span class="math display">\[
\hat{\epsilon}_{i}=\frac{y_{i}-\hat{y}_{i}}{\hat{\sigma}\left(1-h_{i}\right)}
\]</span></p>
<p>Studentized residuals
<span class="math display">\[
\hat{\epsilon}_{i}=\frac{y_{i}-\hat{y}_{i}}{\hat{\sigma}_{(i)}\left(1-h_{i}\right)}
\]</span></p>

</div>
</div>
<div id="linear-mixed-model-practice" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Linear mixed model practice<a href="statistical-models.html#linear-mixed-model-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="loading-data-and-library" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Loading data and library<a href="statistical-models.html#loading-data-and-library" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="statistical-models.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># load library</span></span>
<span id="cb738-2"><a href="statistical-models.html#cb738-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arm) <span class="co"># convenience functions for regression in R</span></span></code></pre></div>
<pre><code>## 
## arm (Version 1.13-1, built: 2022-8-25)</code></pre>
<pre><code>## Working directory is C:/Users/hed2/Downloads/mybook2/mybook2</code></pre>
<pre><code>## 
## Attaching package: &#39;arm&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:performance&#39;:
## 
##     display</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     logit, rescale, sim</code></pre>
<pre><code>## The following object is masked from &#39;package:plotrix&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following object is masked from &#39;package:corrplot&#39;:
## 
##     corrplot</code></pre>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="statistical-models.html#cb749-1" aria-hidden="true" tabindex="-1"></a>lmm.data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://bayes.acs.unt.edu:8083/BayesContent/class/Jon/R_SC/Module9/lmm.data.txt&quot;</span>,</span>
<span id="cb749-2"><a href="statistical-models.html#cb749-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>, <span class="at">na.strings=</span><span class="st">&quot;NA&quot;</span>, <span class="at">dec=</span><span class="st">&quot;.&quot;</span>, <span class="at">strip.white=</span><span class="cn">TRUE</span>)</span>
<span id="cb749-3"><a href="statistical-models.html#cb749-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(lmm.data)</span></span>
<span id="cb749-4"><a href="statistical-models.html#cb749-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lmm.data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="right">extro</th>
<th align="right">open</th>
<th align="right">agree</th>
<th align="right">social</th>
<th align="left">class</th>
<th align="left">school</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">63.69356</td>
<td align="right">43.43306</td>
<td align="right">38.02668</td>
<td align="right">75.05811</td>
<td align="left">d</td>
<td align="left">IV</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">69.48244</td>
<td align="right">46.86979</td>
<td align="right">31.48957</td>
<td align="right">98.12560</td>
<td align="left">a</td>
<td align="left">VI</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">79.74006</td>
<td align="right">32.27013</td>
<td align="right">40.20866</td>
<td align="right">116.33897</td>
<td align="left">d</td>
<td align="left">VI</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">62.96674</td>
<td align="right">44.40790</td>
<td align="right">30.50866</td>
<td align="right">90.46888</td>
<td align="left">c</td>
<td align="left">IV</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">64.24582</td>
<td align="right">36.86337</td>
<td align="right">37.43949</td>
<td align="right">98.51873</td>
<td align="left">d</td>
<td align="left">IV</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">50.97107</td>
<td align="right">46.25627</td>
<td align="right">38.83196</td>
<td align="right">75.21992</td>
<td align="left">d</td>
<td align="left">I</td>
</tr>
</tbody>
</table>
</div>
<div id="general-linear-regression" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> General linear regression<a href="statistical-models.html#general-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="statistical-models.html#cb750-1" aria-hidden="true" tabindex="-1"></a>OLSexamp <span class="ot">&lt;-</span> <span class="fu">lm</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social, <span class="at">data =</span> lmm.data)</span>
<span id="cb750-2"><a href="statistical-models.html#cb750-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(OLSexamp)</span></code></pre></div>
<pre><code>## lm(formula = extro ~ open + agree + social, data = lmm.data)
##             coef.est coef.se
## (Intercept) 57.84     3.15  
## open         0.02     0.05  
## agree        0.03     0.05  
## social       0.01     0.02  
## ---
## n = 1200, k = 4
## residual sd = 9.34, R-Squared = 0.00</code></pre>
</div>
<div id="generalized-linear-regression" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Generalized linear regression<a href="statistical-models.html#generalized-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="statistical-models.html#cb752-1" aria-hidden="true" tabindex="-1"></a>MLexamp <span class="ot">&lt;-</span> <span class="fu">glm</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social, <span class="at">data=</span>lmm.data)</span>
<span id="cb752-2"><a href="statistical-models.html#cb752-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp)</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social, data = lmm.data)
##             coef.est coef.se
## (Intercept) 57.84     3.15  
## open         0.02     0.05  
## agree        0.03     0.05  
## social       0.01     0.02  
## ---
##   n = 1200, k = 4
##   residual deviance = 104378.2, null deviance = 104432.7 (difference = 54.5)
##   overdispersion parameter = 87.3
##   residual sd is sqrt(overdispersion) = 9.34</code></pre>
</div>
<div id="varying-intercept-by-adding-a-stratum-variable-as-fixed-effect-glm" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Varying intercept by adding a stratum variable as fixed effect (glm)<a href="statistical-models.html#varying-intercept-by-adding-a-stratum-variable-as-fixed-effect-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="statistical-models.html#cb754-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> class, <span class="at">data=</span>lmm.data )</span>
<span id="cb754-2"><a href="statistical-models.html#cb754-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social + class, data = lmm.data)
##             coef.est coef.se
## (Intercept) 56.05     3.09  
## open         0.03     0.05  
## agree       -0.01     0.05  
## social       0.01     0.02  
## classb       2.06     0.75  
## classc       3.70     0.75  
## classd       5.67     0.75  
## ---
##   n = 1200, k = 7
##   residual deviance = 99187.7, null deviance = 104432.7 (difference = 5245.0)
##   overdispersion parameter = 83.1
##   residual sd is sqrt(overdispersion) = 9.12</code></pre>
</div>
<div id="comparisions-of-models" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> Comparisions of models<a href="statistical-models.html#comparisions-of-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>add class as fixed effect</li>
</ul>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="statistical-models.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp)</span></code></pre></div>
<pre><code>## [1] 8774.291</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="statistical-models.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 8719.083</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="statistical-models.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(MLexamp, MLexamp<span class="fl">.2</span>, <span class="at">test=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Resid. Df</th>
<th align="right">Resid. Dev</th>
<th align="right">Df</th>
<th align="right">Deviance</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1196</td>
<td align="right">104378.15</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1193</td>
<td align="right">99187.68</td>
<td align="right">3</td>
<td align="right">5190.471</td>
<td align="right">20.80982</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="adding-class-and-school-as-fixed-effects-glm" class="section level3 hasAnchor" number="6.6.6">
<h3><span class="header-section-number">6.6.6</span> Adding class and school as fixed effects (glm)<a href="statistical-models.html#adding-class-and-school-as-fixed-effects-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="statistical-models.html#cb761-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> school<span class="sc">:</span>class, <span class="at">data=</span>lmm.data )</span>
<span id="cb761-2"><a href="statistical-models.html#cb761-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social + school:class, data = lmm.data)
##                  coef.est coef.se
## (Intercept)       80.36     0.37 
## open               0.01     0.00 
## agree             -0.01     0.01 
## social             0.00     0.00 
## schoolI:classa   -40.39     0.20 
## schoolII:classa  -28.15     0.20 
## schoolIII:classa -23.58     0.20 
## schoolIV:classa  -19.76     0.20 
## schoolV:classa   -15.50     0.20 
## schoolVI:classa  -10.46     0.20 
## schoolI:classb   -34.60     0.20 
## schoolII:classb  -26.76     0.20 
## schoolIII:classb -22.59     0.20 
## schoolIV:classb  -18.71     0.20 
## schoolV:classb   -14.31     0.20 
## schoolVI:classb   -8.54     0.20 
## schoolI:classc   -31.86     0.20 
## schoolII:classc  -25.64     0.20 
## schoolIII:classc -21.58     0.20 
## schoolIV:classc  -17.58     0.20 
## schoolV:classc   -13.38     0.20 
## schoolVI:classc   -5.58     0.20 
## schoolI:classd   -30.00     0.20 
## schoolII:classd  -24.57     0.20 
## schoolIII:classd -20.64     0.20 
## schoolIV:classd  -16.60     0.20 
## schoolV:classd   -12.04     0.20 
## ---
##   n = 1200, k = 27
##   residual deviance = 1135.9, null deviance = 104432.7 (difference = 103296.8)
##   overdispersion parameter = 1.0
##   residual sd is sqrt(overdispersion) = 0.98</code></pre>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="statistical-models.html#cb763-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp)</span></code></pre></div>
<pre><code>## [1] 8774.291</code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="statistical-models.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>## [1] 3395.573</code></pre>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="statistical-models.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(MLexamp, MLexamp<span class="fl">.4</span>, <span class="at">test=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Resid. Df</th>
<th align="right">Resid. Dev</th>
<th align="right">Df</th>
<th align="right">Deviance</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1196</td>
<td align="right">104378.151</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1173</td>
<td align="right">1135.896</td>
<td align="right">23</td>
<td align="right">103242.3</td>
<td align="right">4635.419</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="considering-different-slopes-by-stratum-glm" class="section level3 hasAnchor" number="6.6.7">
<h3><span class="header-section-number">6.6.7</span> Considering different slopes by stratum (glm)<a href="statistical-models.html#considering-different-slopes-by-stratum-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="statistical-models.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(plyr)</span>
<span id="cb768-2"><a href="statistical-models.html#cb768-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-3"><a href="statistical-models.html#cb768-3" aria-hidden="true" tabindex="-1"></a>modellist <span class="ot">&lt;-</span> <span class="fu">dlply</span>(lmm.data, .(school, class), <span class="cf">function</span>(x) </span>
<span id="cb768-4"><a href="statistical-models.html#cb768-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">glm</span>(extro<span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social, <span class="at">data=</span>x))</span>
<span id="cb768-5"><a href="statistical-models.html#cb768-5" aria-hidden="true" tabindex="-1"></a>strat1 <span class="ot">&lt;-</span> <span class="fu">display</span>(modellist[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social, data = x)
##             coef.est coef.se
## (Intercept) 35.87     5.90  
## open         0.05     0.09  
## agree        0.02     0.10  
## social       0.01     0.03  
## ---
##   n = 50, k = 4
##   residual deviance = 500.2, null deviance = 506.2 (difference = 5.9)
##   overdispersion parameter = 10.9
##   residual sd is sqrt(overdispersion) = 3.30</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="statistical-models.html#cb770-1" aria-hidden="true" tabindex="-1"></a>strat2 <span class="ot">&lt;-</span> <span class="fu">display</span>(modellist[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social, data = x)
##             coef.est coef.se
## (Intercept) 47.96     2.16  
## open        -0.01     0.03  
## agree       -0.03     0.03  
## social      -0.01     0.01  
## ---
##   n = 50, k = 4
##   residual deviance = 47.9, null deviance = 49.1 (difference = 1.2)
##   overdispersion parameter = 1.0
##   residual sd is sqrt(overdispersion) = 1.02</code></pre>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="statistical-models.html#cb772-1" aria-hidden="true" tabindex="-1"></a>strat24 <span class="ot">&lt;-</span> <span class="fu">display</span>(modellist[[<span class="dv">24</span>]])</span></code></pre></div>
<pre><code>## glm(formula = extro ~ open + agree + social, data = x)
##             coef.est coef.se
## (Intercept) 80.36     4.10  
## open         0.12     0.07  
## agree       -0.12     0.06  
## social      -0.01     0.02  
## ---
##   n = 50, k = 4
##   residual deviance = 323.1, null deviance = 363.1 (difference = 40.0)
##   overdispersion parameter = 7.0
##   residual sd is sqrt(overdispersion) = 2.65</code></pre>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="statistical-models.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp)</span></code></pre></div>
<pre><code>## [1] 8774.291</code></pre>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="statistical-models.html#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(strat1)</span></span>
<span id="cb776-2"><a href="statistical-models.html#cb776-2" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(strat2)</span></span>
<span id="cb776-3"><a href="statistical-models.html#cb776-3" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC(strat24)</span></span></code></pre></div>
<p><code>how to combine these models?</code></p>
</div>
<div id="varying-intercept-with-lmm" class="section level3 hasAnchor" number="6.6.8">
<h3><span class="header-section-number">6.6.8</span> Varying intercept with LMM<a href="statistical-models.html#varying-intercept-with-lmm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>add class as random effect</li>
</ul>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="statistical-models.html#cb777-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>class), <span class="at">data=</span>lmm.data)</span>
<span id="cb777-2"><a href="statistical-models.html#cb777-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.6</span>)</span></code></pre></div>
<pre><code>## lmer(formula = extro ~ open + agree + social + (1 | class), data = lmm.data)
##             coef.est coef.se
## (Intercept) 58.86     3.29  
## open         0.03     0.05  
## agree        0.00     0.05  
## social       0.01     0.02  
## 
## Error terms:
##  Groups   Name        Std.Dev.
##  class    (Intercept) 2.35    
##  Residual             9.12    
## ---
## number of obs: 1200, groups: class, 4
## AIC = 8742.8, DIC = 8705.4
## deviance = 8718.1</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="statistical-models.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 8719.083</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="statistical-models.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.6</span>)</span></code></pre></div>
<pre><code>## [1] 8742.792</code></pre>
<ul>
<li>add class and school as random effects</li>
</ul>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="statistical-models.html#cb783-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>school) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>class), <span class="at">data=</span>lmm.data)</span>
<span id="cb783-2"><a href="statistical-models.html#cb783-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.7</span>)</span></code></pre></div>
<pre><code>## lmer(formula = extro ~ open + agree + social + (1 | school) + 
##     (1 | class), data = lmm.data)
##             coef.est coef.se
## (Intercept) 60.20     4.21  
## open         0.01     0.01  
## agree       -0.01     0.01  
## social       0.00     0.00  
## 
## Error terms:
##  Groups   Name        Std.Dev.
##  school   (Intercept) 9.79    
##  class    (Intercept) 2.41    
##  Residual             1.67    
## ---
## number of obs: 1200, groups: school, 6; class, 4
## AIC = 4737.9, DIC = 4683.3
## deviance = 4703.6</code></pre>
<ul>
<li>fit nested terms <code>school/class</code></li>
</ul>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="statistical-models.html#cb785-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>school<span class="sc">/</span>class), <span class="at">data=</span>lmm.data)</span>
<span id="cb785-2"><a href="statistical-models.html#cb785-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.8</span>)</span></code></pre></div>
<pre><code>## lmer(formula = extro ~ open + agree + social + (1 | school/class), 
##     data = lmm.data)
##             coef.est coef.se
## (Intercept) 60.24     4.01  
## open         0.01     0.00  
## agree       -0.01     0.01  
## social       0.00     0.00  
## 
## Error terms:
##  Groups       Name        Std.Dev.
##  class:school (Intercept) 2.86    
##  school       (Intercept) 9.69    
##  Residual                 0.98    
## ---
## number of obs: 1200, groups: class:school, 24; school, 6
## AIC = 3568.6, DIC = 3507.6
## deviance = 3531.1</code></pre>
</div>
<div id="varying-slope-with-lmm" class="section level3 hasAnchor" number="6.6.9">
<h3><span class="header-section-number">6.6.9</span> Varying slope with LMM<a href="statistical-models.html#varying-slope-with-lmm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="statistical-models.html#cb787-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extro <span class="sc">~</span> open <span class="sc">+</span> agree <span class="sc">+</span> social <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>open<span class="sc">|</span>school<span class="sc">/</span>class), <span class="at">data=</span>lmm.data)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="statistical-models.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(MLexamp<span class="fl">.9</span>)</span></code></pre></div>
<pre><code>## lmer(formula = extro ~ open + agree + social + (1 + open | school/class), 
##     data = lmm.data)
##             coef.est coef.se
## (Intercept) 60.26     3.81  
## open         0.01     0.01  
## agree       -0.01     0.01  
## social       0.00     0.00  
## 
## Error terms:
##  Groups       Name        Std.Dev. Corr 
##  class:school (Intercept) 2.67          
##               open        0.01     1.00 
##  school       (Intercept) 9.20          
##               open        0.00     1.00 
##  Residual                 0.98          
## ---
## number of obs: 1200, groups: class:school, 24; school, 6
## AIC = 3574.8, DIC = 3505.8
## deviance = 3529.3</code></pre>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="statistical-models.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.4</span>) <span class="co">#using the interaction of class and school as fixed effect</span></span></code></pre></div>
<pre><code>## [1] 3395.573</code></pre>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="statistical-models.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.7</span>) <span class="co">#using class and school as random intercepts</span></span></code></pre></div>
<pre><code>## [1] 4737.868</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="statistical-models.html#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.8</span>) <span class="co">#using nested term of class and school as random intercepts</span></span></code></pre></div>
<pre><code>## [1] 3568.571</code></pre>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="statistical-models.html#cb797-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(MLexamp<span class="fl">.9</span>) <span class="co">#adding open as random slope based on MLexamp.8</span></span></code></pre></div>
<pre><code>## [1] 3574.754</code></pre>
</div>
<div id="summary-the-model-8" class="section level3 hasAnchor" number="6.6.10">
<h3><span class="header-section-number">6.6.10</span> Summary the model 8<a href="statistical-models.html#summary-the-model-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="statistical-models.html#cb799-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MLexamp<span class="fl">.8</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: extro ~ open + agree + social + (1 | school/class)
##    Data: lmm.data
## 
## REML criterion at convergence: 3554.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -9.9949 -0.3348  0.0057  0.3394 10.6476 
## 
## Random effects:
##  Groups       Name        Variance Std.Dev.
##  class:school (Intercept)  8.2043  2.8643  
##  school       (Intercept) 93.8419  9.6872  
##  Residual                  0.9684  0.9841  
## Number of obs: 1200, groups:  class:school, 24; school, 6
## 
## Fixed effects:
##               Estimate Std. Error t value
## (Intercept) 60.2378227  4.0117874  15.015
## open         0.0061065  0.0049636   1.230
## agree       -0.0076659  0.0056986  -1.345
## social       0.0005404  0.0018524   0.292
## 
## Correlation of Fixed Effects:
##        (Intr) open   agree 
## open   -0.049              
## agree  -0.049 -0.012       
## social -0.045 -0.006 -0.009</code></pre>
<p><code>in random effect variances, the nested effect of class within the higher level variable and the random effect of the higher level variable. If all the percentages for each random effect (each part/ the total) are very small, then the random effects are not present and linear mixed modeling is not appropriate.</code></p>
<ul>
<li>testing random effect</li>
</ul>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="statistical-models.html#cb801-1" aria-hidden="true" tabindex="-1"></a><span class="co"># W2 will have to build the test statistic by hand because we cannot rely on asymptotics</span></span>
<span id="cb801-2"><a href="statistical-models.html#cb801-2" aria-hidden="true" tabindex="-1"></a>L_Model<span class="ot">=</span> <span class="fu">logLik</span>(MLexamp<span class="fl">.8</span>)[<span class="dv">1</span>]</span>
<span id="cb801-3"><a href="statistical-models.html#cb801-3" aria-hidden="true" tabindex="-1"></a>L_Model1<span class="ot">=</span><span class="fu">logLik</span>(MLexamp<span class="fl">.9</span>)[<span class="dv">1</span>]</span>
<span id="cb801-4"><a href="statistical-models.html#cb801-4" aria-hidden="true" tabindex="-1"></a>LRT_statistic<span class="ot">=</span><span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(L_Model1<span class="sc">-</span>L_Model)</span>
<span id="cb801-5"><a href="statistical-models.html#cb801-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Model has 3 parameters associated with the Random Effects</span></span>
<span id="cb801-6"><a href="statistical-models.html#cb801-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Model1 has 1 parameter associated with the Random Effects</span></span>
<span id="cb801-7"><a href="statistical-models.html#cb801-7" aria-hidden="true" tabindex="-1"></a><span class="co"># DF=2</span></span>
<span id="cb801-8"><a href="statistical-models.html#cb801-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We will look at a mixture of chi-squared distributions with 1 and 2 degrees of freedom</span></span>
<span id="cb801-9"><a href="statistical-models.html#cb801-9" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5</span><span class="sc">*</span><span class="fu">pchisq</span>(LRT_statistic,<span class="at">df=</span><span class="dv">2</span>,<span class="at">lower.tail =</span> F)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">pchisq</span>(LRT_statistic,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<ul>
<li>plot a x and y by grouping variables</li>
</ul>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="statistical-models.html#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb803-2"><a href="statistical-models.html#cb803-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmm.data,<span class="fu">aes</span>(<span class="at">x=</span> open,<span class="at">y=</span>extro  ,<span class="at">group=</span>school,<span class="at">color=</span> school))<span class="sc">+</span><span class="fu">geom_line</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
<ul>
<li>Plot of Residuals by grouping variables</li>
</ul>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="statistical-models.html#cb804-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MLexamp<span class="fl">.8</span>, school<span class="sc">~</span><span class="fu">resid</span>(.))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-404-1.png" width="672" /></p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="statistical-models.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MLexamp<span class="fl">.8</span>, class<span class="sc">~</span><span class="fu">resid</span>(.))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-404-2.png" width="672" /></p>
<ul>
<li>Plot Residuals by explanatory variables</li>
</ul>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="statistical-models.html#cb806-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MLexamp<span class="fl">.8</span>, <span class="fu">resid</span>(.)<span class="sc">~</span>open)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-405-1.png" width="672" /></p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="statistical-models.html#cb807-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(MLexamp.8,resid(.,type=&quot;p&quot;)~fitted(.) | BMIGRP_fm002)</span></span></code></pre></div>
<ul>
<li>QQ plot of residuals</li>
</ul>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="statistical-models.html#cb808-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(MLexamp<span class="fl">.8</span>)  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-406-1.png" width="672" /></p>
<ul>
<li>Random effect coefficients normality</li>
</ul>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="statistical-models.html#cb809-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span> ((<span class="fu">ranef</span>(MLexamp<span class="fl">.8</span>)[<span class="dv">1</span>])[[<span class="st">&quot;class:school&quot;</span>]])</span>
<span id="cb809-2"><a href="statistical-models.html#cb809-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span> ((test<span class="sc">$</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>) )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-407-1.png" width="672" /></p>
</div>
<div id="extracting-elements-parameters" class="section level3 hasAnchor" number="6.6.11">
<h3><span class="header-section-number">6.6.11</span> Extracting elements (parameters)<a href="statistical-models.html#extracting-elements-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>fixed effect coefficients</li>
</ul>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="statistical-models.html#cb810-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(MLexamp<span class="fl">.8</span>) </span></code></pre></div>
<pre><code>##   (Intercept)          open         agree        social 
## 60.2378227199  0.0061065139 -0.0076659234  0.0005404066</code></pre>
<ul>
<li>random effect coefficients</li>
</ul>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="statistical-models.html#cb812-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ranef</span>(MLexamp<span class="fl">.8</span>) </span></code></pre></div>
<pre><code>## $`class:school`
##       (Intercept)
## a:I    -6.4667512
## a:II   -1.9994013
## a:III  -1.5196312
## a:IV   -1.5496936
## a:V    -1.5551474
## a:VI   -4.0069544
## b:I    -0.6892956
## b:II   -0.6113909
## b:III  -0.5356311
## b:IV   -0.5050668
## b:V    -0.3674627
## b:VI   -2.0891795
## c:I     2.0467886
## c:II    0.5096079
## c:III   0.4718805
## c:IV    0.6227982
## c:V     0.5644201
## c:VI    0.8638052
## d:I     3.9033142
## d:II    1.5740706
## d:III   1.4138302
## d:IV    1.5992023
## d:V     1.8981080
## d:VI    6.4277799
## 
## $school
##     (Intercept)
## I    -13.793761
## II    -6.029202
## III   -1.939355
## IV     1.912916
## V      6.175660
## VI    13.673742
## 
## with conditional variances for &quot;class:school&quot; &quot;school&quot;</code></pre>
<ul>
<li>total coefficients for model (random + fixed)</li>
</ul>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="statistical-models.html#cb814-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(MLexamp<span class="fl">.8</span>)</span></code></pre></div>
<pre><code>## $`class:school`
##       (Intercept)        open        agree       social
## a:I      53.77107 0.006106514 -0.007665923 0.0005404066
## a:II     58.23842 0.006106514 -0.007665923 0.0005404066
## a:III    58.71819 0.006106514 -0.007665923 0.0005404066
## a:IV     58.68813 0.006106514 -0.007665923 0.0005404066
## a:V      58.68268 0.006106514 -0.007665923 0.0005404066
## a:VI     56.23087 0.006106514 -0.007665923 0.0005404066
## b:I      59.54853 0.006106514 -0.007665923 0.0005404066
## b:II     59.62643 0.006106514 -0.007665923 0.0005404066
## b:III    59.70219 0.006106514 -0.007665923 0.0005404066
## b:IV     59.73276 0.006106514 -0.007665923 0.0005404066
## b:V      59.87036 0.006106514 -0.007665923 0.0005404066
## b:VI     58.14864 0.006106514 -0.007665923 0.0005404066
## c:I      62.28461 0.006106514 -0.007665923 0.0005404066
## c:II     60.74743 0.006106514 -0.007665923 0.0005404066
## c:III    60.70970 0.006106514 -0.007665923 0.0005404066
## c:IV     60.86062 0.006106514 -0.007665923 0.0005404066
## c:V      60.80224 0.006106514 -0.007665923 0.0005404066
## c:VI     61.10163 0.006106514 -0.007665923 0.0005404066
## d:I      64.14114 0.006106514 -0.007665923 0.0005404066
## d:II     61.81189 0.006106514 -0.007665923 0.0005404066
## d:III    61.65165 0.006106514 -0.007665923 0.0005404066
## d:IV     61.83702 0.006106514 -0.007665923 0.0005404066
## d:V      62.13593 0.006106514 -0.007665923 0.0005404066
## d:VI     66.66560 0.006106514 -0.007665923 0.0005404066
## 
## $school
##     (Intercept)        open        agree       social
## I      46.44406 0.006106514 -0.007665923 0.0005404066
## II     54.20862 0.006106514 -0.007665923 0.0005404066
## III    58.29847 0.006106514 -0.007665923 0.0005404066
## IV     62.15074 0.006106514 -0.007665923 0.0005404066
## V      66.41348 0.006106514 -0.007665923 0.0005404066
## VI     73.91157 0.006106514 -0.007665923 0.0005404066
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<ul>
<li>predicted values based on the model</li>
</ul>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="statistical-models.html#cb816-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(MLexamp<span class="fl">.8</span>)</span>
<span id="cb816-2"><a href="statistical-models.html#cb816-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yhat)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 63.76422 70.00245 80.29104 62.85973 63.74128 50.37281</code></pre>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="statistical-models.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(yhat) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Min.</th>
<th align="right">1st Qu.</th>
<th align="right">Median</th>
<th align="right">Mean</th>
<th align="right">3rd Qu.</th>
<th align="right">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">39.90131</td>
<td align="right">54.42539</td>
<td align="right">60.16062</td>
<td align="right">60.26744</td>
<td align="right">66.35197</td>
<td align="right">80.4983</td>
</tr>
</tbody>
</table>
<ul>
<li>residuals of model</li>
</ul>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="statistical-models.html#cb819-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(MLexamp<span class="fl">.8</span>)</span>
<span id="cb819-2"><a href="statistical-models.html#cb819-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(residuals)</span></code></pre></div>
<pre><code>##          1          2          3          4          5          6 
## -0.0706615 -0.5200163 -0.5509793  0.1070113  0.5045414  0.5982642</code></pre>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="statistical-models.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(residuals) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Min.</th>
<th align="right">1st Qu.</th>
<th align="right">Median</th>
<th align="right">Mean</th>
<th align="right">3rd Qu.</th>
<th align="right">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-9.835528</td>
<td align="right">-0.3294215</td>
<td align="right">0.0056099</td>
<td align="right">0</td>
<td align="right">0.3340266</td>
<td align="right">10.47782</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="statistical-models.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals,<span class="dv">50</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-412-1.png" width="672" /></p>
<!-- issues -->
<ul>
<li>Fitted lines (less variation)</li>
</ul>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="statistical-models.html#cb823-1" aria-hidden="true" tabindex="-1"></a>lmm.data<span class="sc">$</span>Fitted<span class="ot">=</span><span class="fu">predict</span>(MLexamp<span class="fl">.8</span>)</span>
<span id="cb823-2"><a href="statistical-models.html#cb823-2" aria-hidden="true" tabindex="-1"></a><span class="co"># subjects=unique(lmm.data$school) #Taking the identifiers and saving it</span></span>
<span id="cb823-3"><a href="statistical-models.html#cb823-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sam=&quot;V&quot; # Taking a random sample of 10 Subjects</span></span>
<span id="cb823-4"><a href="statistical-models.html#cb823-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb823-5"><a href="statistical-models.html#cb823-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmm.data    ,<span class="fu">aes</span>(<span class="at">x=</span>open ,<span class="at">y=</span>Fitted,<span class="at">group=</span>school,<span class="at">color=</span>school ) )<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">se=</span>F)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-413-1.png" width="672" /></p>
</div>
<div id="model-diagnostics-1" class="section level3 hasAnchor" number="6.6.12">
<h3><span class="header-section-number">6.6.12</span> Model diagnostics<a href="statistical-models.html#model-diagnostics-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="residuals-normality" class="section level4 hasAnchor" number="6.6.12.1">
<h4><span class="header-section-number">6.6.12.1</span> Residuals normality<a href="statistical-models.html#residuals-normality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="statistical-models.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb824-2"><a href="statistical-models.html#cb824-2" aria-hidden="true" tabindex="-1"></a>nurse <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="at">file=</span><span class="st">&quot;https://github.com/MultiLevelAnalysis/Datasets-third-edition-Multilevel-book/blob/master/chapter%202/Nurses/SPSS/Nurses.sav?raw=true&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="statistical-models.html#cb825-1" aria-hidden="true" tabindex="-1"></a>MLexamp<span class="fl">.18</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(stress <span class="sc">~</span> experien<span class="sc">+</span> wardtype<span class="sc">+</span> expcon  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>hospital<span class="sc">/</span>ward), <span class="at">data=</span>nurse)</span>
<span id="cb825-2"><a href="statistical-models.html#cb825-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MLexamp<span class="fl">.18</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: stress ~ experien + wardtype + expcon + (1 | hospital/ward)
##    Data: nurse
## 
## REML criterion at convergence: 1865.7
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.85886 -0.69376 -0.01469  0.68749  3.12171 
## 
## Random effects:
##  Groups        Name        Variance Std.Dev.
##  ward:hospital (Intercept) 0.3272   0.5720  
##  hospital      (Intercept) 0.2129   0.4614  
##  Residual                  0.2811   0.5302  
## Number of obs: 1000, groups:  ward:hospital, 100; hospital, 25
## 
## Fixed effects:
##              Estimate Std. Error t value
## (Intercept)  5.738157   0.147508  38.901
## experien    -0.024015   0.002932  -8.190
## wardtype     0.055586   0.119280   0.466
## expcon      -0.711551   0.119281  -5.965
## 
## Correlation of Fixed Effects:
##          (Intr) expern wrdtyp
## experien -0.343              
## wardtype -0.406  0.005       
## expcon   -0.407  0.007  0.000</code></pre>
<p><em><code>outcome is ordinal variable</code></em></p>
<p><code>residual vs. fitted values</code></p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="statistical-models.html#cb827-1" aria-hidden="true" tabindex="-1"></a>lmerresid <span class="ot">&lt;-</span> <span class="fu">resid</span>(MLexamp<span class="fl">.18</span>)</span>
<span id="cb827-2"><a href="statistical-models.html#cb827-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb827-3"><a href="statistical-models.html#cb827-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sqrt</span>(<span class="fu">abs</span>(lmerresid)) <span class="sc">~</span> <span class="fu">predict</span>(MLexamp<span class="fl">.18</span>))</span>
<span id="cb827-4"><a href="statistical-models.html#cb827-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lmerresid)</span>
<span id="cb827-5"><a href="statistical-models.html#cb827-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(lmerresid)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-416-1.png" width="672" /></p>
</div>
<div id="checking-for-variance-homogeneity" class="section level4 hasAnchor" number="6.6.12.2">
<h4><span class="header-section-number">6.6.12.2</span> Checking for variance homogeneity<a href="statistical-models.html#checking-for-variance-homogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>residual vs. explanatory variables</code></p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="statistical-models.html#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb828-2"><a href="statistical-models.html#cb828-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lmerresid <span class="sc">~</span> <span class="fu">fitted</span>(MLexamp<span class="fl">.18</span>))</span>
<span id="cb828-3"><a href="statistical-models.html#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(nurse, <span class="fu">plot</span>(lmerresid <span class="sc">~</span> experien , <span class="at">col =</span> <span class="fu">heat.colors</span>(<span class="dv">20</span>)))</span>
<span id="cb828-4"><a href="statistical-models.html#cb828-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(nurse, <span class="fu">plot</span>(lmerresid <span class="sc">~</span> wardtype , <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">3</span>)))</span>
<span id="cb828-5"><a href="statistical-models.html#cb828-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(nurse, <span class="fu">plot</span>(lmerresid <span class="sc">~</span> expcon , <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">5</span>)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-417-1.png" width="672" /></p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="statistical-models.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with(lmm.data, plot(lmerresid ~ class, col = rainbow(5)))</span></span></code></pre></div>
</div>
<div id="influence-points" class="section level4 hasAnchor" number="6.6.12.3">
<h4><span class="header-section-number">6.6.12.3</span> Influence points<a href="statistical-models.html#influence-points" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>Cook’s distance</code></p>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="statistical-models.html#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(influence.ME)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;influence.ME&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:arm&#39;:
## 
##     se.fixef</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     influence</code></pre>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="statistical-models.html#cb834-1" aria-hidden="true" tabindex="-1"></a>lmer3.infl <span class="ot">&lt;-</span> <span class="fu">influence</span>(MLexamp<span class="fl">.18</span>, <span class="at">obs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb834-2"><a href="statistical-models.html#cb834-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb834-3"><a href="statistical-models.html#cb834-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(lmer3.infl), <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-418-1.png" width="672" /></p>
</div>
<div id="random-effect-normality" class="section level4 hasAnchor" number="6.6.12.4">
<h4><span class="header-section-number">6.6.12.4</span> Random effect normality<a href="statistical-models.html#random-effect-normality" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="statistical-models.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb835-2"><a href="statistical-models.html#cb835-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(MLexamp<span class="fl">.18</span>)<span class="sc">$</span><span class="st">`</span><span class="at">ward:hospital</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-419-1.png" width="672" /></p>
</div>
<div id="post-hoc-analysis" class="section level4 hasAnchor" number="6.6.12.5">
<h4><span class="header-section-number">6.6.12.5</span> Post hoc analysis<a href="statistical-models.html#post-hoc-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ci: sd of random effect coeffcient</code></p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="statistical-models.html#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(MLexamp<span class="fl">.18</span>, <span class="at">parm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">oldNames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sd_(Intercept)|ward:hospital</td>
<td align="right">0.4761842</td>
<td align="right">0.6761929</td>
</tr>
<tr class="even">
<td align="left">sd_(Intercept)|hospital</td>
<td align="right">0.2874774</td>
<td align="right">0.6693897</td>
</tr>
<tr class="odd">
<td align="left">sigma</td>
<td align="right">0.5063298</td>
<td align="right">0.5553624</td>
</tr>
<tr class="even">
<td align="left">(Intercept)</td>
<td align="right">5.4497316</td>
<td align="right">6.0266362</td>
</tr>
</tbody>
</table>
<p><code>lsmeans (ideally means) plot</code></p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="statistical-models.html#cb838-1" aria-hidden="true" tabindex="-1"></a>mylsmeans <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(MLexamp<span class="fl">.18</span>, <span class="fu">c</span>(<span class="st">&quot;wardtype&quot;</span>, <span class="st">&quot;expcon&quot;</span> ))</span>
<span id="cb838-2"><a href="statistical-models.html#cb838-2" aria-hidden="true" tabindex="-1"></a>sum_mylsmeans <span class="ot">&lt;-</span> <span class="fu">summary</span>(mylsmeans)</span>
<span id="cb838-3"><a href="statistical-models.html#cb838-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(sum_mylsmeans, <span class="fu">interaction.plot</span>(wardtype , expcon ,emmean, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-421-1.png" width="672" /></p>
<p><code>paired lsmeans</code></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="statistical-models.html#cb839-1" aria-hidden="true" tabindex="-1"></a>sum_difflsmeans <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">pairs</span>(mylsmeans))</span>
<span id="cb839-2"><a href="statistical-models.html#cb839-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sum_difflsmeans)</span></code></pre></div>
<table>
<colgroup>
<col width="42%" />
<col width="12%" />
<col width="11%" />
<col width="10%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">wardtype0 expcon0 - wardtype1 expcon0</td>
<td align="right">-0.0555860</td>
<td align="right">0.1192798</td>
<td align="right">72.98116</td>
<td align="right">-0.4660131</td>
<td align="right">0.9662337</td>
</tr>
<tr class="even">
<td align="left">wardtype0 expcon0 - wardtype0 expcon1</td>
<td align="right">0.7115505</td>
<td align="right">0.1192816</td>
<td align="right">72.98594</td>
<td align="right">5.9652983</td>
<td align="right">0.0000005</td>
</tr>
<tr class="odd">
<td align="left">wardtype0 expcon0 - wardtype1 expcon1</td>
<td align="right">0.6559646</td>
<td align="right">0.1687026</td>
<td align="right">73.00821</td>
<td align="right">3.8882899</td>
<td align="right">0.0012380</td>
</tr>
<tr class="even">
<td align="left">wardtype1 expcon0 - wardtype0 expcon1</td>
<td align="right">0.7671365</td>
<td align="right">0.1686743</td>
<td align="right">72.95889</td>
<td align="right">4.5480350</td>
<td align="right">0.0001222</td>
</tr>
<tr class="odd">
<td align="left">wardtype1 expcon0 - wardtype1 expcon1</td>
<td align="right">0.7115505</td>
<td align="right">0.1192816</td>
<td align="right">72.98594</td>
<td align="right">5.9652983</td>
<td align="right">0.0000005</td>
</tr>
<tr class="even">
<td align="left">wardtype0 expcon1 - wardtype1 expcon1</td>
<td align="right">-0.0555860</td>
<td align="right">0.1192798</td>
<td align="right">72.98116</td>
<td align="right">-0.4660131</td>
<td align="right">0.9662337</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="statistical-models.html#cb840-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(sum_difflsmeans<span class="sc">$</span>SE)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-422-1.png" width="672" /></p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="statistical-models.html#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(sum_difflsmeans<span class="sc">$</span>estimate)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-422-2.png" width="672" /></p>
<p>A <code>plot</code> function</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="statistical-models.html#cb842-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(MLexamp<span class="fl">.18</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-423-1.png" width="672" /></p>
</div>
<div id="intra-class-correlation" class="section level4 hasAnchor" number="6.6.12.6">
<h4><span class="header-section-number">6.6.12.6</span> Intra class correlation<a href="statistical-models.html#intra-class-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It allows us to assess whether or not the random effect is present in the data.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="statistical-models.html#cb843-1" aria-hidden="true" tabindex="-1"></a> lmm.null <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extro <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>school), <span class="at">data =</span> lmm.data)</span>
<span id="cb843-2"><a href="statistical-models.html#cb843-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(lmm.null) </span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: extro ~ 1 + (1 | school)
##    Data: lmm.data
## 
## REML criterion at convergence: 5806.1
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.9773 -0.5315  0.0059  0.5298  6.2109 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept) 95.87    9.791   
##  Residual              7.14    2.672   
## Number of obs: 1200, groups:  school, 6
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   60.267      3.998   15.07</code></pre>
<p><code>indicates that 93.07% (95.8720 / 103.0119  ) of the variance in 'extro' can be "explained" by school group membership.</code></p>
</div>
</div>
<div id="notice" class="section level3 hasAnchor" number="6.6.13">
<h3><span class="header-section-number">6.6.13</span> Notice<a href="statistical-models.html#notice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Back transformed expected values (lsmeans) not ci</li>
<li>Box-Cox transformations</li>
</ul>

</div>
</div>
<div id="linear-mixed-model-covariance-decomposition-with-random-intercept--lme4" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Linear mixed model covariance decomposition with random intercept- lme4<a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-intercept--lme4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-data-1" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Load data<a href="statistical-models.html#load-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="statistical-models.html#cb845-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Orthodont, <span class="at">package=</span><span class="st">&quot;nlme&quot;</span>)</span>
<span id="cb845-2"><a href="statistical-models.html#cb845-2" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> Orthodont</span></code></pre></div>
<p>plot means and variances by higher level variable (grouping)</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="statistical-models.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">with</span>(Data, <span class="fu">tapply</span>(distance, <span class="fu">list</span>(<span class="at">subject =</span> Subject), mean)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-426-1.png" width="672" /></p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="statistical-models.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">with</span>(Data, <span class="fu">tapply</span>(distance, <span class="fu">list</span>(<span class="at">subject =</span> Subject), var)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-426-2.png" width="672" /></p>
</div>
<div id="using-glm" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Using glm<a href="statistical-models.html#using-glm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="statistical-models.html#cb848-1" aria-hidden="true" tabindex="-1"></a>fit.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(distance <span class="sc">~</span> age<span class="sc">+</span> Sex <span class="sc">+</span> Subject, <span class="at">data =</span> Data) </span>
<span id="cb848-2"><a href="statistical-models.html#cb848-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.lm)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">1</td>
<td align="right">235.3560</td>
<td align="right">235.356019</td>
<td align="right">114.838287</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">140.4649</td>
<td align="right">140.464857</td>
<td align="right">68.537629</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Subject</td>
<td align="right">25</td>
<td align="right">377.9148</td>
<td align="right">15.116591</td>
<td align="right">7.375904</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">80</td>
<td align="right">163.9565</td>
<td align="right">2.049456</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="using-glm-with-random-slopes" class="section level3 hasAnchor" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> Using glm with random slopes<a href="statistical-models.html#using-glm-with-random-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="statistical-models.html#cb849-1" aria-hidden="true" tabindex="-1"></a>fit.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(distance <span class="sc">~</span> age<span class="sc">+</span> Sex <span class="sc">+</span> <span class="fu">Error</span>(Subject), <span class="at">data =</span> Data) </span>
<span id="cb849-2"><a href="statistical-models.html#cb849-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.aov)</span></code></pre></div>
<pre><code>## 
## Error: Subject
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Sex        1  140.5  140.46   9.292 0.00538 **
## Residuals 25  377.9   15.12                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Within
##           Df Sum Sq Mean Sq F value Pr(&gt;F)    
## age        1  235.4  235.36   114.8 &lt;2e-16 ***
## Residuals 80  164.0    2.05                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><em>how can we compute <span class="math inline">\(σ^2\)</span> a from this output? note that <span class="math inline">\(σ^2\)</span>= MSE , and E(MSA) = <span class="math inline">\((σ_a)^2\)</span> +n·<span class="math inline">\(σ^2\)</span> ,therefore<span class="math inline">\((σ_a)^2\)</span> = (MSA−MSE)/n</em></p>
</div>
<div id="using-lmm" class="section level3 hasAnchor" number="6.7.4">
<h3><span class="header-section-number">6.7.4</span> Using lmm<a href="statistical-models.html#using-lmm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="statistical-models.html#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) </span>
<span id="cb851-2"><a href="statistical-models.html#cb851-2" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  <span class="sc">+</span>(<span class="dv">1</span> <span class="sc">|</span> Subject), <span class="at">data =</span> Data) </span>
<span id="cb851-3"><a href="statistical-models.html#cb851-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: distance ~ age + Sex + (1 | Subject)
##    Data: Data
## 
## REML criterion at convergence: 437.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.7489 -0.5503 -0.0252  0.4534  3.6575 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Subject  (Intercept) 3.267    1.807   
##  Residual             2.049    1.432   
## Number of obs: 108, groups:  Subject, 27
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 17.70671    0.83392  21.233
## age          0.66019    0.06161  10.716
## SexFemale   -2.32102    0.76142  -3.048
## 
## Correlation of Fixed Effects:
##           (Intr) age   
## age       -0.813       
## SexFemale -0.372  0.000</code></pre>
<p><strong>default is compound symmetry</strong></p>
</div>
<div id="get-xyz" class="section level3 hasAnchor" number="6.7.5">
<h3><span class="header-section-number">6.7.5</span> Get x,y,z<a href="statistical-models.html#get-xyz" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="statistical-models.html#cb853-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span>(<span class="fu">getME</span>(fit.lmer, <span class="st">&quot;X&quot;</span>))</span>
<span id="cb853-2"><a href="statistical-models.html#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">(Intercept)</th>
<th align="right">age</th>
<th align="right">SexFemale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">12</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">14</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="statistical-models.html#cb854-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">getME</span>(fit.lmer, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb854-2"><a href="statistical-models.html#cb854-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y)</span></code></pre></div>
<pre><code>## [1] 26.0 25.0 29.0 31.0 21.5 22.5</code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="statistical-models.html#cb856-1" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb856-2"><a href="statistical-models.html#cb856-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Z)</span></code></pre></div>
<pre><code>## 6 x 27 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 27 column names &#39;M16&#39;, &#39;M05&#39;, &#39;M02&#39; ... ]]</code></pre>
<pre><code>##                                                        
## 1 . . . . . . . . . . . . . . 1 . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . 1 . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . 1 . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . 1 . . . . . . . . . . . .
## 5 . . 1 . . . . . . . . . . . . . . . . . . . . . . . .
## 6 . . 1 . . . . . . . . . . . . . . . . . . . . . . . .</code></pre>
</div>
<div id="get-fixed-effect-and-random-effect-coefficients" class="section level3 hasAnchor" number="6.7.6">
<h3><span class="header-section-number">6.7.6</span> Get fixed effect and random effect coefficients<a href="statistical-models.html#get-fixed-effect-and-random-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="statistical-models.html#cb860-1" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer, <span class="st">&quot;fixef&quot;</span>) <span class="co">#getME(fit.lmer, &quot;beta&quot;)  # fixef(fit.lmer)</span></span>
<span id="cb860-2"><a href="statistical-models.html#cb860-2" aria-hidden="true" tabindex="-1"></a>bhat </span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  17.7067130   0.6601852  -2.3210227</code></pre>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="statistical-models.html#cb862-1" aria-hidden="true" tabindex="-1"></a>uhat <span class="ot">&lt;-</span> <span class="fu">ranef</span>(fit.lmer) </span>
<span id="cb862-2"><a href="statistical-models.html#cb862-2" aria-hidden="true" tabindex="-1"></a>uhat</span></code></pre></div>
<pre><code>## $Subject
##     (Intercept)
## M16 -1.70183357
## M05 -1.70183357
## M02 -1.37767479
## M11 -1.16156894
## M07 -1.05351602
## M08 -0.94546309
## M03 -0.62130432
## M12 -0.62130432
## M13 -0.62130432
## M14 -0.08103969
## M09  0.13506616
## M15  0.78338371
## M06  1.21559540
## M04  1.43170125
## M01  2.40417758
## M10  3.91691853
## F10 -3.58539251
## F09 -1.31628108
## F06 -1.31628108
## F01 -1.10017524
## F05 -0.01964599
## F07  0.30451279
## F02  0.30451279
## F08  0.62867156
## F03  0.95283034
## F04  1.92530666
## F11  3.22194176
## 
## with conditional variances for &quot;Subject&quot;</code></pre>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="statistical-models.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.lmer)</span></code></pre></div>
<pre><code>## $Subject
##     (Intercept)       age SexFemale
## M16    16.00488 0.6601852 -2.321023
## M05    16.00488 0.6601852 -2.321023
## M02    16.32904 0.6601852 -2.321023
## M11    16.54514 0.6601852 -2.321023
## M07    16.65320 0.6601852 -2.321023
## M08    16.76125 0.6601852 -2.321023
## M03    17.08541 0.6601852 -2.321023
## M12    17.08541 0.6601852 -2.321023
## M13    17.08541 0.6601852 -2.321023
## M14    17.62567 0.6601852 -2.321023
## M09    17.84178 0.6601852 -2.321023
## M15    18.49010 0.6601852 -2.321023
## M06    18.92231 0.6601852 -2.321023
## M04    19.13841 0.6601852 -2.321023
## M01    20.11089 0.6601852 -2.321023
## M10    21.62363 0.6601852 -2.321023
## F10    14.12132 0.6601852 -2.321023
## F09    16.39043 0.6601852 -2.321023
## F06    16.39043 0.6601852 -2.321023
## F01    16.60654 0.6601852 -2.321023
## F05    17.68707 0.6601852 -2.321023
## F07    18.01123 0.6601852 -2.321023
## F02    18.01123 0.6601852 -2.321023
## F08    18.33538 0.6601852 -2.321023
## F03    18.65954 0.6601852 -2.321023
## F04    19.63202 0.6601852 -2.321023
## F11    20.92865 0.6601852 -2.321023
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
</div>
<div id="get-random-effect-covariance-structure-covariance-matrix-expandation" class="section level3 hasAnchor" number="6.7.7">
<h3><span class="header-section-number">6.7.7</span> Get random effect covariance structure (covariance matrix expandation)<a href="statistical-models.html#get-random-effect-covariance-structure-covariance-matrix-expandation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="statistical-models.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theta &lt;- getME(fit.lmer, &quot;theta&quot;) # $r$</span></span>
<span id="cb866-2"><a href="statistical-models.html#cb866-2" aria-hidden="true" tabindex="-1"></a><span class="co"># theta**2+ getME(fit.lmer, &quot;sigma&quot;)**2 </span></span>
<span id="cb866-3"><a href="statistical-models.html#cb866-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb866-4"><a href="statistical-models.html#cb866-4" aria-hidden="true" tabindex="-1"></a><span class="co"># theta**2</span></span>
<span id="cb866-5"><a href="statistical-models.html#cb866-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lwr &lt;- getME(fit.lmer, &quot;lower&quot;)</span></span>
<span id="cb866-6"><a href="statistical-models.html#cb866-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lwr</span></span>
<span id="cb866-7"><a href="statistical-models.html#cb866-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-8"><a href="statistical-models.html#cb866-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lambda &lt;- getME(fit.lmer, &quot;Lambda&quot;) #  matrix</span></span>
<span id="cb866-9"><a href="statistical-models.html#cb866-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # head(Lambda)</span></span>
<span id="cb866-10"><a href="statistical-models.html#cb866-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # dim(Lambda)</span></span>
<span id="cb866-11"><a href="statistical-models.html#cb866-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Lambda%*%t(Lambda)</span></span></code></pre></div>
<p><code>the relationship $\Sigma = TSST'$</code>
<!-- https://stats.stackexchange.com/questions/242759/calculate-random-effect-predictions-manually-for-a-linear-mixed-model --></p>
<!-- # ```{r} -->
<!-- # # getME(fit.lmer, "ST") -->
<!-- # ``` -->
<code>the relationship of theta and covariance</code>
$$
= (
<span class="math display">\[\begin{array}{cc}
\theta_1 &amp; 0 \\
\theta_2 &amp; \theta_3
\end{array}\]</span>
)
(
<span class="math display">\[\begin{array}{cc}
\theta_1 &amp; \theta_2 \\
0 &amp; \theta_3
\end{array}\]</span>
) =
(
<span class="math display">\[\begin{array}{cc}
\theta_1^2 &amp; \theta_1 \theta_2 \\
\theta_1 \theta_2 &amp; \theta_2^2 + \theta_3^2
\end{array}\]</span>
) =
(
<span class="math display">\[\begin{array}{cc}
\sigma_1^2 &amp; \sigma_{12} \\
\sigma_{12} &amp; \sigma_2^2
\end{array}\]</span>
<p>)</p>
<p>$$</p>
<p><code>we can equate θ1 with σ1 (the standard deviation of the intercept), θ2 with σ12/σ1 (the covariance scaled by the SD) ... θ3 is a little more complicated. in particular, in a model with only random-intercept terms, the θ vector is just the vector of RE standard deviations.</code></p>
<p><code>The way lme4 works is that, given a value of θ, we can determine Σ</code></p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="statistical-models.html#cb867-1" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(fit.lmer) </span>
<span id="cb867-2"><a href="statistical-models.html#cb867-2" aria-hidden="true" tabindex="-1"></a>Lambda_new <span class="ot">&lt;-</span>vc[[<span class="st">&quot;Subject&quot;</span>]][<span class="dv">1</span>]<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">length</span>(<span class="fu">levels</span>(Data<span class="sc">$</span>Subject)))</span>
<span id="cb867-3"><a href="statistical-models.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lambda_new)</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="statistical-models.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Lambda_new)</span></code></pre></div>
<pre><code>## [1] 27 27</code></pre>
<ul>
<li><p><strong>“theta”: random-effects parameter estimates: these are parameterized as the relative Cholesky factors of each random effect term</strong></p></li>
<li><p><strong>use other cov structure by nlme</strong></p></li>
<li><p><strong>lme4 does not allow to specify it, and it can only fit LMMs with independent residual errors. However, the range of available variance-covariance matrices for the random effects are restricted to diagonal or general matrices. </strong></p></li>
</ul>
<!--   Get  ST    -->
<!-- ```{r} -->
<!-- ST <- getME(fit.lmer, "ST") # $r$  -->
<!-- ``` -->
<!-- https://rdrr.io/cran/lme4/man/getME.html -->
<!-- https://en.wikipedia.org/wiki/Cholesky_decomposition -->
<!--   Get lower   -->
<!-- ```{r} -->
<!-- lower <- getME(fit.lmer, "lower") # $r$  -->
<!-- lower -->
<!-- ``` -->
</div>
<div id="get-residual-variance-and-its-identity-matrix" class="section level3 hasAnchor" number="6.7.8">
<h3><span class="header-section-number">6.7.8</span> Get residual variance and its identity matrix<a href="statistical-models.html#get-residual-variance-and-its-identity-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="statistical-models.html#cb870-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer, <span class="st">&quot;sigma&quot;</span>)<span class="sc">**</span><span class="dv">2</span> </span>
<span id="cb870-2"><a href="statistical-models.html#cb870-2" aria-hidden="true" tabindex="-1"></a>sigma</span></code></pre></div>
<pre><code>## [1] 2.049456</code></pre>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="statistical-models.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sigma<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">nrow</span>(Data)))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">2.049456</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">2.049456</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">2.049456</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">2.049456</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">2.049456</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">2.049456</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="get-y-covariance-matrix" class="section level3 hasAnchor" number="6.7.9">
<h3><span class="header-section-number">6.7.9</span> Get y covariance matrix<a href="statistical-models.html#get-y-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="statistical-models.html#cb873-1" aria-hidden="true" tabindex="-1"></a>VM <span class="ot">&lt;-</span> Z<span class="sc">%*%</span>Lambda_new<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">+</span>sigma<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">nrow</span>(Data)) </span>
<span id="cb873-2"><a href="statistical-models.html#cb873-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(VM)</span></code></pre></div>
<pre><code>## 6 x 108 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 108 column names &#39;1&#39;, &#39;2&#39;, &#39;3&#39; ... ]]</code></pre>
<pre><code>##                                                                                
## 1 5.316240 3.266784 3.266784 3.266784 .        .        .        .        . . .
## 2 3.266784 5.316240 3.266784 3.266784 .        .        .        .        . . .
## 3 3.266784 3.266784 5.316240 3.266784 .        .        .        .        . . .
## 4 3.266784 3.266784 3.266784 5.316240 .        .        .        .        . . .
## 5 .        .        .        .        5.316240 3.266784 3.266784 3.266784 . . .
## 6 .        .        .        .        3.266784 5.316240 3.266784 3.266784 . . .
##                                                                                
## 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                                
## 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                        
## 1 . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . .</code></pre>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="statistical-models.html#cb877-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(VM)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="get-fixed-effect-coefficients-covariance-matrix" class="section level3 hasAnchor" number="6.7.10">
<h3><span class="header-section-number">6.7.10</span> Get fixed effect coefficients covariance matrix<a href="statistical-models.html#get-fixed-effect-coefficients-covariance-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="statistical-models.html#cb879-1" aria-hidden="true" tabindex="-1"></a>vcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(fit.lmer) <span class="co">#fixed cov</span></span>
<span id="cb879-2"><a href="statistical-models.html#cb879-2" aria-hidden="true" tabindex="-1"></a>vcov</span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dpoMatrix&quot;
##             (Intercept)           age     SexFemale
## (Intercept)  0.69542669 -4.174818e-02 -2.361967e-01
## age         -0.04174818  3.795289e-03 -3.051416e-17
## SexFemale   -0.23619673 -3.051416e-17  5.797556e-01</code></pre>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="statistical-models.html#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computer correlation coefficients </span></span>
<span id="cb881-2"><a href="statistical-models.html#cb881-2" aria-hidden="true" tabindex="-1"></a>vcov<span class="sc">@</span>x[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">prod</span>(<span class="fu">sqrt</span>( <span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer))[<span class="sc">-</span><span class="dv">3</span>] ))</span></code></pre></div>
<pre><code>## [1] -0.8126236</code></pre>
</div>
<div id="get-random-effect-coefficients-covariance-matrix-standard-deviation" class="section level3 hasAnchor" number="6.7.11">
<h3><span class="header-section-number">6.7.11</span> Get random effect coefficients covariance matrix (standard deviation)<a href="statistical-models.html#get-random-effect-coefficients-covariance-matrix-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="statistical-models.html#cb883-1" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(fit.lmer) </span>
<span id="cb883-2"><a href="statistical-models.html#cb883-2" aria-hidden="true" tabindex="-1"></a>vc <span class="do">## default print method: standard dev and corr</span></span></code></pre></div>
<pre><code>##  Groups   Name        Std.Dev.
##  Subject  (Intercept) 1.8074  
##  Residual             1.4316</code></pre>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="statistical-models.html#cb885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(Matrix<span class="sc">::</span><span class="fu">bdiag</span>(vc)) <span class="co">#random effect covariance matrix</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.266784</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="statistical-models.html#cb886-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/47307340/extracting-the-i-estimated-variance-covariance-matrix-of-random-effects-and-or</span></span>
<span id="cb886-2"><a href="statistical-models.html#cb886-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_mixed_sect022.htm</span></span></code></pre></div>
<p><code>approximate above sd</code></p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="statistical-models.html#cb887-1" aria-hidden="true" tabindex="-1"></a>uintercept <span class="ot">&lt;-</span> (uhat[[<span class="st">&quot;Subject&quot;</span>]])</span>
<span id="cb887-2"><a href="statistical-models.html#cb887-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(uintercept[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.647809</code></pre>
</div>
<div id="computer-fixed-effect-coefficients" class="section level3 hasAnchor" number="6.7.12">
<h3><span class="header-section-number">6.7.12</span> Computer fixed effect coefficients<a href="statistical-models.html#computer-fixed-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="statistical-models.html#cb889-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb889-2"><a href="statistical-models.html#cb889-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span>y</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">17.7067076</td>
</tr>
<tr class="even">
<td align="right">0.6601871</td>
</tr>
<tr class="odd">
<td align="right">-2.3210230</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="statistical-models.html#cb890-1" aria-hidden="true" tabindex="-1"></a>bhat</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  17.7067130   0.6601852  -2.3210227</code></pre>
</div>
<div id="computer-covariance-of-fixed-efffect-coefficients" class="section level3 hasAnchor" number="6.7.13">
<h3><span class="header-section-number">6.7.13</span> Computer covariance of fixed efffect coefficients<a href="statistical-models.html#computer-covariance-of-fixed-efffect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb892"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb892-1"><a href="statistical-models.html#cb892-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.6954267</td>
<td align="right">-0.0417482</td>
<td align="right">-0.2361967</td>
</tr>
<tr class="even">
<td align="right">-0.0417482</td>
<td align="right">0.0037953</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">-0.2361967</td>
<td align="right">0.0000000</td>
<td align="right">0.5797556</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="statistical-models.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb893-2"><a href="statistical-models.html#cb893-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X)))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.8339225</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="right">NaN</td>
<td align="right">0.0616059</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">NaN</td>
<td align="right">0.0000000</td>
<td align="right">0.7614169</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="statistical-models.html#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the following equals lmm summary</span></span>
<span id="cb894-2"><a href="statistical-models.html#cb894-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(fit.lmer) </span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dpoMatrix&quot;
##             (Intercept)           age     SexFemale
## (Intercept)  0.69542669 -4.174818e-02 -2.361967e-01
## age         -0.04174818  3.795289e-03 -3.051416e-17
## SexFemale   -0.23619673 -3.051416e-17  5.797556e-01</code></pre>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="statistical-models.html#cb896-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">vcov</span>(fit.lmer))</span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dsyMatrix&quot;
##             (Intercept)        age SexFemale
## (Intercept)   0.8339225        NaN       NaN
## age                 NaN 0.06160592       NaN
## SexFemale           NaN        NaN 0.7614168</code></pre>
<p><strong>default is compound symmetry</strong></p>
</div>
<div id="computer-random-effect-coefficients" class="section level3 hasAnchor" number="6.7.14">
<h3><span class="header-section-number">6.7.14</span> Computer random effect coefficients<a href="statistical-models.html#computer-random-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="statistical-models.html#cb898-1" aria-hidden="true" tabindex="-1"></a>comput_uhat <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(Lambda_new))<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span>(y<span class="sc">-</span><span class="fu">as.matrix</span>(X)<span class="sc">%*%</span>(bhat))</span>
<span id="cb898-2"><a href="statistical-models.html#cb898-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>((comput_uhat<span class="sc">@</span>x),(uhat[[<span class="st">&quot;Subject&quot;</span>]]))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">(<a href="mailto:comput_uhat@x" class="email">comput_uhat@x</a>)</th>
<th align="right">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M16</td>
<td align="right">-1.7018335</td>
<td align="right">-1.7018336</td>
</tr>
<tr class="even">
<td align="left">M05</td>
<td align="right">-1.7018335</td>
<td align="right">-1.7018336</td>
</tr>
<tr class="odd">
<td align="left">M02</td>
<td align="right">-1.3776748</td>
<td align="right">-1.3776748</td>
</tr>
<tr class="even">
<td align="left">M11</td>
<td align="right">-1.1615689</td>
<td align="right">-1.1615689</td>
</tr>
<tr class="odd">
<td align="left">M07</td>
<td align="right">-1.0535160</td>
<td align="right">-1.0535160</td>
</tr>
<tr class="even">
<td align="left">M08</td>
<td align="right">-0.9454631</td>
<td align="right">-0.9454631</td>
</tr>
<tr class="odd">
<td align="left">M03</td>
<td align="right">-0.6213043</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="even">
<td align="left">M12</td>
<td align="right">-0.6213043</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="odd">
<td align="left">M13</td>
<td align="right">-0.6213043</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="even">
<td align="left">M14</td>
<td align="right">-0.0810397</td>
<td align="right">-0.0810397</td>
</tr>
<tr class="odd">
<td align="left">M09</td>
<td align="right">0.1350662</td>
<td align="right">0.1350662</td>
</tr>
<tr class="even">
<td align="left">M15</td>
<td align="right">0.7833837</td>
<td align="right">0.7833837</td>
</tr>
<tr class="odd">
<td align="left">M06</td>
<td align="right">1.2155954</td>
<td align="right">1.2155954</td>
</tr>
<tr class="even">
<td align="left">M04</td>
<td align="right">1.4317012</td>
<td align="right">1.4317013</td>
</tr>
<tr class="odd">
<td align="left">M01</td>
<td align="right">2.4041775</td>
<td align="right">2.4041776</td>
</tr>
<tr class="even">
<td align="left">M10</td>
<td align="right">3.9169184</td>
<td align="right">3.9169185</td>
</tr>
<tr class="odd">
<td align="left">F10</td>
<td align="right">-3.5853924</td>
<td align="right">-3.5853925</td>
</tr>
<tr class="even">
<td align="left">F09</td>
<td align="right">-1.3162811</td>
<td align="right">-1.3162811</td>
</tr>
<tr class="odd">
<td align="left">F06</td>
<td align="right">-1.3162811</td>
<td align="right">-1.3162811</td>
</tr>
<tr class="even">
<td align="left">F01</td>
<td align="right">-1.1001752</td>
<td align="right">-1.1001752</td>
</tr>
<tr class="odd">
<td align="left">F05</td>
<td align="right">-0.0196460</td>
<td align="right">-0.0196460</td>
</tr>
<tr class="even">
<td align="left">F07</td>
<td align="right">0.3045128</td>
<td align="right">0.3045128</td>
</tr>
<tr class="odd">
<td align="left">F02</td>
<td align="right">0.3045128</td>
<td align="right">0.3045128</td>
</tr>
<tr class="even">
<td align="left">F08</td>
<td align="right">0.6286716</td>
<td align="right">0.6286716</td>
</tr>
<tr class="odd">
<td align="left">F03</td>
<td align="right">0.9528303</td>
<td align="right">0.9528303</td>
</tr>
<tr class="even">
<td align="left">F04</td>
<td align="right">1.9253066</td>
<td align="right">1.9253067</td>
</tr>
<tr class="odd">
<td align="left">F11</td>
<td align="right">3.2219417</td>
<td align="right">3.2219418</td>
</tr>
</tbody>
</table>
<ul>
<li>covariance matrix of random effect coefficients</li>
</ul>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="statistical-models.html#cb899-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lambda_new)</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="computer-predicted-values" class="section level3 hasAnchor" number="6.7.15">
<h3><span class="header-section-number">6.7.15</span> Computer predicted values<a href="statistical-models.html#computer-predicted-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="statistical-models.html#cb900-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> X<span class="sc">%*%</span>(bhat)<span class="sc">+</span>Z<span class="sc">%*%</span>(uhat[[<span class="st">&quot;Subject&quot;</span>]][[<span class="st">&quot;(Intercept)&quot;</span>]])</span>
<span id="cb900-2"><a href="statistical-models.html#cb900-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yhat)</span></code></pre></div>
<pre><code>## 6 x 1 Matrix of class &quot;dgeMatrix&quot;
##       [,1]
## 1 25.39237
## 2 26.71274
## 3 28.03311
## 4 29.35348
## 5 21.61052
## 6 22.93089</code></pre>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="statistical-models.html#cb902-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(fit.lmer))</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 25.39237 26.71274 28.03311 29.35348 21.61052 22.93089</code></pre>

</div>
</div>
<div id="linear-mixed-model-covariance-decomposition-with-random-slopes--lme4" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Linear mixed model covariance decomposition with random slopes- lme4<a href="statistical-models.html#linear-mixed-model-covariance-decomposition-with-random-slopes--lme4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-data-2" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Load data<a href="statistical-models.html#load-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="statistical-models.html#cb904-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Orthodont, <span class="at">package=</span><span class="st">&quot;nlme&quot;</span>)</span>
<span id="cb904-2"><a href="statistical-models.html#cb904-2" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> Orthodont</span></code></pre></div>
</div>
<div id="using-lmm-1" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Using lmm<a href="statistical-models.html#using-lmm-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="statistical-models.html#cb905-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) </span>
<span id="cb905-2"><a href="statistical-models.html#cb905-2" aria-hidden="true" tabindex="-1"></a>fit.lmer.slope <span class="ot">&lt;-</span> <span class="fu">lmer</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  <span class="sc">+</span>(<span class="dv">1</span><span class="sc">+</span> age <span class="sc">|</span> Subject), <span class="at">data =</span> Data) </span>
<span id="cb905-3"><a href="statistical-models.html#cb905-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.slope)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: distance ~ age + Sex + (1 + age | Subject)
##    Data: Data
## 
## REML criterion at convergence: 435.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0815 -0.4568  0.0155  0.4471  3.8944 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  Subject  (Intercept) 7.82249  2.7969        
##           age         0.05126  0.2264   -0.77
##  Residual             1.71621  1.3100        
## Number of obs: 108, groups:  Subject, 27
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 17.63518    0.88623  19.899
## age          0.66019    0.07125   9.265
## SexFemale   -2.14544    0.75746  -2.832
## 
## Correlation of Fixed Effects:
##           (Intr) age   
## age       -0.838       
## SexFemale -0.348  0.000</code></pre>
<p><strong>default is compound symmetry</strong></p>
</div>
<div id="get-xyz-1" class="section level3 hasAnchor" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Get x,y,z<a href="statistical-models.html#get-xyz-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="statistical-models.html#cb907-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span>(<span class="fu">getME</span>(fit.lmer.slope, <span class="st">&quot;X&quot;</span>))</span>
<span id="cb907-2"><a href="statistical-models.html#cb907-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">(Intercept)</th>
<th align="right">age</th>
<th align="right">SexFemale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">12</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">14</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="statistical-models.html#cb908-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">getME</span>(fit.lmer.slope, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb908-2"><a href="statistical-models.html#cb908-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y)</span></code></pre></div>
<pre><code>## [1] 26.0 25.0 29.0 31.0 21.5 22.5</code></pre>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="statistical-models.html#cb910-1" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer.slope, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb910-2"><a href="statistical-models.html#cb910-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Z)</span></code></pre></div>
<pre><code>## 6 x 54 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 54 column names &#39;M16&#39;, &#39;M16&#39;, &#39;M05&#39; ... ]]</code></pre>
<pre><code>##                                                                                
## 1 . . . . .  . . . . . . . . . . . . . . . . . . . . . . . 1  8 . . . . . . . .
## 2 . . . . .  . . . . . . . . . . . . . . . . . . . . . . . 1 10 . . . . . . . .
## 3 . . . . .  . . . . . . . . . . . . . . . . . . . . . . . 1 12 . . . . . . . .
## 4 . . . . .  . . . . . . . . . . . . . . . . . . . . . . . 1 14 . . . . . . . .
## 5 . . . . 1  8 . . . . . . . . . . . . . . . . . . . . . . .  . . . . . . . . .
## 6 . . . . 1 10 . . . . . . . . . . . . . . . . . . . . . . .  . . . . . . . . .
##                                  
## 1 . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . .</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="statistical-models.html#cb914-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Z)</span></code></pre></div>
<pre><code>## [1] 108  54</code></pre>
</div>
<div id="get-fixed-effect-and-random-effect-coefficients-1" class="section level3 hasAnchor" number="6.8.4">
<h3><span class="header-section-number">6.8.4</span> Get fixed effect and random effect coefficients<a href="statistical-models.html#get-fixed-effect-and-random-effect-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="statistical-models.html#cb916-1" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer.slope, <span class="st">&quot;fixef&quot;</span>) <span class="co">#getME(fit.lmer, &quot;beta&quot;)  # fixef(fit.lmer)</span></span>
<span id="cb916-2"><a href="statistical-models.html#cb916-2" aria-hidden="true" tabindex="-1"></a>bhat </span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  17.6351805   0.6601852  -2.1454431</code></pre>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="statistical-models.html#cb918-1" aria-hidden="true" tabindex="-1"></a>uhat <span class="ot">&lt;-</span> <span class="fu">ranef</span>(fit.lmer.slope) </span>
<span id="cb918-2"><a href="statistical-models.html#cb918-2" aria-hidden="true" tabindex="-1"></a>uhat</span></code></pre></div>
<pre><code>## $Subject
##     (Intercept)         age
## M16 -0.96698456 -0.06544230
## M05 -2.15621081  0.04447130
## M02 -1.58143839  0.02194874
## M11  0.38737823 -0.13961777
## M07 -1.40307472  0.03606404
## M08  0.37415109 -0.11799495
## M03 -0.83491587  0.02435289
## M12 -1.82593774  0.11594755
## M13 -5.59182087  0.46400729
## M14  0.51944692 -0.04982259
## M09 -1.07941522  0.11835170
## M15 -1.11909663  0.18322017
## M06  1.03469722  0.02495756
## M04  3.20171821 -0.15492789
## M01  0.96194797  0.14388309
## M10  3.04960613  0.09373458
## F10 -2.31273350 -0.13319695
## F09  0.32324282 -0.16262237
## F06 -0.07316594 -0.12598450
## F01  0.11181130 -0.12268061
## F05  1.43310624 -0.14279903
## F07  0.62044804 -0.03708906
## F02 -0.37057384  0.05450561
## F08  2.38444671 -0.16952522
## F03 -0.01384650  0.08273621
## F04  2.30508388 -0.03978828
## F11  2.62212981  0.05331079
## 
## with conditional variances for &quot;Subject&quot;</code></pre>
</div>
<div id="get-random-effect-covariance-structure-covariance-matrix-expandation-1" class="section level3 hasAnchor" number="6.8.5">
<h3><span class="header-section-number">6.8.5</span> Get random effect covariance structure (covariance matrix expandation)<a href="statistical-models.html#get-random-effect-covariance-structure-covariance-matrix-expandation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><code>notice z matrix structure</code></strong></p>
<!-- # ```{r} -->
<!-- # vc <- VarCorr(fit.lmer.slope)  -->
<!-- # up <- vc[["Subject"]][1]*diag(ncol(Z))[ c(1:(ncol(Z)/2),0), ] -->
<!-- # down <- vc[["Subject"]][4]*diag(ncol(Z))[ c((ncol(Z)/2+1):(ncol(Z)),0), ] -->
<!-- # Lambda_new <- rbind(up,down) -->
<!-- #   -->
<!-- # head(Lambda_new) -->
<!-- # dim(Lambda_new) -->
<!-- # ``` -->
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="statistical-models.html#cb920-1" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(fit.lmer.slope)</span>
<span id="cb920-2"><a href="statistical-models.html#cb920-2" aria-hidden="true" tabindex="-1"></a>Lambda_new <span class="ot">&lt;-</span> <span class="fu">bdiag</span>(<span class="fu">replicate</span>(<span class="fu">length</span>(<span class="fu">levels</span>(Data<span class="sc">$</span>Subject)), vc[[<span class="st">&quot;Subject&quot;</span>]], <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb920-3"><a href="statistical-models.html#cb920-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lambda_new)</span></code></pre></div>
<pre><code>## 6 x 54 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                               
## [1,]  7.822487 -0.48495997  .         .           .         .          . . . .
## [2,] -0.484960  0.05126495  .         .           .         .          . . . .
## [3,]  .         .           7.822487 -0.48495997  .         .          . . . .
## [4,]  .         .          -0.484960  0.05126495  .         .          . . . .
## [5,]  .         .           .         .           7.822487 -0.48495997 . . . .
## [6,]  .         .           .         .          -0.484960  0.05126495 . . . .
##                                                                               
## [1,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [2,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [3,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [4,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [5,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [6,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                   
## [1,] . . . . . . .
## [2,] . . . . . . .
## [3,] . . . . . . .
## [4,] . . . . . . .
## [5,] . . . . . . .
## [6,] . . . . . . .</code></pre>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="statistical-models.html#cb922-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Lambda_new)</span></code></pre></div>
<pre><code>## [1] 54 54</code></pre>
<ul>
<li><p><strong>“theta”: random-effects parameter estimates: these are parameterized as the relative Cholesky factors of each random effect term</strong></p></li>
<li><p><strong>use other cov structure by nlme</strong></p></li>
<li><p><strong>lme4 does not allow to specify it, and it can only fit LMMs with independent residual errors. However, the range of available variance-covariance matrices for the random effects are restricted to diagonal or general matrices. </strong></p></li>
</ul>
<!--   Get  ST    -->
<!-- ```{r} -->
<!-- ST <- getME(fit.lmer, "ST") # $r$  -->
<!-- ``` -->
<!-- https://rdrr.io/cran/lme4/man/getME.html -->
<!-- https://en.wikipedia.org/wiki/Cholesky_decomposition -->
<!--   Get lower   -->
<!-- ```{r} -->
<!-- lower <- getME(fit.lmer, "lower") # $r$  -->
<!-- lower -->
<!-- ``` -->
</div>
<div id="get-residual-variance-and-its-identity-matrix-1" class="section level3 hasAnchor" number="6.8.6">
<h3><span class="header-section-number">6.8.6</span> Get residual variance and its identity matrix<a href="statistical-models.html#get-residual-variance-and-its-identity-matrix-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="statistical-models.html#cb924-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer.slope, <span class="st">&quot;sigma&quot;</span>)<span class="sc">**</span><span class="dv">2</span> </span>
<span id="cb924-2"><a href="statistical-models.html#cb924-2" aria-hidden="true" tabindex="-1"></a>sigma</span></code></pre></div>
<pre><code>## [1] 1.71621</code></pre>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="statistical-models.html#cb926-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sigma<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">nrow</span>(Data)))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">1.71621</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.00000</td>
<td align="right">1.71621</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">1.71621</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">1.71621</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">1.71621</td>
<td align="right">0.00000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">1.71621</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="get-y-covariance-matrix-1" class="section level3 hasAnchor" number="6.8.7">
<h3><span class="header-section-number">6.8.7</span> Get y covariance matrix<a href="statistical-models.html#get-y-covariance-matrix-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="statistical-models.html#cb927-1" aria-hidden="true" tabindex="-1"></a>VM <span class="ot">&lt;-</span> Z<span class="sc">%*%</span>Lambda_new<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">+</span>sigma<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">nrow</span>(Data)) </span>
<span id="cb927-2"><a href="statistical-models.html#cb927-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(VM)</span></code></pre></div>
<pre><code>## 6 x 108 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 108 column names &#39;1&#39;, &#39;2&#39;, &#39;3&#39; ... ]]</code></pre>
<pre><code>##                                                                                
## 1 5.060294 3.194403 3.044722 2.895042 .        .        .        .        . . .
## 2 3.194403 4.965992 3.305161 3.360540 .        .        .        .        . . .
## 3 3.044722 3.305161 5.281810 3.826039 .        .        .        .        . . .
## 4 2.895042 3.360540 3.826039 6.007747 .        .        .        .        . . .
## 5 .        .        .        .        5.060294 3.194403 3.044722 2.895042 . . .
## 6 .        .        .        .        3.194403 4.965992 3.305161 3.360540 . . .
##                                                                                
## 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                                
## 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                        
## 1 . . . . . . . . . . . . . . . . . . .
## 2 . . . . . . . . . . . . . . . . . . .
## 3 . . . . . . . . . . . . . . . . . . .
## 4 . . . . . . . . . . . . . . . . . . .
## 5 . . . . . . . . . . . . . . . . . . .
## 6 . . . . . . . . . . . . . . . . . . .</code></pre>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="statistical-models.html#cb931-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(VM)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="get-fixed-effect-coefficients-covariance-matrix-1" class="section level3 hasAnchor" number="6.8.8">
<h3><span class="header-section-number">6.8.8</span> Get fixed effect coefficients covariance matrix<a href="statistical-models.html#get-fixed-effect-coefficients-covariance-matrix-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="statistical-models.html#cb933-1" aria-hidden="true" tabindex="-1"></a>vcov <span class="ot">&lt;-</span> <span class="fu">vcov</span>(fit.lmer.slope) <span class="co">#fixed cov</span></span>
<span id="cb933-2"><a href="statistical-models.html#cb933-2" aria-hidden="true" tabindex="-1"></a>vcov</span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dpoMatrix&quot;
##             (Intercept)           age     SexFemale
## (Intercept)  0.78540227 -5.292131e-02 -2.337501e-01
## age         -0.05292131  5.076869e-03 -5.668086e-16
## SexFemale   -0.23375009 -5.668086e-16  5.737502e-01</code></pre>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="statistical-models.html#cb935-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computer correlation coefficients </span></span>
<span id="cb935-2"><a href="statistical-models.html#cb935-2" aria-hidden="true" tabindex="-1"></a>vcov<span class="sc">@</span>x[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">prod</span>(<span class="fu">sqrt</span>( <span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer.slope))[<span class="sc">-</span><span class="dv">3</span>] ))</span></code></pre></div>
<pre><code>## [1] -0.8380822</code></pre>
</div>
<div id="get-random-effect-coefficients-covariance-matrix-standard-deviation-1" class="section level3 hasAnchor" number="6.8.9">
<h3><span class="header-section-number">6.8.9</span> Get random effect coefficients covariance matrix (standard deviation)<a href="statistical-models.html#get-random-effect-coefficients-covariance-matrix-standard-deviation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="statistical-models.html#cb937-1" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(fit.lmer.slope) </span>
<span id="cb937-2"><a href="statistical-models.html#cb937-2" aria-hidden="true" tabindex="-1"></a>vc <span class="do">## default print method: standard dev and corr</span></span></code></pre></div>
<pre><code>##  Groups   Name        Std.Dev. Corr  
##  Subject  (Intercept) 2.79687        
##           age         0.22642  -0.766
##  Residual             1.31004</code></pre>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="statistical-models.html#cb939-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(Matrix<span class="sc">::</span><span class="fu">bdiag</span>(vc)) <span class="co">#random effect covariance matrix</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">(Intercept)</th>
<th align="right">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">7.822487</td>
<td align="right">-0.4849600</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.484960</td>
<td align="right">0.0512649</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="statistical-models.html#cb940-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/47307340/extracting-the-i-estimated-variance-covariance-matrix-of-random-effects-and-or</span></span>
<span id="cb940-2"><a href="statistical-models.html#cb940-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_mixed_sect022.htm</span></span></code></pre></div>
</div>
<div id="computer-fixed-effect-coefficients-1" class="section level3 hasAnchor" number="6.8.10">
<h3><span class="header-section-number">6.8.10</span> Computer fixed effect coefficients<a href="statistical-models.html#computer-fixed-effect-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="statistical-models.html#cb941-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb941-2"><a href="statistical-models.html#cb941-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span>y</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">17.635190</td>
</tr>
<tr class="even">
<td align="right">0.660189</td>
</tr>
<tr class="odd">
<td align="right">-2.145444</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="statistical-models.html#cb942-1" aria-hidden="true" tabindex="-1"></a>bhat</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  17.6351805   0.6601852  -2.1454431</code></pre>
</div>
<div id="computer-covariance-of-fixed-efffect-coefficients-1" class="section level3 hasAnchor" number="6.8.11">
<h3><span class="header-section-number">6.8.11</span> Computer covariance of fixed efffect coefficients<a href="statistical-models.html#computer-covariance-of-fixed-efffect-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="statistical-models.html#cb944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.7854023</td>
<td align="right">-0.0529213</td>
<td align="right">-0.2337501</td>
</tr>
<tr class="even">
<td align="right">-0.0529213</td>
<td align="right">0.0050769</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">-0.2337501</td>
<td align="right">0.0000000</td>
<td align="right">0.5737502</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="statistical-models.html#cb945-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb945-2"><a href="statistical-models.html#cb945-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X)))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.8862292</td>
<td align="right">NaN</td>
<td align="right">NaN</td>
</tr>
<tr class="even">
<td align="right">NaN</td>
<td align="right">0.0712522</td>
<td align="right">0.000000</td>
</tr>
<tr class="odd">
<td align="right">NaN</td>
<td align="right">0.0000000</td>
<td align="right">0.757463</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="statistical-models.html#cb946-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the following equals lmm summary</span></span>
<span id="cb946-2"><a href="statistical-models.html#cb946-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(fit.lmer.slope) </span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dpoMatrix&quot;
##             (Intercept)           age     SexFemale
## (Intercept)  0.78540227 -5.292131e-02 -2.337501e-01
## age         -0.05292131  5.076869e-03 -5.668086e-16
## SexFemale   -0.23375009 -5.668086e-16  5.737502e-01</code></pre>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="statistical-models.html#cb948-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">vcov</span>(fit.lmer.slope))</span></code></pre></div>
<pre><code>## 3 x 3 Matrix of class &quot;dsyMatrix&quot;
##             (Intercept)        age SexFemale
## (Intercept)   0.8862292        NaN       NaN
## age                 NaN 0.07125215       NaN
## SexFemale           NaN        NaN  0.757463</code></pre>
<p><strong>default is compound symmetry</strong></p>
</div>
<div id="computer-random-effect-coefficients-1" class="section level3 hasAnchor" number="6.8.12">
<h3><span class="header-section-number">6.8.12</span> Computer random effect coefficients<a href="statistical-models.html#computer-random-effect-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="statistical-models.html#cb950-1" aria-hidden="true" tabindex="-1"></a>comput_uhat <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(Lambda_new))<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(VM))<span class="sc">%*%</span>(y<span class="sc">-</span><span class="fu">as.matrix</span>(X)<span class="sc">%*%</span>(bhat))</span>
<span id="cb950-2"><a href="statistical-models.html#cb950-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>((comput_uhat<span class="sc">@</span>x),(uhat[[<span class="st">&quot;Subject&quot;</span>]]))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">(<a href="mailto:comput_uhat@x" class="email">comput_uhat@x</a>)</th>
<th align="right">(Intercept)</th>
<th align="right">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.9669845</td>
<td align="right">-0.9669846</td>
<td align="right">-0.0654423</td>
</tr>
<tr class="even">
<td align="right">-0.0654423</td>
<td align="right">-2.1562108</td>
<td align="right">0.0444713</td>
</tr>
<tr class="odd">
<td align="right">-2.1562108</td>
<td align="right">-1.5814384</td>
<td align="right">0.0219487</td>
</tr>
<tr class="even">
<td align="right">0.0444713</td>
<td align="right">0.3873782</td>
<td align="right">-0.1396178</td>
</tr>
<tr class="odd">
<td align="right">-1.5814383</td>
<td align="right">-1.4030747</td>
<td align="right">0.0360640</td>
</tr>
<tr class="even">
<td align="right">0.0219487</td>
<td align="right">0.3741511</td>
<td align="right">-0.1179949</td>
</tr>
<tr class="odd">
<td align="right">0.3873782</td>
<td align="right">-0.8349159</td>
<td align="right">0.0243529</td>
</tr>
<tr class="even">
<td align="right">-0.1396178</td>
<td align="right">-1.8259377</td>
<td align="right">0.1159476</td>
</tr>
<tr class="odd">
<td align="right">-1.4030747</td>
<td align="right">-5.5918209</td>
<td align="right">0.4640073</td>
</tr>
<tr class="even">
<td align="right">0.0360640</td>
<td align="right">0.5194469</td>
<td align="right">-0.0498226</td>
</tr>
<tr class="odd">
<td align="right">0.3741511</td>
<td align="right">-1.0794152</td>
<td align="right">0.1183517</td>
</tr>
<tr class="even">
<td align="right">-0.1179950</td>
<td align="right">-1.1190966</td>
<td align="right">0.1832202</td>
</tr>
<tr class="odd">
<td align="right">-0.8349158</td>
<td align="right">1.0346972</td>
<td align="right">0.0249576</td>
</tr>
<tr class="even">
<td align="right">0.0243529</td>
<td align="right">3.2017182</td>
<td align="right">-0.1549279</td>
</tr>
<tr class="odd">
<td align="right">-1.8259377</td>
<td align="right">0.9619480</td>
<td align="right">0.1438831</td>
</tr>
<tr class="even">
<td align="right">0.1159476</td>
<td align="right">3.0496061</td>
<td align="right">0.0937346</td>
</tr>
<tr class="odd">
<td align="right">-5.5918208</td>
<td align="right">-2.3127335</td>
<td align="right">-0.1331970</td>
</tr>
<tr class="even">
<td align="right">0.4640073</td>
<td align="right">0.3232428</td>
<td align="right">-0.1626224</td>
</tr>
<tr class="odd">
<td align="right">0.5194469</td>
<td align="right">-0.0731659</td>
<td align="right">-0.1259845</td>
</tr>
<tr class="even">
<td align="right">-0.0498226</td>
<td align="right">0.1118113</td>
<td align="right">-0.1226806</td>
</tr>
<tr class="odd">
<td align="right">-1.0794152</td>
<td align="right">1.4331062</td>
<td align="right">-0.1427990</td>
</tr>
<tr class="even">
<td align="right">0.1183517</td>
<td align="right">0.6204480</td>
<td align="right">-0.0370891</td>
</tr>
<tr class="odd">
<td align="right">-1.1190966</td>
<td align="right">-0.3705738</td>
<td align="right">0.0545056</td>
</tr>
<tr class="even">
<td align="right">0.1832202</td>
<td align="right">2.3844467</td>
<td align="right">-0.1695252</td>
</tr>
<tr class="odd">
<td align="right">1.0346972</td>
<td align="right">-0.0138465</td>
<td align="right">0.0827362</td>
</tr>
<tr class="even">
<td align="right">0.0249576</td>
<td align="right">2.3050839</td>
<td align="right">-0.0397883</td>
</tr>
<tr class="odd">
<td align="right">3.2017181</td>
<td align="right">2.6221298</td>
<td align="right">0.0533108</td>
</tr>
<tr class="even">
<td align="right">-0.1549279</td>
<td align="right">-0.9669846</td>
<td align="right">-0.0654423</td>
</tr>
<tr class="odd">
<td align="right">0.9619480</td>
<td align="right">-2.1562108</td>
<td align="right">0.0444713</td>
</tr>
<tr class="even">
<td align="right">0.1438831</td>
<td align="right">-1.5814384</td>
<td align="right">0.0219487</td>
</tr>
<tr class="odd">
<td align="right">3.0496061</td>
<td align="right">0.3873782</td>
<td align="right">-0.1396178</td>
</tr>
<tr class="even">
<td align="right">0.0937346</td>
<td align="right">-1.4030747</td>
<td align="right">0.0360640</td>
</tr>
<tr class="odd">
<td align="right">-2.3127334</td>
<td align="right">0.3741511</td>
<td align="right">-0.1179949</td>
</tr>
<tr class="even">
<td align="right">-0.1331970</td>
<td align="right">-0.8349159</td>
<td align="right">0.0243529</td>
</tr>
<tr class="odd">
<td align="right">0.3232428</td>
<td align="right">-1.8259377</td>
<td align="right">0.1159476</td>
</tr>
<tr class="even">
<td align="right">-0.1626224</td>
<td align="right">-5.5918209</td>
<td align="right">0.4640073</td>
</tr>
<tr class="odd">
<td align="right">-0.0731659</td>
<td align="right">0.5194469</td>
<td align="right">-0.0498226</td>
</tr>
<tr class="even">
<td align="right">-0.1259845</td>
<td align="right">-1.0794152</td>
<td align="right">0.1183517</td>
</tr>
<tr class="odd">
<td align="right">0.1118113</td>
<td align="right">-1.1190966</td>
<td align="right">0.1832202</td>
</tr>
<tr class="even">
<td align="right">-0.1226806</td>
<td align="right">1.0346972</td>
<td align="right">0.0249576</td>
</tr>
<tr class="odd">
<td align="right">1.4331062</td>
<td align="right">3.2017182</td>
<td align="right">-0.1549279</td>
</tr>
<tr class="even">
<td align="right">-0.1427990</td>
<td align="right">0.9619480</td>
<td align="right">0.1438831</td>
</tr>
<tr class="odd">
<td align="right">0.6204480</td>
<td align="right">3.0496061</td>
<td align="right">0.0937346</td>
</tr>
<tr class="even">
<td align="right">-0.0370891</td>
<td align="right">-2.3127335</td>
<td align="right">-0.1331970</td>
</tr>
<tr class="odd">
<td align="right">-0.3705738</td>
<td align="right">0.3232428</td>
<td align="right">-0.1626224</td>
</tr>
<tr class="even">
<td align="right">0.0545056</td>
<td align="right">-0.0731659</td>
<td align="right">-0.1259845</td>
</tr>
<tr class="odd">
<td align="right">2.3844467</td>
<td align="right">0.1118113</td>
<td align="right">-0.1226806</td>
</tr>
<tr class="even">
<td align="right">-0.1695252</td>
<td align="right">1.4331062</td>
<td align="right">-0.1427990</td>
</tr>
<tr class="odd">
<td align="right">-0.0138465</td>
<td align="right">0.6204480</td>
<td align="right">-0.0370891</td>
</tr>
<tr class="even">
<td align="right">0.0827362</td>
<td align="right">-0.3705738</td>
<td align="right">0.0545056</td>
</tr>
<tr class="odd">
<td align="right">2.3050838</td>
<td align="right">2.3844467</td>
<td align="right">-0.1695252</td>
</tr>
<tr class="even">
<td align="right">-0.0397883</td>
<td align="right">-0.0138465</td>
<td align="right">0.0827362</td>
</tr>
<tr class="odd">
<td align="right">2.6221297</td>
<td align="right">2.3050839</td>
<td align="right">-0.0397883</td>
</tr>
<tr class="even">
<td align="right">0.0533108</td>
<td align="right">2.6221298</td>
<td align="right">0.0533108</td>
</tr>
</tbody>
</table>
<ul>
<li>covariance matrix of random effect coefficients</li>
</ul>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="statistical-models.html#cb951-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Lambda_new)</span></code></pre></div>
<pre><code>## 6 x 54 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                               
## [1,]  7.822487 -0.48495997  .         .           .         .          . . . .
## [2,] -0.484960  0.05126495  .         .           .         .          . . . .
## [3,]  .         .           7.822487 -0.48495997  .         .          . . . .
## [4,]  .         .          -0.484960  0.05126495  .         .          . . . .
## [5,]  .         .           .         .           7.822487 -0.48495997 . . . .
## [6,]  .         .           .         .          -0.484960  0.05126495 . . . .
##                                                                               
## [1,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [2,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [3,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [4,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [5,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## [6,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                   
## [1,] . . . . . . .
## [2,] . . . . . . .
## [3,] . . . . . . .
## [4,] . . . . . . .
## [5,] . . . . . . .
## [6,] . . . . . . .</code></pre>
</div>
<div id="computer-predicted-values-1" class="section level3 hasAnchor" number="6.8.13">
<h3><span class="header-section-number">6.8.13</span> Computer predicted values<a href="statistical-models.html#computer-predicted-values-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="statistical-models.html#cb953-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> X<span class="sc">%*%</span>(bhat)<span class="sc">+</span>Z<span class="sc">%*%</span>comput_uhat</span>
<span id="cb953-2"><a href="statistical-models.html#cb953-2" aria-hidden="true" tabindex="-1"></a><span class="co"># comput_uhat= uhat</span></span>
<span id="cb953-3"><a href="statistical-models.html#cb953-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(yhat)</span></code></pre></div>
<pre><code>## 6 x 1 Matrix of class &quot;dgeMatrix&quot;
##       [,1]
## 1 25.02967
## 2 26.63781
## 3 28.24595
## 4 29.85408
## 5 21.51081
## 6 22.87508</code></pre>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="statistical-models.html#cb955-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(fit.lmer.slope))</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 25.02967 26.63781 28.24595 29.85408 21.51081 22.87508</code></pre>
</div>
<div id="using-lmm-with-two-grouping-factors" class="section level3 hasAnchor" number="6.8.14">
<h3><span class="header-section-number">6.8.14</span> Using lmm with two grouping factors<a href="statistical-models.html#using-lmm-with-two-grouping-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="statistical-models.html#cb957-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) </span>
<span id="cb957-2"><a href="statistical-models.html#cb957-2" aria-hidden="true" tabindex="-1"></a>fit.lmer.slope2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  <span class="sc">+</span>(<span class="dv">1</span><span class="sc">+</span> age <span class="sc">|</span> Subject)<span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> age), <span class="at">data =</span> Data) </span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="statistical-models.html#cb959-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.slope2)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: distance ~ age + Sex + (1 + age | Subject) + (1 | age)
##    Data: Data
## 
## REML criterion at convergence: 435.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0821 -0.4568  0.0154  0.4471  3.8942 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  Subject  (Intercept) 7.81589  2.7957        
##           age         0.05122  0.2263   -0.77
##  age      (Intercept) 0.00000  0.0000        
##  Residual             1.71643  1.3101        
## Number of obs: 108, groups:  Subject, 27; age, 4
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 17.63511    0.88612  19.902
## age          0.66019    0.07124   9.267
## SexFemale   -2.14527    0.75745  -2.832
## 
## Correlation of Fixed Effects:
##           (Intr) age   
## age       -0.838       
## SexFemale -0.348  0.000
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
</div>
<div id="get-z2" class="section level3 hasAnchor" number="6.8.15">
<h3><span class="header-section-number">6.8.15</span> Get z2<a href="statistical-models.html#get-z2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>58= 54+4 ages</code></p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="statistical-models.html#cb961-1" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer.slope2, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb961-2"><a href="statistical-models.html#cb961-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Z2,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 10 x 58 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 58 column names &#39;M16&#39;, &#39;M16&#39;, &#39;M05&#39; ... ]]</code></pre>
<pre><code>##                                                                                
## 1  . . . . .  . . . . . . . .  . . . . . . . . . . . . . . . 1  8 . . . . . . .
## 2  . . . . .  . . . . . . . .  . . . . . . . . . . . . . . . 1 10 . . . . . . .
## 3  . . . . .  . . . . . . . .  . . . . . . . . . . . . . . . 1 12 . . . . . . .
## 4  . . . . .  . . . . . . . .  . . . . . . . . . . . . . . . 1 14 . . . . . . .
## 5  . . . . 1  8 . . . . . . .  . . . . . . . . . . . . . . . .  . . . . . . . .
## 6  . . . . 1 10 . . . . . . .  . . . . . . . . . . . . . . . .  . . . . . . . .
## 7  . . . . 1 12 . . . . . . .  . . . . . . . . . . . . . . . .  . . . . . . . .
## 8  . . . . 1 14 . . . . . . .  . . . . . . . . . . . . . . . .  . . . . . . . .
## 9  . . . . .  . . . . . . . 1  8 . . . . . . . . . . . . . . .  . . . . . . . .
## 10 . . . . .  . . . . . . . 1 10 . . . . . . . . . . . . . . .  . . . . . . . .
##                                             
## 1  . . . . . . . . . . . . . . . . . 1 . . .
## 2  . . . . . . . . . . . . . . . . . . 1 . .
## 3  . . . . . . . . . . . . . . . . . . . 1 .
## 4  . . . . . . . . . . . . . . . . . . . . 1
## 5  . . . . . . . . . . . . . . . . . 1 . . .
## 6  . . . . . . . . . . . . . . . . . . 1 . .
## 7  . . . . . . . . . . . . . . . . . . . 1 .
## 8  . . . . . . . . . . . . . . . . . . . . 1
## 9  . . . . . . . . . . . . . . . . . 1 . . .
## 10 . . . . . . . . . . . . . . . . . . 1 . .</code></pre>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="statistical-models.html#cb965-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Z2)</span></code></pre></div>
<pre><code>## [1] 108  58</code></pre>
</div>
<div id="using-lmm-with-nested-or-crossed-random-effects" class="section level3 hasAnchor" number="6.8.16">
<h3><span class="header-section-number">6.8.16</span> Using lmm with nested or crossed random effects<a href="statistical-models.html#using-lmm-with-nested-or-crossed-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="statistical-models.html#cb967-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) </span>
<span id="cb967-2"><a href="statistical-models.html#cb967-2" aria-hidden="true" tabindex="-1"></a>fit.lmer.slope3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  <span class="sc">+</span>(<span class="dv">1</span> <span class="sc">|</span> Sex<span class="sc">/</span>Subject), <span class="at">data =</span> Data) </span>
<span id="cb967-3"><a href="statistical-models.html#cb967-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.slope3)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: distance ~ age + Sex + (1 | Sex/Subject)
##    Data: Data
## 
## REML criterion at convergence: 437.5
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.7489 -0.5503 -0.0252  0.4534  3.6575 
## 
## Random effects:
##  Groups      Name        Variance Std.Dev.
##  Subject:Sex (Intercept) 3.2668   1.8074  
##  Sex         (Intercept) 0.9392   0.9691  
##  Residual                2.0495   1.4316  
## Number of obs: 108, groups:  Subject:Sex, 27; Sex, 2
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept) 17.70671    1.27852   13.85
## age          0.66019    0.06161   10.72
## SexFemale   -2.32102    1.56785   -1.48
## 
## Correlation of Fixed Effects:
##           (Intr) age   
## age       -0.530       
## SexFemale -0.586  0.000
## optimizer (nloptwrap) convergence code: 0 (OK)
## Model is nearly unidentifiable: large eigenvalue ratio
##  - Rescale variables?</code></pre>
</div>
<div id="get-z3" class="section level3 hasAnchor" number="6.8.17">
<h3><span class="header-section-number">6.8.17</span> Get z3<a href="statistical-models.html#get-z3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>29= 27+2 ages</code></p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="statistical-models.html#cb969-1" aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer.slope3, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb969-2"><a href="statistical-models.html#cb969-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Z3,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 10 x 29 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##   [[ suppressing 29 column names &#39;M16:Male&#39;, &#39;M05:Male&#39;, &#39;M02:Male&#39; ... ]]</code></pre>
<pre><code>##                                                             
## 1  . . . . . . . . . . . . . . 1 . . . . . . . . . . . . 1 .
## 2  . . . . . . . . . . . . . . 1 . . . . . . . . . . . . 1 .
## 3  . . . . . . . . . . . . . . 1 . . . . . . . . . . . . 1 .
## 4  . . . . . . . . . . . . . . 1 . . . . . . . . . . . . 1 .
## 5  . . 1 . . . . . . . . . . . . . . . . . . . . . . . . 1 .
## 6  . . 1 . . . . . . . . . . . . . . . . . . . . . . . . 1 .
## 7  . . 1 . . . . . . . . . . . . . . . . . . . . . . . . 1 .
## 8  . . 1 . . . . . . . . . . . . . . . . . . . . . . . . 1 .
## 9  . . . . . . 1 . . . . . . . . . . . . . . . . . . . . 1 .
## 10 . . . . . . 1 . . . . . . . . . . . . . . . . . . . . 1 .</code></pre>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="statistical-models.html#cb973-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Z3)</span></code></pre></div>
<pre><code>## [1] 108  29</code></pre>
<p><code>Remark</code></p>
<p>nested random effects occur when one factor (grouping variable) appears only within a particular level of another factor (grouping variable).<br />
lmer
(1|group1/group2)</p>
<p>Crossed random effects are simply: not nested. individual observations are nested separately within the two or more factors.<br />
lmer
(1|group1) + (1|group2)</p>

</div>
</div>
<div id="linear-mixed-model-covariance-decomposition-nlme" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Linear mixed model covariance decomposition (nlme)<a href="statistical-models.html#linear-mixed-model-covariance-decomposition-nlme" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-data-3" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Load data<a href="statistical-models.html#load-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="statistical-models.html#cb975-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Orthodont, <span class="at">package=</span><span class="st">&quot;nlme&quot;</span>)</span>
<span id="cb975-2"><a href="statistical-models.html#cb975-2" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> Orthodont</span></code></pre></div>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="statistical-models.html#cb976-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb976-2"><a href="statistical-models.html#cb976-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> age,  <span class="at">color =</span> Sex)) <span class="sc">+</span></span>
<span id="cb976-3"><a href="statistical-models.html#cb976-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,<span class="at">se=</span>F) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-463-1.png" width="672" /></p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="statistical-models.html#cb978-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb978-2"><a href="statistical-models.html#cb978-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> age, <span class="at">fill =</span> Subject, <span class="at">color =</span> Sex)) <span class="sc">+</span></span>
<span id="cb978-3"><a href="statistical-models.html#cb978-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,<span class="at">se=</span>F) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-464-1.png" width="672" /></p>
</div>
<div id="using-lme-nlme" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Using lme (nlme)<a href="statistical-models.html#using-lme-nlme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="statistical-models.html#cb980-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmList</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     collapse</code></pre>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="statistical-models.html#cb984-1" aria-hidden="true" tabindex="-1"></a>fit.lmer2 <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span>   <span class="sc">|</span> Subject, <span class="at">data =</span> Data) </span>
<span id="cb984-2"><a href="statistical-models.html#cb984-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer2)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC      BIC    logLik
##   447.5125 460.7823 -218.7563
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.807425 1.431592
## 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.706713 0.8339225 80 21.233044  0.0000
## age          0.660185 0.0616059 80 10.716263  0.0000
## SexFemale   -2.321023 0.7614168 25 -3.048294  0.0054
##  Correlation: 
##           (Intr) age   
## age       -0.813       
## SexFemale -0.372  0.000
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.74889609 -0.55034466 -0.02516628  0.45341781  3.65746539 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="statistical-models.html#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb986-2"><a href="statistical-models.html#cb986-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lme4</span></span>
<span id="cb986-3"><a href="statistical-models.html#cb986-3" aria-hidden="true" tabindex="-1"></a>fit.lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  <span class="sc">+</span>(<span class="dv">1</span> <span class="sc">|</span> Subject), <span class="at">data =</span> Data) </span>
<span id="cb986-4"><a href="statistical-models.html#cb986-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compound symmetry</span></span></code></pre></div>
<ul>
<li>t test</li>
</ul>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="statistical-models.html#cb987-1" aria-hidden="true" tabindex="-1"></a>tstat <span class="ot">&lt;-</span> <span class="fu">fixef</span>(fit.lmer2)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer2)))</span>
<span id="cb987-2"><a href="statistical-models.html#cb987-2" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(tstat), <span class="at">df =</span> fit.lmer2<span class="sc">$</span>fixDF<span class="sc">$</span>X)</span>
<span id="cb987-3"><a href="statistical-models.html#cb987-3" aria-hidden="true" tabindex="-1"></a>Tresult <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> tstat, <span class="at">p =</span> <span class="fu">round</span>(pval, <span class="dv">4</span>))</span>
<span id="cb987-4"><a href="statistical-models.html#cb987-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Tresult)</span></code></pre></div>
<pre><code>##                     t      p
## (Intercept) 21.233044 0.0000
## age         10.716263 0.0000
## SexFemale   -3.048294 0.0054</code></pre>
<ul>
<li>F test</li>
</ul>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="statistical-models.html#cb989-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.lmer2 ) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">numDF</th>
<th align="right">denDF</th>
<th align="right">F-value</th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1</td>
<td align="right">80</td>
<td align="right">4123.155691</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">1</td>
<td align="right">80</td>
<td align="right">114.838287</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">Sex</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">9.292099</td>
<td align="right">0.0053751</td>
</tr>
</tbody>
</table>
<ul>
<li>restricted model test</li>
</ul>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="statistical-models.html#cb990-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.lmer2, <span class="at">L =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">numDF</th>
<th align="right">denDF</th>
<th align="right">F-value</th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">80</td>
<td align="right">114.8383</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<ul>
<li>likelihood test</li>
</ul>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="statistical-models.html#cb991-1" aria-hidden="true" tabindex="-1"></a>fit.lmer2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span>   Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span>   <span class="sc">|</span> Subject, <span class="at">data =</span> Data) </span>
<span id="cb991-2"><a href="statistical-models.html#cb991-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit.lmer2, fit.lmer2<span class="fl">.2</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="54%" />
<col width="3%" />
<col width="1%" />
<col width="5%" />
<col width="5%" />
<col width="6%" />
<col width="4%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">call</th>
<th align="right">Model</th>
<th align="right">df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="left">Test</th>
<th align="right">L.Ratio</th>
<th align="right">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fit.lmer2</td>
<td align="left">lme.formula(fixed = distance ~ age + Sex, data = Data, random = ~1 | Subject)</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">447.5125</td>
<td align="right">460.7823</td>
<td align="right">-218.7563</td>
<td align="left"></td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">fit.lmer2.2</td>
<td align="left">lme.formula(fixed = distance ~ Sex, data = Data, random = ~1 | Subject)</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">513.8718</td>
<td align="right">524.5255</td>
<td align="right">-252.9359</td>
<td align="left">1 vs 2</td>
<td align="right">68.35926</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><code>And now by hand</code></p>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="statistical-models.html#cb992-1" aria-hidden="true" tabindex="-1"></a>logLik  <span class="ot">&lt;-</span> <span class="fu">logLik</span>(fit.lmer2)</span>
<span id="cb992-2"><a href="statistical-models.html#cb992-2" aria-hidden="true" tabindex="-1"></a>logLik0 <span class="ot">&lt;-</span> <span class="fu">logLik</span>(fit.lmer2<span class="fl">.2</span>)</span>
<span id="cb992-3"><a href="statistical-models.html#cb992-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb992-4"><a href="statistical-models.html#cb992-4" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (logLik <span class="sc">-</span> logLik0)</span>
<span id="cb992-5"><a href="statistical-models.html#cb992-5" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(LR, <span class="at">df =</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb992-6"><a href="statistical-models.html#cb992-6" aria-hidden="true" tabindex="-1"></a>LRresult <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">LR =</span> LR, <span class="at">p =</span> <span class="fu">round</span>(pval, <span class="dv">4</span>), <span class="at">row.names =</span> <span class="st">&quot;age&quot;</span>)</span>
<span id="cb992-7"><a href="statistical-models.html#cb992-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LRresult)</span></code></pre></div>
<pre><code>##           LR p
## age 68.35926 0</code></pre>
<!-- https://www2.karlin.mff.cuni.cz/~komarek/vyuka/2020_21/nmst432/lmm_lme.html -->
</div>
<div id="model-diagnosing" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> Model diagnosing<a href="statistical-models.html#model-diagnosing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="statistical-models.html#cb994-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb994-2"><a href="statistical-models.html#cb994-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.lme</span>(fit.lmer2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
</div>
<div id="get-x-y-z-matrixs-using-lme4" class="section level3 hasAnchor" number="6.9.4">
<h3><span class="header-section-number">6.9.4</span> Get x, y, z matrixs (using lme4)<a href="statistical-models.html#get-x-y-z-matrixs-using-lme4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="statistical-models.html#cb995-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span>(<span class="fu">getME</span>(fit.lmer, <span class="st">&quot;X&quot;</span>))</span>
<span id="cb995-2"><a href="statistical-models.html#cb995-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">getME</span>(fit.lmer, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb995-3"><a href="statistical-models.html#cb995-3" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">getME</span>(fit.lmer, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb995-4"><a href="statistical-models.html#cb995-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb995-5"><a href="statistical-models.html#cb995-5" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Subject<span class="dv">-1</span>,<span class="at">data=</span>Data)</span></code></pre></div>
<p><code>check z matrix</code></p>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="statistical-models.html#cb996-1" aria-hidden="true" tabindex="-1"></a>dummyz<span class="ot">&lt;-</span> <span class="fu">as.matrix</span> (Z)<span class="sc">==</span>Z2</span>
<span id="cb996-2"><a href="statistical-models.html#cb996-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dummyz)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2916</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="statistical-models.html#cb997-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Z)</span></code></pre></div>
<pre><code>## [1] 108  27</code></pre>
<p><code>check y and X matrixs</code></p>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="statistical-models.html#cb999-1" aria-hidden="true" tabindex="-1"></a>dummyx<span class="ot">&lt;-</span> Data[,<span class="fu">c</span>(<span class="dv">2</span>)]<span class="sc">==</span>X[,<span class="dv">2</span>]</span>
<span id="cb999-2"><a href="statistical-models.html#cb999-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dummyx)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">TRUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">108</td>
</tr>
</tbody>
</table>
</div>
<div id="fixed-effect-coefficient" class="section level3 hasAnchor" number="6.9.5">
<h3><span class="header-section-number">6.9.5</span> Fixed effect coefficient<a href="statistical-models.html#fixed-effect-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="statistical-models.html#cb1000-1" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">&lt;-</span> fit.lmer2<span class="sc">$</span>coef<span class="sc">$</span>fixed</span>
<span id="cb1000-2"><a href="statistical-models.html#cb1000-2" aria-hidden="true" tabindex="-1"></a>bhat</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  17.7067130   0.6601852  -2.3210227</code></pre>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="statistical-models.html#cb1002-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fixef()</span></span></code></pre></div>
<ul>
<li>fixed effect coefficient confidence intervals</li>
</ul>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="statistical-models.html#cb1003-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intervals</span>(fit.lmer2)</span></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Fixed effects:
##                  lower       est.      upper
## (Intercept) 16.0471544 17.7067130 19.3662716
## age          0.5375855  0.6601852  0.7827849
## SexFemale   -3.8891901 -2.3210227 -0.7528554
## 
##  Random Effects:
##   Level: Subject 
##                   lower     est.    upper
## sd((Intercept)) 1.31035 1.807425 2.493061
## 
##  Within-group standard error:
##    lower     est.    upper 
## 1.226102 1.431592 1.671522</code></pre>
<div id="plot-fixed-effect-coefficients-and-theri-ci" class="section level4 hasAnchor" number="6.9.5.1">
<h4><span class="header-section-number">6.9.5.1</span> Plot fixed effect coefficients and theri ci<a href="statistical-models.html#plot-fixed-effect-coefficients-and-theri-ci" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="statistical-models.html#cb1005-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Est =</span> <span class="fu">intervals</span>(fit.lmer2)[[<span class="st">&quot;fixed&quot;</span>]][,<span class="dv">2</span>], <span class="at">LL =</span> <span class="fu">intervals</span>(fit.lmer2)[[<span class="st">&quot;fixed&quot;</span>]][,<span class="dv">1</span>], <span class="at">UL=</span></span>
<span id="cb1005-2"><a href="statistical-models.html#cb1005-2" aria-hidden="true" tabindex="-1"></a><span class="fu">intervals</span>(fit.lmer2)[[<span class="st">&quot;fixed&quot;</span>]][,<span class="dv">3</span>])</span>
<span id="cb1005-3"><a href="statistical-models.html#cb1005-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting the fixed effect estimates and manually calculating the 95% confidence limits</span></span>
<span id="cb1005-4"><a href="statistical-models.html#cb1005-4" aria-hidden="true" tabindex="-1"></a><span class="co">#qnorm extracts the standard normal critical value for 1-alpha/2= 1-0.05/2=0.975</span></span>
<span id="cb1005-5"><a href="statistical-models.html#cb1005-5" aria-hidden="true" tabindex="-1"></a>Odds<span class="ot">=</span> (tab)</span>
<span id="cb1005-6"><a href="statistical-models.html#cb1005-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Odds,<span class="dv">4</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Est</th>
<th align="right">LL</th>
<th align="right">UL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">17.7067</td>
<td align="right">16.0472</td>
<td align="right">19.3663</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.6602</td>
<td align="right">0.5376</td>
<td align="right">0.7828</td>
</tr>
<tr class="odd">
<td align="left">SexFemale</td>
<td align="right">-2.3210</td>
<td align="right">-3.8892</td>
<td align="right">-0.7529</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1006-1"><a href="statistical-models.html#cb1006-1" aria-hidden="true" tabindex="-1"></a>Odds<span class="ot">=</span><span class="fu">as.data.frame</span>(Odds)</span>
<span id="cb1006-2"><a href="statistical-models.html#cb1006-2" aria-hidden="true" tabindex="-1"></a>Odds<span class="sc">$</span>Label<span class="ot">=</span><span class="fu">rownames</span>(Odds)</span>
<span id="cb1006-3"><a href="statistical-models.html#cb1006-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1006-4"><a href="statistical-models.html#cb1006-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Odds[<span class="sc">-</span><span class="dv">1</span>,],<span class="fu">aes</span>(<span class="at">x=</span>Est,<span class="at">y=</span>Label))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1006-5"><a href="statistical-models.html#cb1006-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmax =</span> UL, <span class="at">xmin =</span> LL))<span class="sc">+</span></span>
<span id="cb1006-6"><a href="statistical-models.html#cb1006-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1006-7"><a href="statistical-models.html#cb1006-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>,<span class="at">size=</span><span class="fl">1.2</span>,<span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb1006-8"><a href="statistical-models.html#cb1006-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb1006-9"><a href="statistical-models.html#cb1006-9" aria-hidden="true" tabindex="-1"></a><span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Beta coefficients&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-477-1.png" width="672" /></p>
<p><code>And now by hand</code></p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="statistical-models.html#cb1007-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tquants <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> fit.lmer2<span class="sc">$</span>fixDF<span class="sc">$</span>X))</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##    1.990063    1.990063    2.059539</code></pre>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="statistical-models.html#cb1009-1" aria-hidden="true" tabindex="-1"></a>Low <span class="ot">&lt;-</span> <span class="fu">fixef</span>(fit.lmer2) <span class="sc">-</span> tquants <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer2)))</span>
<span id="cb1009-2"><a href="statistical-models.html#cb1009-2" aria-hidden="true" tabindex="-1"></a>Upp <span class="ot">&lt;-</span> <span class="fu">fixef</span>(fit.lmer2) <span class="sc">+</span> tquants <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer2)))</span>
<span id="cb1009-3"><a href="statistical-models.html#cb1009-3" aria-hidden="true" tabindex="-1"></a>EstInt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Lower =</span> Low, <span class="at">Estimate =</span> <span class="fu">fixef</span>(fit.lmer2), <span class="at">Upper =</span> Upp)</span>
<span id="cb1009-4"><a href="statistical-models.html#cb1009-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(EstInt)</span></code></pre></div>
<pre><code>##                  Lower   Estimate      Upper
## (Intercept) 16.0471544 17.7067130 19.3662716
## age          0.5375855  0.6601852  0.7827849
## SexFemale   -3.8891901 -2.3210227 -0.7528554</code></pre>
</div>
</div>
<div id="random-effect-coefficient" class="section level3 hasAnchor" number="6.9.6">
<h3><span class="header-section-number">6.9.6</span> Random effect coefficient<a href="statistical-models.html#random-effect-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1011-1"><a href="statistical-models.html#cb1011-1" aria-hidden="true" tabindex="-1"></a>fit.lmer2<span class="sc">$</span>coef<span class="sc">$</span>random</span></code></pre></div>
<pre><code>## $Subject
##     (Intercept)
## M16 -1.70183357
## M05 -1.70183357
## M02 -1.37767479
## M11 -1.16156894
## M07 -1.05351602
## M08 -0.94546309
## M03 -0.62130432
## M12 -0.62130432
## M13 -0.62130432
## M14 -0.08103969
## M09  0.13506616
## M15  0.78338371
## M06  1.21559540
## M04  1.43170125
## M01  2.40417758
## M10  3.91691853
## F10 -3.58539251
## F09 -1.31628108
## F06 -1.31628108
## F01 -1.10017523
## F05 -0.01964599
## F07  0.30451279
## F02  0.30451279
## F08  0.62867156
## F03  0.95283034
## F04  1.92530666
## F11  3.22194176</code></pre>
</div>
<div id="fixed-effect-coefficients-covariance" class="section level3 hasAnchor" number="6.9.7">
<h3><span class="header-section-number">6.9.7</span> Fixed effect coefficients covariance<a href="statistical-models.html#fixed-effect-coefficients-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1013-1"><a href="statistical-models.html#cb1013-1" aria-hidden="true" tabindex="-1"></a>fit.lmer2<span class="sc">$</span>varFix</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">(Intercept)</th>
<th align="right">age</th>
<th align="right">SexFemale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.6954267</td>
<td align="right">-0.0417482</td>
<td align="right">-0.2361967</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">-0.0417482</td>
<td align="right">0.0037953</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">SexFemale</td>
<td align="right">-0.2361967</td>
<td align="right">0.0000000</td>
<td align="right">0.5797556</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1014-1"><a href="statistical-models.html#cb1014-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vcov(fit.lmer2)</span></span>
<span id="cb1014-2"><a href="statistical-models.html#cb1014-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lmer2)))</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##  0.83392247  0.06160592  0.76141685</code></pre>
<p><code>fixed effect coefficients correlation</code></p>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="statistical-models.html#cb1016-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.04174818</span><span class="sc">/</span><span class="fu">prod</span>(<span class="fu">sqrt</span>( <span class="fu">diag</span>(fit.lmer2<span class="sc">$</span>varFix)[<span class="sc">-</span><span class="dv">3</span>] ))</span></code></pre></div>
<pre><code>## [1] -0.8126236</code></pre>
</div>
<div id="random-effect-covariance-and-correlation" class="section level3 hasAnchor" number="6.9.8">
<h3><span class="header-section-number">6.9.8</span> Random effect covariance and correlation<a href="statistical-models.html#random-effect-covariance-and-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="statistical-models.html#cb1018-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdMatrix</span>(fit.lmer2<span class="sc">$</span>modelStruct<span class="sc">$</span>reStruct[[<span class="dv">1</span>]])<span class="sc">*</span>fit.lmer2<span class="sc">$</span>sigma<span class="sc">**</span><span class="dv">2</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">3.266784</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="statistical-models.html#cb1019-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getVarCov</span>(fit.lmer2)  <span class="co">#using default </span></span></code></pre></div>
<pre><code>## Random effects variance covariance matrix
##             (Intercept)
## (Intercept)      3.2668
##   Standard Deviations: 1.8074</code></pre>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="statistical-models.html#cb1021-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getVarCov</span>(fit.lmer2, <span class="at">individual =</span> <span class="st">&quot;F01&quot;</span>, <span class="at">type =</span> <span class="st">&quot;marginal&quot;</span>)</span></code></pre></div>
<pre><code>## Subject F01 
## Marginal variance covariance matrix
##        1      2      3      4
## 1 5.3162 3.2668 3.2668 3.2668
## 2 3.2668 5.3162 3.2668 3.2668
## 3 3.2668 3.2668 5.3162 3.2668
## 4 3.2668 3.2668 3.2668 5.3162
##   Standard Deviations: 2.3057 2.3057 2.3057 2.3057</code></pre>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="statistical-models.html#cb1023-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getVarCov</span>(fit.lmer2, <span class="at">type =</span> <span class="st">&quot;conditional&quot;</span>)</span></code></pre></div>
<pre><code>## Subject M01 
## Conditional variance covariance matrix
##        1      2      3      4
## 1 2.0495 0.0000 0.0000 0.0000
## 2 0.0000 2.0495 0.0000 0.0000
## 3 0.0000 0.0000 2.0495 0.0000
## 4 0.0000 0.0000 0.0000 2.0495
##   Standard Deviations: 1.4316 1.4316 1.4316 1.4316</code></pre>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="statistical-models.html#cb1025-1" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.matrix</span>(<span class="fu">VarCorr</span>(fit.lmer2))[,<span class="dv">1</span>])</span>
<span id="cb1025-2"><a href="statistical-models.html#cb1025-2" aria-hidden="true" tabindex="-1"></a>vc<span class="sc">/</span><span class="fu">sum</span>(vc)</span></code></pre></div>
<pre><code>## [1] 0.6144914 0.3855086</code></pre>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="statistical-models.html#cb1027-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(fit.lmer2)</span></code></pre></div>
<pre><code>## Subject = pdLogChol(1) 
##             Variance StdDev  
## (Intercept) 3.266784 1.807425
## Residual    2.049456 1.431592</code></pre>
</div>
<div id="get-y-covariance-directly" class="section level3 hasAnchor" number="6.9.9">
<h3><span class="header-section-number">6.9.9</span> Get y covariance directly<a href="statistical-models.html#get-y-covariance-directly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>= Z REcov Zt + sigma**2</code></p>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="statistical-models.html#cb1029-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span></code></pre></div>
<pre><code>## Loading required package: mgcv</code></pre>
<pre><code>## This is mgcv 1.9-0. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="statistical-models.html#cb1032-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1032-2"><a href="statistical-models.html#cb1032-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1032-3"><a href="statistical-models.html#cb1032-3" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer2,Data)</span>
<span id="cb1032-4"><a href="statistical-models.html#cb1032-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="statistical-models.html#cb1033-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="residual-variance" class="section level3 hasAnchor" number="6.9.10">
<h3><span class="header-section-number">6.9.10</span> Residual variance<a href="statistical-models.html#residual-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="statistical-models.html#cb1035-1" aria-hidden="true" tabindex="-1"></a>fit.lmer2<span class="sc">$</span>sigma<span class="sc">**</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 2.049456</code></pre>
</div>
<div id="compute-fixed-effect-coefficients" class="section level3 hasAnchor" number="6.9.11">
<h3><span class="header-section-number">6.9.11</span> Compute fixed effect coefficients<a href="statistical-models.html#compute-fixed-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="statistical-models.html#cb1037-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb1037-2"><a href="statistical-models.html#cb1037-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov))<span class="sc">%*%</span>y</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">17.7067076</td>
</tr>
<tr class="even">
<td align="right">0.6601871</td>
</tr>
<tr class="odd">
<td align="right">-2.3210230</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-covariance-of-fixed-efffect-coefficients" class="section level3 hasAnchor" number="6.9.12">
<h3><span class="header-section-number">6.9.12</span> Compute covariance of fixed efffect coefficients<a href="statistical-models.html#compute-covariance-of-fixed-efffect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1038-1"><a href="statistical-models.html#cb1038-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.6954267</td>
<td align="right">-0.0417482</td>
<td align="right">-0.2361967</td>
</tr>
<tr class="even">
<td align="right">-0.0417482</td>
<td align="right">0.0037953</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">-0.2361967</td>
<td align="right">0.0000000</td>
<td align="right">0.5797556</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-random-effect-coefficients" class="section level3 hasAnchor" number="6.9.13">
<h3><span class="header-section-number">6.9.13</span> Compute random effect coefficients<a href="statistical-models.html#compute-random-effect-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="statistical-models.html#cb1039-1" aria-hidden="true" tabindex="-1"></a>Lambda_new <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">VarCorr</span>(fit.lmer2)[<span class="dv">1</span>])<span class="sc">*</span><span class="fu">diag</span>(<span class="fu">length</span>(<span class="fu">levels</span>(Data<span class="sc">$</span>Subject)))</span>
<span id="cb1039-2"><a href="statistical-models.html#cb1039-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head(Lambda_new)</span></span></code></pre></div>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="statistical-models.html#cb1040-1" aria-hidden="true" tabindex="-1"></a>uhat <span class="ot">&lt;-</span> fit.lmer2<span class="sc">$</span>coef<span class="sc">$</span>random </span>
<span id="cb1040-2"><a href="statistical-models.html#cb1040-2" aria-hidden="true" tabindex="-1"></a>comput_uhat <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(Lambda_new))<span class="sc">%*%</span><span class="fu">t</span>(Z)<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov))<span class="sc">%*%</span>(y<span class="sc">-</span><span class="fu">as.matrix</span>(X)<span class="sc">%*%</span>(bhat))</span>
<span id="cb1040-3"><a href="statistical-models.html#cb1040-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>((comput_uhat<span class="sc">@</span>x),(uhat[[<span class="st">&quot;Subject&quot;</span>]]))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"></th>
<th align="right">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">M16</td>
<td align="right">-1.7018337</td>
<td align="right">-1.7018336</td>
</tr>
<tr class="even">
<td align="left">M05</td>
<td align="right">-1.7018337</td>
<td align="right">-1.7018336</td>
</tr>
<tr class="odd">
<td align="left">M02</td>
<td align="right">-1.3776749</td>
<td align="right">-1.3776748</td>
</tr>
<tr class="even">
<td align="left">M11</td>
<td align="right">-1.1615690</td>
<td align="right">-1.1615689</td>
</tr>
<tr class="odd">
<td align="left">M07</td>
<td align="right">-1.0535161</td>
<td align="right">-1.0535160</td>
</tr>
<tr class="even">
<td align="left">M08</td>
<td align="right">-0.9454632</td>
<td align="right">-0.9454631</td>
</tr>
<tr class="odd">
<td align="left">M03</td>
<td align="right">-0.6213044</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="even">
<td align="left">M12</td>
<td align="right">-0.6213044</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="odd">
<td align="left">M13</td>
<td align="right">-0.6213044</td>
<td align="right">-0.6213043</td>
</tr>
<tr class="even">
<td align="left">M14</td>
<td align="right">-0.0810397</td>
<td align="right">-0.0810397</td>
</tr>
<tr class="odd">
<td align="left">M09</td>
<td align="right">0.1350662</td>
<td align="right">0.1350662</td>
</tr>
<tr class="even">
<td align="left">M15</td>
<td align="right">0.7833838</td>
<td align="right">0.7833837</td>
</tr>
<tr class="odd">
<td align="left">M06</td>
<td align="right">1.2155955</td>
<td align="right">1.2155954</td>
</tr>
<tr class="even">
<td align="left">M04</td>
<td align="right">1.4317013</td>
<td align="right">1.4317013</td>
</tr>
<tr class="odd">
<td align="left">M01</td>
<td align="right">2.4041777</td>
<td align="right">2.4041776</td>
</tr>
<tr class="even">
<td align="left">M10</td>
<td align="right">3.9169188</td>
<td align="right">3.9169185</td>
</tr>
<tr class="odd">
<td align="left">F10</td>
<td align="right">-3.5853927</td>
<td align="right">-3.5853925</td>
</tr>
<tr class="even">
<td align="left">F09</td>
<td align="right">-1.3162812</td>
<td align="right">-1.3162811</td>
</tr>
<tr class="odd">
<td align="left">F06</td>
<td align="right">-1.3162812</td>
<td align="right">-1.3162811</td>
</tr>
<tr class="even">
<td align="left">F01</td>
<td align="right">-1.1001753</td>
<td align="right">-1.1001752</td>
</tr>
<tr class="odd">
<td align="left">F05</td>
<td align="right">-0.0196460</td>
<td align="right">-0.0196460</td>
</tr>
<tr class="even">
<td align="left">F07</td>
<td align="right">0.3045128</td>
<td align="right">0.3045128</td>
</tr>
<tr class="odd">
<td align="left">F02</td>
<td align="right">0.3045128</td>
<td align="right">0.3045128</td>
</tr>
<tr class="even">
<td align="left">F08</td>
<td align="right">0.6286716</td>
<td align="right">0.6286716</td>
</tr>
<tr class="odd">
<td align="left">F03</td>
<td align="right">0.9528304</td>
<td align="right">0.9528303</td>
</tr>
<tr class="even">
<td align="left">F04</td>
<td align="right">1.9253068</td>
<td align="right">1.9253067</td>
</tr>
<tr class="odd">
<td align="left">F11</td>
<td align="right">3.2219420</td>
<td align="right">3.2219418</td>
</tr>
</tbody>
</table>
</div>
<div id="compute-predicted-values" class="section level3 hasAnchor" number="6.9.14">
<h3><span class="header-section-number">6.9.14</span> Compute predicted values<a href="statistical-models.html#compute-predicted-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>usually computing mean and  prediction ci by using bootstrapping and simulated methods</code></p>
<p>approximate at below:</p>
<p><em>This <a href="!--%20https://stackoverflow.com/questions/14358811/extract-prediction-band-from-lme-fit%20--">webpage</a> calculates the sd like above, but I think the following is also correct. </em></p>
<div id="the-conditional-distribution" class="section level4 hasAnchor" number="6.9.14.1">
<h4><span class="header-section-number">6.9.14.1</span> the conditional distribution<a href="statistical-models.html#the-conditional-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\mathbf{y}_{} \mid \mathbf{b}_{} \sim \mathbf{N}\left(\mathbf{X}_{} \boldsymbol{\beta}+\mathbf{Z}_{} \mathbf{b}_{}, \boldsymbol{\Sigma}_{}\right)
\]</span>
therefore</p>
<ul>
<li><p><code>conditional mean prediction</code>
<span class="math display">\[
\begin{align}
E(\hat{Y}_0)&amp;=E\mathbf{(X_0\hat{\beta} + Z_0\hat{u})}=\mathbf{X_0\beta + Z_0{u}}=E\mathbf{(Y_0)}\\
var(\hat{Y}_0)&amp;=E\mathbf{((X_0\hat{\beta}-X_0\beta)+ (Z_0\hat{u} - Z_0{u}))}^2\\&amp;=E\mathbf{((X_0\hat{\beta}-X_0\beta)^2+ (Z_0\hat{u} - Z_0{u})^2+ 2 ((X_0\hat{\beta}-X_0\beta)* (Z_0\hat{u} - Z_0{u}))  )}
\\
            &amp;=E\mathbf{\left(
X_0(\hat{\beta}-\beta)(\hat{\beta}-\beta)&#39;X_0&#39; \right)}+
E\mathbf{\left(
Z_0(\hat{u}-u)(\hat{u}-u)&#39;Z_0&#39; \right)}+2E ((X_0(\hat{\beta}-\beta))* (Z_0(\hat{u} - {u}))) ?
\\
            &amp;=\sigma^2\mathbf{X_0\left( X&#39;X
\right)^{-1}X_0&#39;}+ \sigma^2\mathbf{Z_0\left( Z&#39;Z
\right)^{-1}Z_0&#39;} + 2 *0*0 \quad \text {if independent}\\
&amp;= \mathbf{X_0 cov (X) X_0&#39;}+  \mathbf{Z_0 cov (Z) Z_0&#39;}  \\
\end{align}
\]</span></p>
<p><code>generally</code>
<span class="math display">\[
\begin{align}
Var(X+Y) &amp;= Cov(X+Y,X+Y)  \\
&amp;= E((X+Y)^2)-E(X+Y)E(X+Y)   \\
&amp;\text{by expanding,}  \\
&amp;= E(X^2) - (E(X))^2 + E(Y^2) - (E(Y))^2 + 2(E(XY) - E(X)E(Y))  \\
&amp;= Var(X) + Var(Y) + 2(E(XY)) - E(X)E(Y))  \\
\end{align}
\]</span></p></li>
<li><p><code>conditional individual prediction</code>
<span class="math display">\[
\begin{align}
E(\hat{Y}_0)&amp;= E\mathbf{(Y_0)}\\
var(\hat{Y}_0)
&amp;= \mathbf{X_0 cov (X) X_0&#39;}+  \mathbf{Z_0 cov (Z) Z_0&#39;} + \sigma^2 \\
\end{align}
\]</span></p></li>
</ul>
<p><span class="math display">\[
\begin{align}
\hat{Y}_0&amp; \sim N(\mu_{\hat{Y}_0},\sigma^2_{\hat{Y}_0})\\
\end{align}
\]</span></p>
<ul>
<li><code>lower level (conditional prediction) in R</code></li>
</ul>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1041-1"><a href="statistical-models.html#cb1041-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how to calculate predicted values</span></span>
<span id="cb1041-2"><a href="statistical-models.html#cb1041-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> X<span class="sc">%*%</span>(fit.lmer2<span class="sc">$</span>coef<span class="sc">$</span>fixed)<span class="sc">+</span>Z<span class="sc">%*%</span> <span class="fu">as.numeric</span> ( uhat[[<span class="st">&quot;Subject&quot;</span>]])</span>
<span id="cb1041-3"><a href="statistical-models.html#cb1041-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1041-4"><a href="statistical-models.html#cb1041-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">cbind</span> (yhat,<span class="fu">predict</span>(fit.lmer2),y))  <span class="co">#create individual trajectory curve   </span></span></code></pre></div>
<pre><code>## 6 x 3 Matrix of class &quot;dgeMatrix&quot;
##                        y
## 1 25.39237 25.39237 26.0
## 2 26.71274 26.71274 25.0
## 3 28.03311 28.03311 29.0
## 4 29.35348 29.35348 31.0
## 5 21.61052 21.61052 21.5
## 6 22.93089 22.93089 22.5</code></pre>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1043-1"><a href="statistical-models.html#cb1043-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute standard error for marginal predictions</span></span>
<span id="cb1043-2"><a href="statistical-models.html#cb1043-2" aria-hidden="true" tabindex="-1"></a>predvar_rand <span class="ot">&lt;-</span> <span class="fu">diag</span>(X <span class="sc">%*%</span> fit.lmer2<span class="sc">$</span>varFix <span class="sc">%*%</span> <span class="fu">t</span>(X)) <span class="sc">+</span> <span class="fu">diag</span>(Z <span class="sc">%*%</span>  <span class="fu">diag</span>(<span class="fu">getVarCov</span>(fit.lmer2)[<span class="dv">1</span>]  ,<span class="dv">27</span>) <span class="sc">%*%</span> <span class="fu">t</span>(Z))</span>
<span id="cb1043-3"><a href="statistical-models.html#cb1043-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1043-4"><a href="statistical-models.html#cb1043-4" aria-hidden="true" tabindex="-1"></a>SE_rand <span class="ot">&lt;-</span> <span class="fu">sqrt</span> (predvar_rand)  <span class="co">#mean prediction </span></span>
<span id="cb1043-5"><a href="statistical-models.html#cb1043-5" aria-hidden="true" tabindex="-1"></a>SE_rand2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(predvar_rand<span class="sc">+</span>fit.lmer2<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>)  <span class="co">#individual prediction </span></span>
<span id="cb1043-6"><a href="statistical-models.html#cb1043-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SE_rand,<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 1.880728 1.872639 1.872639 1.880728 1.880728 1.872639 1.872639 1.880728 
##        9       10       11       12       13       14       15       16 
## 1.880728 1.872639 1.872639 1.880728 1.880728 1.872639 1.872639 1.880728 
##       17       18       19       20 
## 1.880728 1.872639 1.872639 1.880728</code></pre>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1045-1"><a href="statistical-models.html#cb1045-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SE_rand2,<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 2.363598 2.357166 2.357166 2.363598 2.363598 2.357166 2.357166 2.363598 
##        9       10       11       12       13       14       15       16 
## 2.363598 2.357166 2.357166 2.363598 2.363598 2.357166 2.357166 2.363598 
##       17       18       19       20 
## 2.363598 2.357166 2.357166 2.363598</code></pre>
<p><code>see below</code></p>
</div>
<div id="the-marginal-distribution" class="section level4 hasAnchor" number="6.9.14.2">
<h4><span class="header-section-number">6.9.14.2</span> The marginal distribution<a href="statistical-models.html#the-marginal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\mathbf{y}_{} \sim \mathrm{N}\left(\mathbf{X}_{} \boldsymbol{\beta}, \mathbf{V}_{}\right)
\]</span></p>
<p><span class="math display">\[
\operatorname{Cov}[\mathbf{y}]=\mathbf{V}=\mathbf{Z D Z}^{\prime}+\Sigma
\]</span></p>
<p><em><span class="math inline">\(\mathbf{Z}_{} \mathbf{D Z}_{}^{\prime}\)</span> represents the random-effects structure</em></p>
<p>therefore</p>
<ul>
<li><code>marginal mean prediction</code></li>
</ul>
<p><span class="math display">\[
\begin{align}
E(\hat{Y}_0)&amp;=E\mathbf{(X_0\hat{\beta})}=\mathbf{X_0\beta}=E\mathbf{(Y_0)}\\
var(\hat{Y}_0)&amp;=E\mathbf{(X_0\hat{\beta}-X_0\beta)}^2\\
              &amp;=E\mathbf{\left(
X_0(\hat{\beta}-\beta)(\hat{\beta}-\beta)&#39;X_0&#39; \right)}\\
              &amp;=E\mathbf{X_0\left(
(\hat{\beta}-\beta)(\hat{\beta}-\beta)&#39; \right)X_0&#39;}\\
              &amp;=\mathbf{X_0Cov(X)X_0&#39;}\\
\end{align}
\]</span></p>
<ul>
<li><p><code>marginal individual prediction</code>
<span class="math display">\[
\begin{align}
E(\hat{Y}_0)&amp;= E\mathbf{(Y_0)}\\
var(\hat{Y}_0)
&amp;= \mathbf{X_0 cov (X) X_0&#39;}+    \sigma^2 \\
\end{align}
\]</span></p></li>
<li><p><code>higher level (marginal)</code> in R</p></li>
</ul>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1047-1"><a href="statistical-models.html#cb1047-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute standard error for marginal predictions</span></span>
<span id="cb1047-2"><a href="statistical-models.html#cb1047-2" aria-hidden="true" tabindex="-1"></a>predvar <span class="ot">&lt;-</span> <span class="fu">diag</span>(X <span class="sc">%*%</span> fit.lmer2<span class="sc">$</span>varFix <span class="sc">%*%</span> <span class="fu">t</span>(X))</span>
<span id="cb1047-3"><a href="statistical-models.html#cb1047-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1047-4"><a href="statistical-models.html#cb1047-4" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span> (predvar)  <span class="co">#mean prediction </span></span>
<span id="cb1047-5"><a href="statistical-models.html#cb1047-5" aria-hidden="true" tabindex="-1"></a>SE2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(predvar<span class="sc">+</span>fit.lmer2<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>)  <span class="co">#individual prediction</span></span>
<span id="cb1047-6"><a href="statistical-models.html#cb1047-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SE,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##         1         2         3         4         5         6         7         8 
## 0.5199561 0.4898898 0.4898898 0.5199561 0.5199561 0.4898898 0.4898898 0.5199561 
##         9        10 
## 0.5199561 0.4898898</code></pre>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1049-1"><a href="statistical-models.html#cb1049-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SE2,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6        7        8 
## 1.523092 1.513092 1.513092 1.523092 1.523092 1.513092 1.513092 1.523092 
##        9       10 
## 1.523092 1.513092</code></pre>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1051-1"><a href="statistical-models.html#cb1051-1" aria-hidden="true" tabindex="-1"></a>up<span class="ot">=</span><span class="fu">predict</span>(fit.lmer2, <span class="at">newdata=</span>Data, <span class="at">level=</span><span class="dv">0</span>) <span class="sc">+</span><span class="fl">1.96</span> <span class="sc">*</span>SE  <span class="co">#mean prediction </span></span>
<span id="cb1051-2"><a href="statistical-models.html#cb1051-2" aria-hidden="true" tabindex="-1"></a>up2<span class="ot">=</span><span class="fu">predict</span>(fit.lmer2, <span class="at">newdata=</span>Data, <span class="at">level=</span><span class="dv">0</span>) <span class="sc">+</span><span class="fl">1.96</span> <span class="sc">*</span>SE2  <span class="co">#individual prediction </span></span>
<span id="cb1051-3"><a href="statistical-models.html#cb1051-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(up)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 24.00731 25.26875 26.58912 27.96842 24.00731 25.26875</code></pre>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1053-1"><a href="statistical-models.html#cb1053-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(up2)</span></code></pre></div>
<pre><code>##        1        2        3        4        5        6 
## 25.97346 27.27423 28.59460 29.93457 25.97346 27.27423</code></pre>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="statistical-models.html#cb1055-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1055-2"><a href="statistical-models.html#cb1055-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1055-3"><a href="statistical-models.html#cb1055-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(fit.lmer2,<span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;age&quot;</span> ))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">predicted</th>
<th align="right">std.error</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">8</td>
<td align="right">22.98819</td>
<td align="right">0.5199561</td>
<td align="right">21.96910</td>
<td align="right">24.00729</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">24.30856</td>
<td align="right">0.4898898</td>
<td align="right">23.34840</td>
<td align="right">25.26873</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">25.62894</td>
<td align="right">0.4898898</td>
<td align="right">24.66877</td>
<td align="right">26.58910</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">26.94931</td>
<td align="right">0.5199561</td>
<td align="right">25.93021</td>
<td align="right">27.96840</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="statistical-models.html#cb1056-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpredict</span>(fit.lmer2,<span class="at">terms=</span><span class="fu">c</span>(<span class="st">&quot;age&quot;</span> ))  <span class="sc">%&gt;%</span> <span class="fu">plot</span>(<span class="at">rawdata =</span> T, <span class="at">dot.alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="statistical-models.html#cb1057-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggpredict(fit.lmer2,&quot;age&quot;,   type = &quot;re&quot; )  %&gt;% plot(rawdata = T, dot.alpha = 0.2)</span></span></code></pre></div>
<p><strong>Compute SE by hand and compare with above SE: </strong></p>
<p>0.520408163
0.489795918
0.489795918
0.520408163</p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="statistical-models.html#cb1058-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SE,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##         1         2         3         4         5         6         7         8 
## 0.5199561 0.4898898 0.4898898 0.5199561 0.5199561 0.4898898 0.4898898 0.5199561 
##         9        10 
## 0.5199561 0.4898898</code></pre>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="statistical-models.html#cb1060-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(predict(fit.lmer2))</span></span>
<span id="cb1060-2"><a href="statistical-models.html#cb1060-2" aria-hidden="true" tabindex="-1"></a><span class="co"># head (predict(fit.lmer2, newdata=Data, level=1)) #predicted value</span></span>
<span id="cb1060-3"><a href="statistical-models.html#cb1060-3" aria-hidden="true" tabindex="-1"></a><span class="co"># head (predict(fit.lmer2, newdata=Data, level=0)) #mean and ci   </span></span></code></pre></div>
<!-- `fixed effect variance` -->
<!-- ```{r} -->
<!-- diag (X%*%(vcov(fit.lmer2))%*%t(X)) -->
<!-- ``` -->
<!-- `marginal y mean and variance directly` -->
<!-- # ```{r} -->
<!-- # ymean <- X%*%(fit.lmer2$coef$fixed)  # multiple comparisons (combine clusters) -->
<!-- # ysd  <- sqrt (diag (cov)) -->
<!-- # head(cbind (ymean,ysd )) -->
<!-- # ``` -->
</div>
</div>
<div id="using-lme-with-gaussian" class="section level3 hasAnchor" number="6.9.15">
<h3><span class="header-section-number">6.9.15</span> Using lme with Gaussian<a href="statistical-models.html#using-lme-with-gaussian" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>it means the correlation in a group but not correlation in variables (different covariances)</code></p>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="statistical-models.html#cb1061-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1061-2"><a href="statistical-models.html#cb1061-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1061-3"><a href="statistical-models.html#cb1061-3" aria-hidden="true" tabindex="-1"></a>fit.lmer.gaus <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Subject, <span class="at">correlation=</span><span class="fu">corGaus</span>(<span class="at">form=</span> <span class="sc">~</span> age<span class="sc">|</span>Subject, <span class="at">nugget=</span><span class="cn">TRUE</span>), <span class="at">data =</span> Data) </span>
<span id="cb1061-4"><a href="statistical-models.html#cb1061-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.gaus)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC      BIC    logLik
##   451.4311 470.0089 -218.7156
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.795504 1.446192
## 
## Correlation Structure: Gaussian spatial correlation
##  Formula: ~age | Subject 
##  Parameter estimate(s):
##     range    nugget 
## 1.1324270 0.1039537 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.717033 0.8448813 80 20.969848  0.0000
## age          0.659620 0.0628344 80 10.497756  0.0000
## SexFemale   -2.325355 0.7612563 25 -3.054629  0.0053
##  Correlation: 
##           (Intr) age   
## age       -0.818       
## SexFemale -0.367  0.000
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.70618679 -0.54458678 -0.01435195  0.45606804  3.62915585 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<ul>
<li>Plotting of the empirical covariation (of residuals) versus “age”</li>
</ul>
<p><code>when describing the spatial pattern of a measured variable, a common way of visualizing the spatial autocorrelation of a variable is a variogram plot.</code></p>
<p><code>checking the semi-variance change by the distance of spatial autocorrelation.</code></p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="statistical-models.html#cb1063-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(<span class="fu">Variogram</span>(fit.lmer.gaus, <span class="at">form =</span><span class="sc">~</span><span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject,</span>
<span id="cb1063-2"><a href="statistical-models.html#cb1063-2" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> Data)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-498-1.png" width="672" /></p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="statistical-models.html#cb1064-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span>
<span id="cb1064-2"><a href="statistical-models.html#cb1064-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1064-3"><a href="statistical-models.html#cb1064-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1064-4"><a href="statistical-models.html#cb1064-4" aria-hidden="true" tabindex="-1"></a>cov.gaus <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer.gaus,Data)</span>
<span id="cb1064-5"><a href="statistical-models.html#cb1064-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov.gaus)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.315307</td>
<td align="right">3.306657</td>
<td align="right">3.223843</td>
<td align="right">3.223836</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.306657</td>
<td align="right">5.315307</td>
<td align="right">3.306657</td>
<td align="right">3.223843</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.223843</td>
<td align="right">3.306657</td>
<td align="right">5.315307</td>
<td align="right">3.306657</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.223836</td>
<td align="right">3.223843</td>
<td align="right">3.306657</td>
<td align="right">5.315307</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.315307</td>
<td align="right">3.306657</td>
<td align="right">3.223843</td>
<td align="right">3.223836</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.306657</td>
<td align="right">5.315307</td>
<td align="right">3.306657</td>
<td align="right">3.223843</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="statistical-models.html#cb1065-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov.gaus)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
<ul>
<li>Compute fixed effect coefficients using Gaussian</li>
</ul>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="statistical-models.html#cb1067-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb1067-2"><a href="statistical-models.html#cb1067-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inv</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov.gaus))<span class="sc">%*%</span><span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">t</span>(<span class="fu">as.matrix</span>(X))<span class="sc">%*%</span><span class="fu">inv</span>(<span class="fu">as.matrix</span>(cov.gaus))<span class="sc">%*%</span>y</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">17.7170272</td>
</tr>
<tr class="even">
<td align="right">0.6596201</td>
</tr>
<tr class="odd">
<td align="right">-2.3253552</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1068-1"><a href="statistical-models.html#cb1068-1" aria-hidden="true" tabindex="-1"></a>fit.lmer.gaus<span class="sc">$</span>coef<span class="sc">$</span>fixed</span></code></pre></div>
<pre><code>## (Intercept)         age   SexFemale 
##   17.717033    0.659620   -2.325355</code></pre>
<p><em>the same below</em></p>
</div>
<div id="using-lme-with-autoregressive" class="section level3 hasAnchor" number="6.9.16">
<h3><span class="header-section-number">6.9.16</span> Using lme with autoregressive<a href="statistical-models.html#using-lme-with-autoregressive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="statistical-models.html#cb1070-1" aria-hidden="true" tabindex="-1"></a>fit.lmer.AR1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Subject, <span class="at">correlation=</span><span class="fu">corAR1</span>(<span class="at">form=</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject ), <span class="at">data =</span> Data) </span>
<span id="cb1070-2"><a href="statistical-models.html#cb1070-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.AR1)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC      BIC    logLik
##   449.5125 465.4363 -218.7563
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.807425 1.431592
## 
## Correlation Structure: ARMA(1,0)
##  Formula: ~as.numeric(age) | Subject 
##  Parameter estimate(s):
## Phi1 
##    0 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.706713 0.8339225 80 21.233044  0.0000
## age          0.660185 0.0616059 80 10.716263  0.0000
## SexFemale   -2.321023 0.7614168 25 -3.048294  0.0054
##  Correlation: 
##           (Intr) age   
## age       -0.813       
## SexFemale -0.372  0.000
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.74889609 -0.55034466 -0.02516628  0.45341781  3.65746539 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<ul>
<li>Plotting of the empirical covariation (of residuals) versus “age”</li>
</ul>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1072-1"><a href="statistical-models.html#cb1072-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(<span class="fu">Variogram</span>(fit.lmer.AR1, <span class="at">form =</span><span class="sc">~</span><span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject,</span>
<span id="cb1072-2"><a href="statistical-models.html#cb1072-2" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> Data)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-502-1.png" width="672" /></p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="statistical-models.html#cb1073-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span>
<span id="cb1073-2"><a href="statistical-models.html#cb1073-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1073-3"><a href="statistical-models.html#cb1073-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1073-4"><a href="statistical-models.html#cb1073-4" aria-hidden="true" tabindex="-1"></a>cov.AR1 <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer.AR1,Data)</span>
<span id="cb1073-5"><a href="statistical-models.html#cb1073-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov.AR1)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="statistical-models.html#cb1074-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov.AR1)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="using-lme-with-exponential" class="section level3 hasAnchor" number="6.9.17">
<h3><span class="header-section-number">6.9.17</span> Using lme with exponential<a href="statistical-models.html#using-lme-with-exponential" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="statistical-models.html#cb1076-1" aria-hidden="true" tabindex="-1"></a>fit.lmer.Exp <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Subject, <span class="at">correlation=</span><span class="fu">corExp</span>(<span class="at">form=</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject ), <span class="at">data =</span> Data) </span>
<span id="cb1076-2"><a href="statistical-models.html#cb1076-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.Exp)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC      BIC    logLik
##   449.3968 465.3206 -218.6984
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.788899 1.454494
## 
## Correlation Structure: Exponential spatial correlation
##  Formula: ~as.numeric(age) | Subject 
##  Parameter estimate(s):
##     range 
## 0.7045117 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.721416 0.8500193 80 20.848250  0.0000
## age          0.659405 0.0634074 80 10.399499  0.0000
## SexFemale   -2.327485 0.7611852 25 -3.057711  0.0053
##  Correlation: 
##           (Intr) age   
## age       -0.821       
## SexFemale -0.365  0.000
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -3.683026667 -0.540915318 -0.008097445  0.461167542  3.612579065 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<ul>
<li>Plotting of the empirical covariation (of residuals) versus “age”</li>
</ul>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="statistical-models.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(<span class="fu">Variogram</span>(fit.lmer.Exp, <span class="at">form =</span><span class="sc">~</span><span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject,</span>
<span id="cb1078-2"><a href="statistical-models.html#cb1078-2" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> Data)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1079-1"><a href="statistical-models.html#cb1079-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span>
<span id="cb1079-2"><a href="statistical-models.html#cb1079-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1079-3"><a href="statistical-models.html#cb1079-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1079-4"><a href="statistical-models.html#cb1079-4" aria-hidden="true" tabindex="-1"></a>cov.Exp <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer.Exp,Data)</span>
<span id="cb1079-5"><a href="statistical-models.html#cb1079-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov.Exp)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.315710</td>
<td align="right">3.323904</td>
<td align="right">3.207397</td>
<td align="right">3.200582</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.323904</td>
<td align="right">5.315710</td>
<td align="right">3.323904</td>
<td align="right">3.207397</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.207397</td>
<td align="right">3.323904</td>
<td align="right">5.315710</td>
<td align="right">3.323904</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.200582</td>
<td align="right">3.207397</td>
<td align="right">3.323904</td>
<td align="right">5.315710</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.315710</td>
<td align="right">3.323904</td>
<td align="right">3.207397</td>
<td align="right">3.200582</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.323904</td>
<td align="right">5.315710</td>
<td align="right">3.323904</td>
<td align="right">3.207397</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="statistical-models.html#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov.Exp)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="using-lme-with-unstructured" class="section level3 hasAnchor" number="6.9.18">
<h3><span class="header-section-number">6.9.18</span> Using lme with unstructured<a href="statistical-models.html#using-lme-with-unstructured" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="statistical-models.html#cb1082-1" aria-hidden="true" tabindex="-1"></a>fit.lmer.corSymm <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span>  (Subject), <span class="at">correlation=</span><span class="fu">corSymm</span>(<span class="at">form=</span> <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span> (Subject) ),</span>
<span id="cb1082-2"><a href="statistical-models.html#cb1082-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>age),</span>
<span id="cb1082-3"><a href="statistical-models.html#cb1082-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> Data)</span>
<span id="cb1082-4"><a href="statistical-models.html#cb1082-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.corSymm)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC    BIC    logLik
##   456.6945 493.85 -214.3473
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.783141 1.481553
## 
## Correlation Structure: General
##  Formula: ~1 | (Subject) 
##  Parameter estimate(s):
##  Correlation: 
##   1      2      3     
## 2 -0.260              
## 3  0.238 -0.149       
## 4 -0.251 -0.007  0.426
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | age 
##  Parameter estimates:
##         8        10        12        14 
## 1.0000000 0.6868412 1.1990772 1.0004135 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.417592 0.8657149 80 20.119316  0.0000
## age          0.674651 0.0702289 80  9.606462  0.0000
## SexFemale   -2.045167 0.7361374 25 -2.778241  0.0102
##  Correlation: 
##           (Intr) age   
## age       -0.840       
## SexFemale -0.346  0.000
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.33886286 -0.56222407  0.01374192  0.52235930  3.99060002 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<ul>
<li>Plotting of the empirical covariation (of residuals) versus “age”</li>
</ul>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="statistical-models.html#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(<span class="fu">Variogram</span>(fit.lmer.corSymm, <span class="at">form =</span><span class="sc">~</span><span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject,</span>
<span id="cb1084-2"><a href="statistical-models.html#cb1084-2" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> Data)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-508-1.png" width="672" /></p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="statistical-models.html#cb1085-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span>
<span id="cb1085-2"><a href="statistical-models.html#cb1085-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1085-3"><a href="statistical-models.html#cb1085-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1085-4"><a href="statistical-models.html#cb1085-4" aria-hidden="true" tabindex="-1"></a>cov.corSymm <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer.corSymm,Data)</span>
<span id="cb1085-5"><a href="statistical-models.html#cb1085-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov.corSymm)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.374591</td>
<td align="right">2.786933</td>
<td align="right">3.807033</td>
<td align="right">2.628359</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2.786933</td>
<td align="right">4.215084</td>
<td align="right">2.909655</td>
<td align="right">3.168383</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.807033</td>
<td align="right">2.909655</td>
<td align="right">6.335531</td>
<td align="right">4.301450</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2.628359</td>
<td align="right">3.168383</td>
<td align="right">4.301450</td>
<td align="right">5.376406</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.374591</td>
<td align="right">2.786933</td>
<td align="right">3.807033</td>
<td align="right">2.628359</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">2.786933</td>
<td align="right">4.215084</td>
<td align="right">2.909655</td>
<td align="right">3.168383</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="statistical-models.html#cb1086-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov.corSymm)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
<!-- - Using gls with unstructured  -->
<!-- ```{r} -->
<!-- gls.corSymm <- gls(distance ~ age + Sex  ,    -->
<!--                      correlation=corSymm(form= ~ 1| (Subject) ), -->
<!--                      weights = varIdent(form=~1|age), -->
<!--                      data = Data) -->
<!-- summary(gls.corSymm) -->
<!-- ``` -->
</div>
<div id="using-lme-with-compound-symm" class="section level3 hasAnchor" number="6.9.19">
<h3><span class="header-section-number">6.9.19</span> Using lme with compound symm<a href="statistical-models.html#using-lme-with-compound-symm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="statistical-models.html#cb1088-1" aria-hidden="true" tabindex="-1"></a>fit.lmer.Symm <span class="ot">&lt;-</span> <span class="fu">lme</span>(distance <span class="sc">~</span> age <span class="sc">+</span> Sex  , <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span>  (Subject), <span class="at">correlation=</span><span class="fu">corCompSymm</span>(<span class="at">form=</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(age)<span class="sc">|</span> (Subject) ), <span class="at">data =</span> Data) </span>
<span id="cb1088-2"><a href="statistical-models.html#cb1088-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.lmer.Symm)</span></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Data 
##        AIC      BIC    logLik
##   449.5125 465.4363 -218.7563
## 
## Random effects:
##  Formula: ~1 | Subject
##         (Intercept) Residual
## StdDev:    1.807425 1.431592
## 
## Correlation Structure: Compound symmetry
##  Formula: ~as.numeric(age) | (Subject) 
##  Parameter estimate(s):
## Rho 
##   0 
## Fixed effects:  distance ~ age + Sex 
##                 Value Std.Error DF   t-value p-value
## (Intercept) 17.706713 0.8339225 80 21.233044  0.0000
## age          0.660185 0.0616059 80 10.716263  0.0000
## SexFemale   -2.321023 0.7614168 25 -3.048294  0.0054
##  Correlation: 
##           (Intr) age   
## age       -0.813       
## SexFemale -0.372  0.000
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -3.74889609 -0.55034466 -0.02516628  0.45341781  3.65746539 
## 
## Number of Observations: 108
## Number of Groups: 27</code></pre>
<ul>
<li>Plotting of the empirical covariation (of residuals) versus “age”</li>
</ul>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="statistical-models.html#cb1090-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">plot</span>(<span class="fu">Variogram</span>(fit.lmer.Symm, <span class="at">form =</span><span class="sc">~</span><span class="fu">as.numeric</span>(age)<span class="sc">|</span>Subject,</span>
<span id="cb1090-2"><a href="statistical-models.html#cb1090-2" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> Data)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="statistical-models.html#cb1091-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(mgcv)</span>
<span id="cb1091-2"><a href="statistical-models.html#cb1091-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1091-3"><a href="statistical-models.html#cb1091-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1091-4"><a href="statistical-models.html#cb1091-4" aria-hidden="true" tabindex="-1"></a>cov.Symm <span class="ot">&lt;-</span> <span class="fu">extract.lme.cov</span>(fit.lmer.Symm,Data)</span>
<span id="cb1091-5"><a href="statistical-models.html#cb1091-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cov.Symm)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
<col width="0%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">3.266784</td>
<td align="right">5.316240</td>
<td align="right">3.266784</td>
<td align="right">3.266784</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="statistical-models.html#cb1092-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cov.Symm)</span></code></pre></div>
<pre><code>## [1] 108 108</code></pre>
</div>
<div id="using-gls-with-unstructured-corsymm" class="section level3 hasAnchor" number="6.9.20">
<h3><span class="header-section-number">6.9.20</span> Using gls with unstructured, corSymm<a href="statistical-models.html#using-gls-with-unstructured-corsymm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="statistical-models.html#cb1094-1" aria-hidden="true" tabindex="-1"></a>gls.corsymm <span class="ot">&lt;-</span> <span class="fu">gls</span>(distance <span class="sc">~</span> Sex <span class="sc">+</span>age, Orthodont,</span>
<span id="cb1094-2"><a href="statistical-models.html#cb1094-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">correlation =</span> <span class="fu">corSymm</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Subject),</span>
<span id="cb1094-3"><a href="statistical-models.html#cb1094-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>age))</span>
<span id="cb1094-4"><a href="statistical-models.html#cb1094-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gls.corsymm)</span></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: distance ~ Sex + age 
##   Data: Orthodont 
##        AIC     BIC    logLik
##   454.6945 489.196 -214.3473
## 
## Correlation Structure: General
##  Formula: ~1 | Subject 
##  Parameter estimate(s):
##  Correlation: 
##   1     2     3    
## 2 0.586            
## 3 0.652 0.563      
## 4 0.489 0.666 0.737
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | age 
##  Parameter estimates:
##         8        10        12        14 
## 1.0000000 0.8855835 1.0857261 1.0001634 
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) 17.417594 0.8657135 20.119350  0.0000
## SexFemale   -2.045174 0.7361405 -2.778238  0.0065
## age          0.674651 0.0702285  9.606514  0.0000
## 
##  Correlation: 
##           (Intr) SexFml
## SexFemale -0.346       
## age       -0.840  0.000
## 
## Standardized residuals:
##          Min           Q1          Med           Q3          Max 
## -2.508189030 -0.584409277  0.003646472  0.531072913  2.179754376 
## 
## Residual standard error: 2.318327 
## Degrees of freedom: 108 total; 105 residual</code></pre>
</div>
<div id="using-gls-with-compound-symm-which-lmer-model-default-lme-default-lme-compound-symm-lme-auto-reg-in-this-example" class="section level3 hasAnchor" number="6.9.21">
<h3><span class="header-section-number">6.9.21</span> Using gls with compound symm, which = lmer model default = lme default = lme compound symm =lme auto reg in this example<a href="statistical-models.html#using-gls-with-compound-symm-which-lmer-model-default-lme-default-lme-compound-symm-lme-auto-reg-in-this-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1096"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1096-1"><a href="statistical-models.html#cb1096-1" aria-hidden="true" tabindex="-1"></a>gls.comsys <span class="ot">&lt;-</span> <span class="fu">gls</span>(distance <span class="sc">~</span> Sex <span class="sc">+</span>age, Orthodont,</span>
<span id="cb1096-2"><a href="statistical-models.html#cb1096-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">correlation =</span> <span class="fu">corCompSymm</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Subject))</span>
<span id="cb1096-3"><a href="statistical-models.html#cb1096-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gls.comsys)</span></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: distance ~ Sex + age 
##   Data: Orthodont 
##        AIC      BIC    logLik
##   447.5125 460.7823 -218.7563
## 
## Correlation Structure: Compound symmetry
##  Formula: ~1 | Subject 
##  Parameter estimate(s):
##       Rho 
## 0.6144914 
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) 17.706713 0.8339225 21.233044  0.0000
## SexFemale   -2.321023 0.7614169 -3.048294  0.0029
## age          0.660185 0.0616059 10.716263  0.0000
## 
##  Correlation: 
##           (Intr) SexFml
## SexFemale -0.372       
## age       -0.813  0.000
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -2.59712955 -0.64544226 -0.02540005  0.51680604  2.32947531 
## 
## Residual standard error: 2.305697 
## Degrees of freedom: 108 total; 105 residual</code></pre>
<p><strong>lme4 does not allow to specify it, and it can only fit LMMs with independent residual errors. However, the range of available variance-covariance matrices for the random effects are restricted to diagonal or general matrices. </strong></p>
</div>
</div>
<div id="manual-simulating-data-for-linear-mix-model" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Manual simulating data for linear mix model<a href="statistical-models.html#manual-simulating-data-for-linear-mix-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://rpubs.com/Daniel_He/1041001">see here</a></p>
</div>
<div id="how-to-calculate-the-prediction-interval-for-lmm" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> How to calculate the prediction interval for LMM<a href="statistical-models.html#how-to-calculate-the-prediction-interval-for-lmm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://rpubs.com/Daniel_He/1041063">see here</a></p>
</div>
<div id="least-squares-means-with-interaction-effect" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Least-squares means with interaction effect<a href="statistical-models.html#least-squares-means-with-interaction-effect" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://rpubs.com/Daniel_He/1041369">see here</a></p>
</div>
<div id="spline-regression" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> Spline regression<a href="statistical-models.html#spline-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://rpubs.com/Daniel_He/1041069">see here</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="probability.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-00-stamodels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
